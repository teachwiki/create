!function(){"use strict";window.BeFunky=window.BeFunky||{},BeFunky.editorExternalImage=null,BeFunky.projectToOpenInSection={editor:void 0,collage:void 0,designer:void 0},BeFunky.Init=function(){var e=BeFunky.macOS10Version;BeFunky.isSafari&&e&&(e>=11&&e<=13&&(BeFunky.Params.swfFlashVars.forcejssave=1),e>=13&&(BeFunky.Params.swfFlashVars.forcejsupload=1));var n="en";try{n=window.language.substr(0,2)}catch(e){}if(""===BeFunky.Params.swfFlashVars.language)BeFunky.Params.swfFlashVars.promptLang=n;else{var t=(BeFunky.sessionRoutes[0]||window.location.href.replace(BeFunky.Params.siteUrl,"/")).split("/").filter(Boolean)[0];"en"!==(t=BeFunky.LanguageManager.appLanguages.includes(t)?t:"en")&&BeFunky.Params.swfFlashVars.language!==n&&BeFunky.Params.swfFlashVars.language!==t&&(BeFunky.Params.swfFlashVars.promptLang=t)}if(0==BeFunky.isUseHTML5&&"undefined"!=typeof swfobject&&null!==swfobject){try{document.getElementById("bfn-app").innerHTML=""}catch(e){}var o={id:BeFunky.Params.swfId,name:BeFunky.Params.swfId,src:"".concat(BeFunky.Params.swfUrl+BeFunky.Params.swfId,".swf"),movie:"".concat(BeFunky.Params.swfUrl+BeFunky.Params.swfId,".swf"),align:"middle",style:"background-color:#1e242c;",allowscriptaccess:"always",policyFile:"".concat(BeFunky.Params.siteUrl,"crossdomain.xml")};swfobject.embedSWF("".concat(BeFunky.Params.swfUrl+BeFunky.Params.swfId,".swf"),"flashContainer",setInitFlashWidth(),setInitFlashHeight(),BeFunky.Params.swfMinVersion,"".concat(BeFunky.Params.swfUrl,"playerProductInstall.swf"),BeFunky.Params.swfFlashVars,{quality:"high",bgcolor:"#2D2D2D",allowscriptaccess:"always",allowFullScreen:"true",allowfullscreeninteractive:"true",wmode:"window"},o);var r=Date.now();BeFunky.waitUntil({condition:function(){return!!document.getElementById(BeFunky.Params.swfId)},onSuccess:function(){var e=Date.now()-r;console.log("Flash <object> injected in ".concat(e/1e3,"s"))},onTimeout:function(){BeFunky.logError("Flash <object> NOT injected")},maxAttempts:1e3})}BeFunky.prepareHtml5App(),BeFunky.isUseHTML5||(window.onbeforeunload=function(){if(isFlashOpenned&&isFlashCreationComplated)return"You are about to leave BeFunky, if you do not save your changes they will be lost."});try{BeFunky.Params.isShowAds>0&&0==BeFunky.isUseHTML5&&initAds()}catch(e){}try{BeFunky.isCreateRoute()&&null==$googleDriveState&&document.querySelector("#chrome-extension-button").addEventListener("click",function(e){var n=document.getElementById("chrome-extension-button").getAttribute("data-url");null!=n&&n.length>0&&(window.bf_eventTrack("EXTERNAL","CHROME_EXTENSION","OPEN"),setTimeout(function(){try{try{setApplicationMode("photoeditor")}catch(e){}if(n.includes("http"))if(0==BeFunky.isUseHTML5)try{document.getElementById(BeFunky.Params.swfId).ToJsUrlUploader(n,null,!1)}catch(e){}else try{BFN.BfnService.ToJsUrlUploader(n,null,!0,"chrome_extension")}catch(e){}else{var e=n.split(",");if(n=e[1],0==BeFunky.isUseHTML5)try{document.getElementById(BeFunky.Params.swfId).ToJsBase64Uploader(n)}catch(e){}else try{BFN.BfnService.ToJsBase64Uploader(n,void 0,"chrome_extension")}catch(e){}}}catch(e){}},1500))})}catch(e){}},BeFunky.signOut=function(e){function n(e){BeFunky.removeLocal("latest_user_email"),window.onbeforeunload=null,window.location.href=e}e=e||function(){if(BeFunky.isInstalled())return BeFunky.Params.pwaStartUrl;var e=BeFunky.LanguageManager.language[window.isFlashOpenned?"app":"site"],n="en"!==e&&BeFunky.LanguageManager.siteLanguages.includes(e)?"".concat(e,"/"):"";return"".concat(BeFunky.Params.siteUrl).concat(n)}(),BeFunky.callSignOutAPI().then(function(){n(e)}).catch(function(t){"request_failed"!==t&&BeFunky.throwError("Sign-out failed:",t),n("".concat(BeFunky.Params.siteUrl,"sign-out/?next=").concat(encodeURIComponent(e)))})},BeFunky.callSignOutAPI=function(){return BeFunky.requestAPI("auth/sign-out",{},{showLoadScreen:!0}).then(function(e){if("success"!==e.data)throw"invalid_response"}).catch(function(e){if("not_logged_in"!==e)throw e})},BeFunky.updateLanguage=function(e){return BeFunky.requestAPI("auth/update-language",{lang:e}).then(function(e){if("success"!==e.data)throw"invalid_response"}).catch(function(e){BeFunky.logError("Unable to change language",e)})},window.defferInit=function(){if(BeFunky.isUseHTML5=window.webgl_is_supported,!1!==BeFunky.isUseHTML5)window.swfobject=null,BeFunky.Init();else{var e=function(){window.swfobject=swfobject();try{swfobject.getFlashPlayerVersion().major>=11&&1}catch(e){}CheckVersion(),window._onLoad(function(){BeFunky.Init()})};"undefined"!=typeof swfobject&&null!==swfobject?e():BeFunky.waitUntil({condition:function(){return"undefined"!=typeof swfobject&&null!==swfobject},onSuccess:function(){e()},onTimeout:function(){BeFunky.logError("swf object not loaded")},maxAttempts:1e3})}},window.language=window.navigator.languages?window.navigator.languages[0]:window.navigator.language||window.navigator.userLanguage||navigator.browserLanguage||navigator.systemLanguage,window.browserlng="en";try{var e=language.substr(0,2);"ar"!=e&&"tr"!=e&&"ru"!=e&&"ko"!=e&&"it"!=e&&"de"!=e&&"es"!=e&&"zh"!=e&&"ja"!=e&&"pt"!=e&&"fr"!=e||(window.browserlng=e)}catch(e){}var n;function t(e){var n="".concat(e.getMonth()+1),t="".concat(e.getDate()),o=e.getFullYear();return n.length<2&&(n="0".concat(n)),t.length<2&&(t="0".concat(t)),[n,t,o].join("")}function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function a(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function i(e,n,t){return n&&a(e.prototype,n),t&&a(e,t),e}function s(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function u(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,o)}return t}function c(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?u(Object(t),!0).forEach(function(n){s(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):u(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function l(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),n&&g(e,n)}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function g(e,n){return(g=Object.setPrototypeOf||function(e,n){return e.__proto__=n,e})(e,n)}function p(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function f(e,n,t){return(f=p()?Reflect.construct:function(e,n,t){var o=[null];o.push.apply(o,n);var r=new(Function.bind.apply(e,o));return t&&g(r,t.prototype),r}).apply(null,arguments)}function h(e){var n="function"==typeof Map?new Map:void 0;return(h=function(e){if(null===e||(t=e,-1===Function.toString.call(t).indexOf("[native code]")))return e;var t;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(e))return n.get(e);n.set(e,o)}function o(){return f(e,arguments,d(this).constructor)}return o.prototype=Object.create(e.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}),g(o,e)})(e)}function m(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function y(e){var n=p();return function(){var t,o,r,a=d(e);if(n){var i=d(this).constructor;t=Reflect.construct(a,arguments,i)}else t=a.apply(this,arguments);return o=this,!(r=t)||"object"!=typeof r&&"function"!=typeof r?m(o):r}}function v(e,n,t){return(v="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,n,t){var o=function(e,n){for(;!Object.prototype.hasOwnProperty.call(e,n)&&null!==(e=d(e)););return e}(e,n);if(o){var r=Object.getOwnPropertyDescriptor(o,n);return r.get?r.get.call(t):r.value}})(e,n,t||e)}function _(e,n){return n||(n=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(n)}}))}function k(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var t=[],o=!0,r=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(o=(i=s.next()).done)&&(t.push(i.value),!n||t.length!==n);o=!0);}catch(e){r=!0,a=e}finally{try{o||null==s.return||s.return()}finally{if(r)throw a}}return t}(e,n)||b(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function w(e){return function(e){if(Array.isArray(e))return F(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||b(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(e,n){if(e){if("string"==typeof e)return F(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?F(e,n):void 0}}function F(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,o=new Array(n);t<n;t++)o[t]=e[t];return o}function B(e,n){var t;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(t=b(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var o=0,r=function(){};return{s:r,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){t=e[Symbol.iterator]()},n:function(){var e=t.next();return i=e.done,e},e:function(e){s=!0,a=e},f:function(){try{i||null==t.return||t.return()}finally{if(s)throw a}}}}Object.assign(BeFunky.Params,{isFlashPlayerCorrect:!0,nextBillingDateMonthly:t((n=new Date,n.setMonth(n.getMonth()+1),n)),nextBillingDateAnnual:t(function(){var e=new Date;return e.setFullYear(e.getFullYear()+1),e}()),isShowAds:0}),BeFunky.getDefaultUser=function(){return{email:"",username:"",language:"",isNewUser:!1,FlashVarsObject:{user_name:"",email:"",pl:""},counts:{myPhotos:0,followers:0,following:0,publicPhotos:0},aboutYouText:null,profileBackground:null}},BeFunky.User=BeFunky.getDefaultUser(),BeFunky.log=function(){},BeFunky.logWarning=function(){var e;(e=console).warn.apply(e,arguments)},BeFunky.logError=function(){var e;(e=console).error.apply(e,arguments)},BeFunky.throwError=function(e){var n;if(!(e instanceof Error||window.DOMError&&e instanceof DOMError))try{e=new Error(e)}catch(n){e=new Error("Unknown error ".concat(o(e)))}for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];(n=BeFunky).logError.apply(n,["Sending ".concat(e.name," to Sentry:"),e.message].concat(r));window.Sentry&&"function"==typeof window.Sentry.captureException?Sentry.captureException(e):setTimeout(function(){throw e},0)},BeFunky.reportWarning=function(e){for(var n=arguments.length,t=new Array(n>1?n-1:0),o=1;o<n;o++)t[o-1]=arguments[o];var r;window.Sentry&&"function"==typeof window.Sentry.captureException?Sentry.withScope(function(n){var o;n.setLevel("warning"),(o=console).warn.apply(o,[e].concat(t)),Sentry.captureException(new Error(e))}):(r=console).warn.apply(r,[e].concat(t))},BeFunky.reportUserAction=function(e){console.log("User action:",e)},BeFunky.loggingFlags=(getCookie("logging_flags")||"").split(",").map(function(e){return e.trim()}).filter(Boolean);var E={_default:"mediumslateblue",autosave:"darkturquoise",editor_image:"turquoise"};BeFunky.logFeature=function(e){var n;if(BeFunky.loggingFlags.includes(e)){for(var t="color: white; background: ".concat(E[e]||E._default,"; border-radius: 3px; padding: 2px 4px"),o=arguments.length,r=new Array(o>1?o-1:0),a=1;a<o;a++)r[a-1]=arguments[a];(n=console).log.apply(n,["%c".concat(e),t].concat(r))}},BeFunky.isEdgeHTML=/Edge\/\d+/.test(navigator.userAgent),BeFunky.isEdge=/Edge?\/\d+/.test(navigator.userAgent),BeFunky.isInternetExplorer=/Trident|MSIE/.test(navigator.userAgent),BeFunky.isSafari=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);var L=BeFunky.isSafari?navigator.userAgent.match(/version\/([\d.]+)? safari/i):null;BeFunky.safariVersion=L?parseFloat(L[1]):0,BeFunky.isFirefox=/firefox/i.test(navigator.userAgent);var I=BeFunky.isFirefox?navigator.userAgent.match(/ firefox\/([\d.]+)/i):null;BeFunky.firefoxVersion=I?parseInt(I[1]):0,BeFunky.isOpera=/Opera|OPR\//.test(navigator.userAgent),BeFunky.isChromium=window.chrome&&!BeFunky.isEdgeHTML,BeFunky.isChrome=BeFunky.isChromium&&!BeFunky.isOpera&&!BeFunky.isEdge;var S,P=BeFunky.isChromium?navigator.userAgent.match(/ chrome\/([\d.]+)/i):null;if(BeFunky.chromiumVersion=P?parseInt(P[1]):0,BeFunky.isMac=navigator.platform.includes("Mac"),BeFunky.isMac){var C=navigator.userAgent.match(/Mac[_ ]OS[_ ]X[_ ]10[_.]([\d]+)/);C&&(BeFunky.macOS10Version=parseInt(C[1]))}BeFunky.isIOS=/iPad|iPhone|iPod/.test(navigator.platform),BeFunky.isSafariMojave=BeFunky.isSafari&&/Mac OS X 10_14/.test(navigator.userAgent),BeFunky.isAndroid=/(android)/i.test(navigator.userAgent),BeFunky.isWindows=navigator.platform.includes("Win"),BeFunky.isChromeOS=/\bCrOS\b/.test(navigator.userAgent),BeFunky.isInstalled=function(){return Boolean(window.matchMedia&&window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone||document.referrer.includes("android-app://"))},BeFunky.isDropShadowSupported=!(BeFunky.isChromium&&/Mac OS X 10_(10|11)/.test(navigator.userAgent)),BeFunky.isImageBitmapSupported="createImageBitmap"in window&&BeFunky.chromiumVersion>=87,BeFunky.supportsPointerEvents=!!window.PointerEvent,Object.defineProperty(BeFunky,"supportsPassive",{get:function(){if("boolean"!=typeof S){S=!1;try{var e=Object.defineProperty({},"passive",{get:function(){S=!0}});window.addEventListener("testPassive",null,e),window.removeEventListener("testPassive",null,e)}catch(e){}}return S}}),BeFunky.testingFlags=(getCookie("testing_flags")||"").split(",").map(function(e){return e.trim()}).filter(Boolean),BeFunky.testingFlags.length&&console.log("Testing Flags:",BeFunky.testingFlags);var x=function(e,n){return w(e).filter(function(e){return e instanceof HTMLElement}).map(function(e){return n(e)})},T=function(e,n){return n(e)};function A(e,n){return function(t){"boolean"!=typeof n&&(n=!t.classList.contains(e)),n?t.classList.add(e):t.classList.remove(e)}}if(NodeList.prototype.setStyles=HTMLCollection.prototype.setStyles=function(e){return x(this,function(n){return Object.assign(n.style,e)}),this},HTMLElement.prototype.setStyles=function(e){return T(this,function(n){return Object.assign(n.style,e)}),this},HTMLElement.prototype.setLang=function(e,n,t){var r="object"===o(n)?n:void 0;if(t||(t="string"==typeof n?n:"app"),!BeFunky.LanguageManager)return BeFunky.throwError("setLang called too early"),this;if(this.onLanguageUpdate&&(this.onLanguageUpdate=void 0),r)return this.setAttribute("data-lang",e),BeFunky.LanguageManager.registerElement(this,r,t),this;var a=e;return/^[a-z0-9_!]+$/.test(e)&&(this.setAttribute("data-lang",e),a=BeFunky.LanguageManager.getString(e,t)),"INPUT"===this.nodeName||"TEXTAREA"===this.nodeName?this.setAttribute("placeholder",a):a.includes("<")?this.innerHTML=a:this.textContent=a,this},HTMLElement.prototype.closestParent=function(e){return e(this)?this:this.parentElement?this.parentElement.closestParent(e):void 0},HTMLElement.prototype.hasClass=function(e){return this.classList.contains(e)},HTMLElement.prototype.setClass=function(e){return this.className=e,this},NodeList.prototype.addClass=HTMLCollection.prototype.addClass=function(e){return x(this,function(n){return n.classList.add(e)}),this},HTMLElement.prototype.addClass=function(e){return T(this,function(n){return n.classList.add(e)}),this},NodeList.prototype.removeClass=HTMLCollection.prototype.removeClass=function(e){return x(this,function(n){return n.classList.remove(e)}),this},HTMLElement.prototype.removeClass=function(e){return T(this,function(n){return n.classList.remove(e)}),this},NodeList.prototype.toggleClass=HTMLCollection.prototype.toggleClass=function(e,n){return x(this,A(e,n)),this},HTMLElement.prototype.toggleClass=function(e,n){return T(this,A(e,n)),this},BeFunky.isEdgeHTML||BeFunky.isInternetExplorer||BeFunky.isIOS){var R=HTMLElement.prototype.getBoundingClientRect;HTMLElement.prototype.getBoundingClientRect=function(){var e=R.bind(this)();return e.x=e.left,e.y=e.top,e}}Array.prototype.unique=function(){for(var e=this.concat(),n=0;n<e.length;++n)for(var t=n+1;t<e.length;++t)e[n]===e[t]&&e.splice(t--,1);return e},Array.prototype.shuffle=function(){for(var e,n,t=this.length;t;e=parseInt(Math.random()*t),n=this[--t],this[t]=this[e],this[e]=n);return this},Array.prototype.isIdenticalTo=function(e){if(!Array.isArray(e))return!1;if(this.length!==e.length)return!1;for(var n=0,t=this.length;n<t;n++)if(Array.isArray(this[n])&&Array.isArray(e[n])){if(!this[n].isIdenticalTo(e[n]))return!1}else if(this[n]!==e[n])return!1;return!0},BeFunky.pointerover=BeFunky.supportsPointerEvents?"pointerover":"mouseover",BeFunky.pointerout=BeFunky.supportsPointerEvents?"pointerout":"mouseout",BeFunky.pointerdown=BeFunky.supportsPointerEvents?"pointerdown":"mousedown",BeFunky.pointermove=BeFunky.supportsPointerEvents?"pointermove":"mousemove",BeFunky.pointerup=BeFunky.supportsPointerEvents?"pointerup":"mouseup";var M={},U=null;Object.defineProperty(BeFunky,"globalPointerCoords",{get:function(){return U&&(M.x=U.pageX,M.y=U.pageY),M}}),Object.defineProperty(BeFunky,"globalPointerEvent",{get:function(){return U}});var D=function(e){U=e};document.addEventListener(BeFunky.pointerdown,D,!0),document.addEventListener(BeFunky.pointermove,D,!0),document.addEventListener(BeFunky.pointerup,D,!0),BeFunky.isPointerDown=!1,document.addEventListener(BeFunky.pointerdown,function(e){e.isTrusted&&(BeFunky.isPointerDown=!0)},!0),document.addEventListener(BeFunky.pointerup,function(e){e.isTrusted&&(BeFunky.isPointerDown=!1)},!0),document.addEventListener("touchstart",function(e){e.isTrusted&&(BeFunky.isPointerDown=!0)},!0),document.addEventListener("touchend",function(e){e.isTrusted&&(BeFunky.isPointerDown=!1)},!0),BeFunky.isTextBoxFocused=function(){var e=document.activeElement;return e instanceof HTMLTextAreaElement||e instanceof HTMLInputElement&&["text","number","search","email","password","tel","url","time","date","datetime-local","month","week"].includes(e.type)},BeFunky.debounce=function(e,n){var t,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return function(){var r=this,a=arguments,i=o&&!t,s=function(){t=null,i||e.apply(r,a)};"raf"===n?(cancelAnimationFrame(t),t=requestAnimationFrame(s)):"ric"===n?(cancelIdleCallback(t),t=requestIdleCallback(s)):(clearTimeout(t),t=setTimeout(s,n)),i&&e.apply(r,a)}},BeFunky.throttle=function(e,n){var t,o,r;return function(){var a=this,i=arguments;t?(clearTimeout(o),o=setTimeout(function(){Date.now()-r>=n&&(e.apply(a,i),r=Date.now())},n-(Date.now()-r))):(e.apply(a,i),r=Date.now(),t=!0)}},BeFunky.randomString=function(e){for(var n="",t="abcdefghijklmnopqrstuvwxyz0123456789",o=t.length,r=0;r<e;r++)n+=t.charAt(Math.floor(Math.random()*o));return n},BeFunky.hash=function(e){for(var n=0,t=0,o=e.length;t<o;)n=(n<<5)-n+e.charCodeAt(t++)<<0;return n+2147483647+1},BeFunky.getType=function(e){var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"!==n?n:e&&e.constructor&&e.constructor.name||"Object"},BeFunky.waitUntil=function(e){var n=e.condition,t=e.interval,o=void 0===t?200:t,r=e.maxAttempts,a=void 0===r?10:r,i=e.onSuccess,s=e.onTimeout;if(![n,i,s].every(function(e){return"function"==typeof e}))throw new Error("3 functions must be provided to BeFunky.waitUntil");var u=0;!function e(){if(n())return i();if(u>=a)return s();u++;setTimeout(e,o)}()},BeFunky.getSvgHtml=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=n.classes,o=void 0===t?"icon":t,r=n.style;if("string"!=typeof o)throw new Error("Invalid SVG class: ".concat(BeFunky.getType(o)));return'\n    <svg class="'.concat(o,'" ').concat(r?'style="'.concat(r,'"'):"",'>\n        <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#').concat(e,'"></use>\n    </svg>\n    ').trim()},BeFunky.onDocumentReady=function(e){if("interactive"===document.readyState||"complete"===document.readyState)return e();document.addEventListener("DOMContentLoaded",e,!1)},BeFunky.once=function(e,n){var t;return function(){return e&&(t=e.apply(n||this,arguments),e=null),t}},BeFunky.isLoggedIn=function(){return!!window.latestUserData.email},BeFunky.isPlus=function(){return"1"===window.latestUserData.pl},BeFunky.callbackTimeout=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3e3,t=!1,o=!1,r=Date.now();return setTimeout(function(){t||(o=!0,BeFunky.throwError("Callback for ".concat(e," still not called after ").concat(n,"ms")))},n),function(){t||(t=!0,o&&console.log("Callback for ".concat(e," was eventually called after ").concat(Date.now()-r,"ms")))}},BeFunky.stringValue=function(e){var n=BeFunky.getType(e),t=e;if(e instanceof Error||window.DOMError&&e instanceof DOMError)n=e.name||n,t=e.message;else if(e instanceof Blob)t="{ size: ".concat(BeFunky.formatBytes(e.size),", type: ").concat(e.type," }");else if(e instanceof Event)t="{ type: ".concat(e.type,", target: ").concat(e.target,", currentTarget: ").concat(e.currentTarget," }");else if("object"===o(e))try{t=JSON.stringify(e)}catch(e){}else t="string"==typeof t?'"'.concat(t,'"'):"".concat(t);return t.length>100&&(t="".concat(t.slice(0,100),"...")),"".concat(n,": ").concat(t)};var O=[],j=BeFunky.debounce(function(){requestIdleCallback(function(){BeFunky.waitUntil({condition:function(){return window.ga},onSuccess:function(){console.log("Sending ".concat(O.length," user timing(s)")),O.splice(0).forEach(function(e){var n;return(n=window).ga.apply(n,["send","timing"].concat(w(e)))})},onTimeout:function(){return BeFunky.throwError("Unable to track user timings")},interval:500,maxAttempts:20})})},2e3);BeFunky.trackUserTiming=function(e,n,t){var o=Date.now(),r=!1;return function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now()-o;r||(r=!0,a<=1||BeFunky.Params.enableUserTimings&&"Background Removal"===e&&(console.log("-- ".concat(e," timing : ").concat(n," ").concat(t," : ").concat(a)),O.push([e,n,a,t]),j()))}},BeFunky.setLocal=function(e,n){try{return localStorage.setItem(e,n),!0}catch(e){return!1}},BeFunky.getLocal=function(e){try{return localStorage.getItem(e)}catch(e){return}},BeFunky.removeLocal=function(e){try{return localStorage.removeItem(e),!0}catch(e){return!1}},BeFunky.getUrlParameter=function(e){e=e.replace(/[[]/,"\\[").replace(/[\]]/,"\\]");var n=new RegExp("[\\?&]".concat(e,"=([^&#]*)")).exec(window.location.search);return null===n?"":decodeURIComponent(n[1].replace(/\+/g," "))};BeFunky.toLinkHTML=function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(t,o){return function(e,n){var t=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!n||3!==n.length)throw"Invalid linkHTML translation";var o=k(n,3),r=o[0],a=o[1],i=o[2],s=Object.keys(a).length?BeFunky.LanguageManager.getString(r,i):BeFunky.LanguageManager.getStringReplacements(r,a,i);return"SUPPORT"===e&&(e="https://support.befunky.com/hc/en-us/requests/new"),'<a href="'.concat(e,'" ').concat(t?'target="_blank" rel="noopener"':"",">").concat(s,"</a>")}(e,[t,{},o],n)}},BeFunky.formatBytes=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(!e)return"0 Bytes";var t=e/1024,o=t/1024,r=o/1024;return r>1?"".concat(r.toFixed(1)," GB"):o>1?"".concat(o.toFixed(1)," MB"):"".concat(t.toFixed(n)," KB")},BeFunky.usingServiceWorker=function(){return Boolean(navigator.serviceWorker&&navigator.serviceWorker.controller)},BeFunky.addPassiveListener=function(e,n,t){e.addEventListener(n,t,!!BeFunky.supportsPassive&&{passive:!0})},BeFunky.removePassiveListener=function(e,n,t){e.removeEventListener(n,t,!!BeFunky.supportsPassive&&{passive:!0})},BeFunky.isRetina=function(){if(window.devicePixelRatio>=1.5||window.matchMedia&&window.matchMedia("\n        (-webkit-min-device-pixel-ratio: 1.5),\n        (min--moz-device-pixel-ratio: 1.5),\n        (-o-min-device-pixel-ratio: 3/2),\n        (min-resolution: 1.5dppx)").matches){if("chrome"in window){var e=window.outerWidth/window.innerWidth;if(e>1.02)return window.devicePixelRatio/e>=1.5}return!0}return!1},BeFunky.setupInfiniteScroll=function(e){var n,t,o,r=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).threshold,a=void 0===r?800:r;return{listenForScroll:function(r,i){n||(n=e());var s=BeFunky.randomString(5);o&&BeFunky.removePassiveListener(n,"scroll",o);(o=BeFunky.throttle(function(){if(s===o.id)if(r())BeFunky.removePassiveListener(n,"scroll",o);else{t||(t={scrollHeight:n.scrollHeight,offsetHeight:n.offsetHeight});var e=t,u=e.scrollHeight,c=e.offsetHeight,l=n,d=l.scrollTop,g=u-c-d;u||c?g<=a&&(BeFunky.removePassiveListener(n,"scroll",o),i()):t=void 0}},50)).id=s,t=void 0,requestAnimationFrame(function(){r()||(BeFunky.addPassiveListener(n,"scroll",o),o())})},recalculateScrollPosition:function(){t=void 0,"function"==typeof o&&o()}}},BeFunky.listenForScroll=function(e,n){var t,o=!1,r=BeFunky.throttle(function(){if(o)return;t||(t={scrollHeight:e.scrollHeight,offsetHeight:e.offsetHeight});var r=t,a=r.scrollHeight,i=r.offsetHeight,s=e.scrollTop;if(!a&&!i)return void(t=void 0);n({scrollHeight:a,offsetHeight:i,scrollTop:s})},16);return BeFunky.addPassiveListener(e,"scroll",r),r(),{recalculateScrollPosition:function(){t=void 0,r()},teardown:function(){o=!0,BeFunky.removePassiveListener(e,"scroll",r)}}},BeFunky.addParamsToURL=function(e,n){var t=e.split("?")[0].split("#")[0],o=Object.entries(n),r=o.length?"?".concat(o.map(function(e){var n=k(e,2),t=n[0],o=n[1];return"".concat(t,"=").concat(encodeURIComponent(o))}).join("&")):"";return"".concat(t).concat(r)},BeFunky.escapeHTML=function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")},BeFunky.randomIntForUser=function(){var e,n,t=parseInt(BeFunky.getLocal("random-1-100"));return Number.isNaN(t)&&(e=1,n=100,t=Math.floor(Math.random()*(n-e+1)+e),BeFunky.setLocal("random-1-100",t.toString())),t},BeFunky.isOnline=function(){return BeFunky.testingFlags.includes("simulate_offline")?Math.random()>.8:!1!==navigator.onLine};var N,H=function(){};BeFunky.whenOnline=function(){if(BeFunky.isOnline())return Promise.resolve();if(N)return N;var e=!0;BeFunky.logError("User is offline"),setTimeout(function(){e&&(H=BeFunky.acknowledge("user_offline",{isCritical:!0}))},100),N=window.deferredPromise();var n,t=Date.now();return N.then(function(n){e=!1;var o=Date.now()-t;H(),"browser"===n&&(BeFunky.logError("Browser back online after ".concat(o)),N=void 0),"offline_test"===n&&(BeFunky.reportWarning("Browser offline but /offline-test/ worked",{latency:o}),setTimeout(function(){N=void 0},6e4))}),n=N,window.addEventListener("online",function e(){window.removeEventListener("online",e),n.resolve("browser")}),function(e){var n=new XMLHttpRequest;n.open("GET","".concat(BeFunky.Params.siteUrl,"offline-test/?nocache=").concat(Math.random().toString().split(".")[1])),n.onload=function(){"online"===this.responseText&&e.resolve("offline_test")},n.send()}(N),N},BeFunky.inFlightRequests={},BeFunky.request=function(e,n,t){var o=n.headers,r=void 0===o?{}:o,a=n.responseType,i=void 0===a?"json":a,s=n.method,u=void 0===s?"GET":s,c=n.body,l=void 0===c?null:c,d=n.downloadProgressHandler,g=n.uploadProgressHandler,p=n.fallbackURLs,f=void 0===p?[]:p,h=n.promptToRetryIfOffline,m=void 0===h||h,y=n.logErrorMessage,v=void 0!==y&&y,_="boolean"==typeof n.withCredentials?n.withCredentials:"POST"===u;if(!["","arraybuffer","blob","document","json","text"].includes(i))throw new Error("Invalid responseType: ".concat(BeFunky.stringValue(i)));if(!["GET","POST"].includes(u))throw new Error("Invalid method: ".concat(BeFunky.stringValue(i)));if(f.length&&(d||g))throw new Error("Cannot use progress w/ fallbackURLs b/c multiple XHR objects are created");if(Array.isArray(f)&&f.length){var w=t;t=function(t){if(t.hasOwnProperty("error")){BeFunky.logError("Failed to fetch URL: ".concat(e.split("/").pop(),". Attempting next fallback URL."),t);var o=n.fallbackURLs.shift();t.offlineRetryCancelled&&(n.promptToRetryIfOffline=!1),BeFunky.request(o,n,w)}else w(t)}}var b=new XMLHttpRequest,F=BeFunky.inFlightRequests;function B(){return function(o){if(delete F[e],m&&!BeFunky.isOnline()&&BeFunky.usingServiceWorker())return console.log("Request failed while offline",{reason:o.type,url:e,errorEvent:o}),BeFunky.confirm("user_offline",{confirmText:"try_again",onConfirm:function(){BeFunky.request(e,n,t)},onCancel:function(){t({error:"request_failed",offlineRetryCancelled:!0})}});t({error:"request_failed"})}}b.onload=function(){delete F[e];var n=this.response,o=this.status;if("json"===i)try{n=JSON.parse(this.responseText)}catch(e){n=null}if(o<200||o>=400){if(n&&"string"==typeof n.error)return v&&n.message&&BeFunky.logError("API error name & message:",n.error,n.message),t({error:n.error});if(n&&n.error&&n.error.code&&n.error.message)return t({error:n.error});var r=["","text","json"].includes(i)?this.responseText:n;BeFunky.throwError("Unexpected ".concat(o," error from ").concat(a()),r),t({error:"invalid_response"})}else{if("json"===i&&!n)return BeFunky.throwError("Got invalid JSON from ".concat(a()),e,this.responseText),t({error:"invalid_response"});n&&n.error&&BeFunky.throwError("Status code does not match response",JSON.stringify({url:e,status:o,response:n})),t({response:n})}function a(){var n=e;return n.startsWith(BeFunky.Params.siteUrl)&&(n=n.replace(BeFunky.Params.siteUrl,"/")),(n=n.split("?")[0].split("#")[0]).length>50&&(n="".concat(n.slice(0,50),"...")),n}},b.onerror=B(),b.onabort=B(),b.ontimeout=B(),d&&BeFunky.addProgressHandler(b,d),g&&BeFunky.addProgressHandler(b,g,!0),b.withCredentials=_,b.open(u,e,!0),"json"!==i&&(b.responseType=i),Object.entries(r).forEach(function(e){var n=k(e,2),t=n[0],o=n[1];b.setRequestHeader(t,o)}),b.wasAborted=!1,b.wasSent=!1;var E=b.abort;return b.abort=function(){b.wasSent?(b.wasAborted=!0,E.call(b)):b.wasAborted||(b.wasAborted=!0,b.onabort())},BeFunky.isOnline()||BeFunky.usingServiceWorker()?(b.wasSent=!0,b.send(l)):BeFunky.whenOnline().then(function(){b.wasAborted||(b.wasSent=!0,b.send(l))}),F[e]=b,b},BeFunky.requestAPI=function(e){var n,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=new Promise(function(a,i){e.endsWith("/")||(e+="/");var s,u="".concat(BeFunky.Params.siteUrl,"api/").concat(e);if(e.startsWith("get/")){var c=Object.entries(t).map(function(e){var n=k(e,2),t=n[0],o=n[1];return"".concat(t,"=").concat(encodeURIComponent(o))}).join("&");c&&(u+="?".concat(c)),s={method:"GET"}}else{var l=getCsToken();t.CSRFtoken=l,s={method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded","X-CSRF-Token":l,"X-User-Email":window.latestUserData.email||""},body:Object.entries(t).map(function(e){var n=k(e,2),t=n[0],o=n[1];return"".concat(t,"=").concat(encodeURIComponent(o))}).join("&")}}var d=Object.assign({},s,r);r.showLoadScreen&&("object"===o(r.showLoadScreen)?BeFunky.showLoadScreen(r.showLoadScreen):BeFunky.showLoadScreen()),n=BeFunky.request(u,d,function(e){var n=e.error,t=e.response;return r.showLoadScreen&&BeFunky.hideLoadScreen(),["already_logged_in","not_logged_in","wrong_user"].includes(n)?BeFunky.UserManager.checkUserToken(n,"API"):BeFunky.UserManager.resetPolling(),n?i(n):t&&t.data?void a(t):i("invalid_response")})});return a.request=n,a},BeFunky.addProgressHandler=function(e,n){var t=arguments.length>2&&void 0!==arguments[2]&&arguments[2];function o(e){e&&e.lengthComputable&&n(e.loaded,e.total)}!t&&e&&null===e.onprogress?e.onprogress=o:t&&e&&e.upload&&null===e.upload.onprogress&&(e.upload.onprogress=o)},BeFunky.failureReason=function(e){return"string"!=typeof e?"Unknown request error: ".concat(BeFunky.getType(e)):"not_logged_in"===e&&BeFunky.isLoggedIn()?BeFunky.LanguageManager.getString("acknowledge_session_expired"):"invalid_token"===e?BeFunky.LanguageManager.getString("error_invalid_csrf_token"):"quota_exceeded"===e?BeFunky.LanguageManager.getString("error_invalid_response"):/^[a-z0-9_]+$/.test(e)?BeFunky.LanguageManager.getString("error_".concat(e)):"Error: ".concat(e)},BeFunky.loadScriptWithXHR=function(e){return new Promise(function(n,t){BeFunky.request(e,{responseType:"text"},function(e){var o=e.error,r=e.response;if(o)return t(o);var a=document.createElement("script"),i=document.getElementsByTagName("script")[0].parentElement;a.text=r,i.appendChild(a),n()})})},BeFunky.createFormData=function(e){var n=new FormData;return Object.entries(e).forEach(function(e){var t=k(e,2),o=t[0],r=t[1];n.append(o,r)}),n},BeFunky.uploadFileToS3=function(e,n){var t=n.bucket,o=n.contentType,r=n.fileName,a=n.progressHandler,i={cancelUpload:function(){BeFunky.throwError("cancelUpload called too soon")}},s=new Promise(function(e,n){(function(){var e={bucket:t,content_type:o};r&&(e.filename=r);var n=BeFunky.requestAPI("direct-upload",e);return i.cancelUpload=function(){return n.request.abort()},n.then(function(e){var n=e.data,t=n.url,o=n.inputs;if(!t||!o)throw"invalid_response";return{url:t,inputs:o}})})().then(u).then(e,n)});return s.cancelUpload=function(){return i.cancelUpload()},s;function u(n){var t=n.url,o=n.inputs,r={method:"POST",body:BeFunky.createFormData(Object.assign({},o,{file:e})),withCredentials:!1,responseType:"text",uploadProgressHandler:a};return new Promise(function(e,n){var o=BeFunky.request(t,r,function(t){var o,r=t.error,a=t.response;if(r)return n(r);try{var i=(new window.DOMParser).parseFromString(a,"text/xml");if(!(o={url:decodeURIComponent(i.querySelector("Location").textContent),name:decodeURIComponent(i.querySelector("Key").textContent)}).url||!o.name)throw"missing_data"}catch(e){return BeFunky.throwError("Invalid XML response from S3",e,a),n("invalid_response")}return e(o)});i.cancelUpload=function(){return o.abort()}})}},BeFunky.loadScript=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return!1};return new Promise(function(t,o){if(n())return t();var r=document.createElement("script");r.src=e,r.onload=function(){return t()},r.onerror=function(){BeFunky.logError("Failed to load script:",e),o("request_failed")};var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(r,a)})};var q=new WeakMap,V=function(e){return function(){var n=e.apply(void 0,arguments);return q.set(n,!0),n}},W=function(e){return"function"==typeof e&&q.has(e)},G="undefined"!=typeof window&&null!=window.customElements&&void 0!==window.customElements.polyfillWrapFlushCallback,z=function(e,n){for(var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;n!==t;){var o=n.nextSibling;e.removeChild(n),n=o}},X={},J={},$="{{lit-".concat(String(Math.random()).slice(2),"}}"),Y="\x3c!--".concat($,"--\x3e"),K=new RegExp("".concat($,"|").concat(Y)),Q=function e(n,t){r(this,e),this.parts=[],this.element=t;for(var o=[],a=[],i=document.createTreeWalker(t.content,133,null,!1),s=0,u=-1,c=0,l=n.strings,d=n.values.length;c<d;){var g=i.nextNode();if(null!==g){if(u++,1===g.nodeType){if(g.hasAttributes()){for(var p=g.attributes,f=p.length,h=0,m=0;m<f;m++)Z(p[m].name,"$lit$")&&h++;for(;h-- >0;){var y=l[c],v=te.exec(y)[2],_=v.toLowerCase()+"$lit$",k=g.getAttribute(_);g.removeAttribute(_);var w=k.split(K);this.parts.push({type:"attribute",index:u,name:v,strings:w}),c+=w.length-1}}"TEMPLATE"===g.tagName&&(a.push(g),i.currentNode=g.content)}else if(3===g.nodeType){var b=g.data;if(b.indexOf($)>=0){for(var F=g.parentNode,B=b.split(K),E=B.length-1,L=0;L<E;L++){var I=void 0,S=B[L];if(""===S)I=ne();else{var P=te.exec(S);null!==P&&Z(P[2],"$lit$")&&(S=S.slice(0,P.index)+P[1]+P[2].slice(0,-"$lit$".length)+P[3]),I=document.createTextNode(S)}F.insertBefore(I,g),this.parts.push({type:"node",index:++u})}""===B[E]?(F.insertBefore(ne(),g),o.push(g)):g.data=B[E],c+=E}}else if(8===g.nodeType)if(g.data===$){var C=g.parentNode;null!==g.previousSibling&&u!==s||(u++,C.insertBefore(ne(),g)),s=u,this.parts.push({type:"node",index:u}),null===g.nextSibling?g.data="":(o.push(g),u--),c++}else for(var x=-1;-1!==(x=g.data.indexOf($,x+1));)this.parts.push({type:"node",index:-1}),c++}else i.currentNode=a.pop()}for(var T=0,A=o;T<A.length;T++){var R=A[T];R.parentNode.removeChild(R)}},Z=function(e,n){var t=e.length-n.length;return t>=0&&e.slice(t)===n},ee=function(e){return-1!==e.index},ne=function(){return document.createComment("")},te=/([ \x09\x0a\x0c\x0d])([^\0-\x1F\x7F-\x9F "'>=\/]+)([ \x09\x0a\x0c\x0d]*=[ \x09\x0a\x0c\x0d]*(?:[^ \x09\x0a\x0c\x0d"'`<>=]*|"[^"]*|'[^']*))$/,oe=function(){function e(n,t,o){r(this,e),this.__parts=[],this.template=n,this.processor=t,this.options=o}return i(e,[{key:"update",value:function(e){var n,t=0,o=B(this.__parts);try{for(o.s();!(n=o.n()).done;){var r=n.value;void 0!==r&&r.setValue(e[t]),t++}}catch(e){o.e(e)}finally{o.f()}var a,i=B(this.__parts);try{for(i.s();!(a=i.n()).done;){var s=a.value;void 0!==s&&s.commit()}}catch(e){i.e(e)}finally{i.f()}}},{key:"_clone",value:function(){for(var e,n=G?this.template.element.content.cloneNode(!0):document.importNode(this.template.element.content,!0),t=[],o=this.template.parts,r=document.createTreeWalker(n,133,null,!1),a=0,i=0,s=r.nextNode();a<o.length;)if(e=o[a],ee(e)){for(;i<e.index;)i++,"TEMPLATE"===s.nodeName&&(t.push(s),r.currentNode=s.content),null===(s=r.nextNode())&&(r.currentNode=t.pop(),s=r.nextNode());if("node"===e.type){var u=this.processor.handleTextExpression(this.options);u.insertAfterNode(s.previousSibling),this.__parts.push(u)}else{var c;(c=this.__parts).push.apply(c,w(this.processor.handleAttributeExpressions(s,e.name,e.strings,this.options)))}a++}else this.__parts.push(void 0),a++;return G&&(document.adoptNode(n),customElements.upgrade(n)),n}}]),e}(),re=" ".concat($," "),ae=function(){function e(n,t,o,a){r(this,e),this.strings=n,this.values=t,this.type=o,this.processor=a}return i(e,[{key:"getHTML",value:function(){for(var e=this.strings.length-1,n="",t=!1,o=0;o<e;o++){var r=this.strings[o],a=r.lastIndexOf("\x3c!--");t=(a>-1||t)&&-1===r.indexOf("--\x3e",a+1);var i=te.exec(r);n+=null===i?r+(t?re:Y):r.substr(0,i.index)+i[1]+i[2]+"$lit$"+i[3]+$}return n+=this.strings[e]}},{key:"getTemplateElement",value:function(){var e=document.createElement("template");return e.innerHTML=this.getHTML(),e}}]),e}(),ie=function(e){return null===e||!("object"===o(e)||"function"==typeof e)},se=function(e){return Array.isArray(e)||!(!e||!e[Symbol.iterator])},ue=function(){function e(n,t,o){r(this,e),this.dirty=!0,this.element=n,this.name=t,this.strings=o,this.parts=[];for(var a=0;a<o.length-1;a++)this.parts[a]=this._createPart()}return i(e,[{key:"_createPart",value:function(){return new ce(this)}},{key:"_getValue",value:function(){for(var e=this.strings,n=e.length-1,t="",o=0;o<n;o++){t+=e[o];var r=this.parts[o];if(void 0!==r){var a=r.value;if(ie(a)||!se(a))t+="string"==typeof a?a:String(a);else{var i,s=B(a);try{for(s.s();!(i=s.n()).done;){var u=i.value;t+="string"==typeof u?u:String(u)}}catch(e){s.e(e)}finally{s.f()}}}}return t+=e[n]}},{key:"commit",value:function(){this.dirty&&(this.dirty=!1,this.element.setAttribute(this.name,this._getValue()))}}]),e}(),ce=function(){function e(n){r(this,e),this.value=void 0,this.committer=n}return i(e,[{key:"setValue",value:function(e){e===X||ie(e)&&e===this.value||(this.value=e,W(e)||(this.committer.dirty=!0))}},{key:"commit",value:function(){for(;W(this.value);){var e=this.value;this.value=X,e(this)}this.value!==X&&this.committer.commit()}}]),e}(),le=function(){function e(n){r(this,e),this.value=void 0,this.__pendingValue=void 0,this.options=n}return i(e,[{key:"appendInto",value:function(e){this.startNode=e.appendChild(ne()),this.endNode=e.appendChild(ne())}},{key:"insertAfterNode",value:function(e){this.startNode=e,this.endNode=e.nextSibling}},{key:"appendIntoPart",value:function(e){e.__insert(this.startNode=ne()),e.__insert(this.endNode=ne())}},{key:"insertAfterPart",value:function(e){e.__insert(this.startNode=ne()),this.endNode=e.endNode,e.endNode=this.startNode}},{key:"setValue",value:function(e){this.__pendingValue=e}},{key:"commit",value:function(){if(null!==this.startNode.parentNode){for(;W(this.__pendingValue);){var e=this.__pendingValue;this.__pendingValue=X,e(this)}var n=this.__pendingValue;n!==X&&(ie(n)?n!==this.value&&this.__commitText(n):n instanceof ae?this.__commitTemplateResult(n):n instanceof Node?this.__commitNode(n):se(n)?this.__commitIterable(n):n===J?(this.value=J,this.clear()):this.__commitText(n))}}},{key:"__insert",value:function(e){this.endNode.parentNode.insertBefore(e,this.endNode)}},{key:"__commitNode",value:function(e){this.value!==e&&(this.clear(),this.__insert(e),this.value=e)}},{key:"__commitText",value:function(e){var n=this.startNode.nextSibling,t="string"==typeof(e=null==e?"":e)?e:String(e);n===this.endNode.previousSibling&&3===n.nodeType?n.data=t:this.__commitNode(document.createTextNode(t)),this.value=e}},{key:"__commitTemplateResult",value:function(e){var n=this.options.templateFactory(e);if(this.value instanceof oe&&this.value.template===n)this.value.update(e.values);else{var t=new oe(n,e.processor,this.options),o=t._clone();t.update(e.values),this.__commitNode(o),this.value=t}}},{key:"__commitIterable",value:function(n){Array.isArray(this.value)||(this.value=[],this.clear());var t,o,r=this.value,a=0,i=B(n);try{for(i.s();!(o=i.n()).done;){var s=o.value;void 0===(t=r[a])&&(t=new e(this.options),r.push(t),0===a?t.appendIntoPart(this):t.insertAfterPart(r[a-1])),t.setValue(s),t.commit(),a++}}catch(e){i.e(e)}finally{i.f()}a<r.length&&(r.length=a,this.clear(t&&t.endNode))}},{key:"clear",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.startNode;z(this.startNode.parentNode,e.nextSibling,this.endNode)}}]),e}(),de=function(){function e(n,t,o){if(r(this,e),this.value=void 0,this.__pendingValue=void 0,2!==o.length||""!==o[0]||""!==o[1])throw new Error("Boolean attributes can only contain a single expression");this.element=n,this.name=t,this.strings=o}return i(e,[{key:"setValue",value:function(e){this.__pendingValue=e}},{key:"commit",value:function(){for(;W(this.__pendingValue);){var e=this.__pendingValue;this.__pendingValue=X,e(this)}if(this.__pendingValue!==X){var n=!!this.__pendingValue;this.value!==n&&(n?this.element.setAttribute(this.name,""):this.element.removeAttribute(this.name),this.value=n),this.__pendingValue=X}}}]),e}(),ge=function(e){l(t,ue);var n=y(t);function t(e,o,a){var i;return r(this,t),(i=n.call(this,e,o,a)).single=2===a.length&&""===a[0]&&""===a[1],i}return i(t,[{key:"_createPart",value:function(){return new pe(this)}},{key:"_getValue",value:function(){return this.single?this.parts[0].value:v(d(t.prototype),"_getValue",this).call(this)}},{key:"commit",value:function(){this.dirty&&(this.dirty=!1,this.element[this.name]=this._getValue())}}]),t}(),pe=function(e){l(t,ce);var n=y(t);function t(){return r(this,t),n.apply(this,arguments)}return t}(),fe=!1;!function(){try{var e={get capture(){return fe=!0,!1}};window.addEventListener("test",e,e),window.removeEventListener("test",e,e)}catch(e){}}();var he=function(){function e(n,t,o){var a=this;r(this,e),this.value=void 0,this.__pendingValue=void 0,this.element=n,this.eventName=t,this.eventContext=o,this.__boundHandleEvent=function(e){return a.handleEvent(e)}}return i(e,[{key:"setValue",value:function(e){this.__pendingValue=e}},{key:"commit",value:function(){for(;W(this.__pendingValue);){var e=this.__pendingValue;this.__pendingValue=X,e(this)}if(this.__pendingValue!==X){var n=this.__pendingValue,t=this.value,o=null==n||null!=t&&(n.capture!==t.capture||n.once!==t.once||n.passive!==t.passive),r=null!=n&&(null==t||o);o&&this.element.removeEventListener(this.eventName,this.__boundHandleEvent,this.__options),r&&(this.__options=me(n),this.element.addEventListener(this.eventName,this.__boundHandleEvent,this.__options)),this.value=n,this.__pendingValue=X}}},{key:"handleEvent",value:function(e){"function"==typeof this.value?this.value.call(this.eventContext||this.element,e):this.value.handleEvent(e)}}]),e}(),me=function(e){return e&&(fe?{capture:e.capture,passive:e.passive,once:e.once}:e.capture)},ye=new(function(){function e(){r(this,e)}return i(e,[{key:"handleAttributeExpressions",value:function(e,n,t,o){var r=n[0];return"."===r?new ge(e,n.slice(1),t).parts:"@"===r?[new he(e,n.slice(1),o.eventContext)]:"?"===r?[new de(e,n.slice(1),t)]:new ue(e,n,t).parts}},{key:"handleTextExpression",value:function(e){return new le(e)}}]),e}());function ve(e){var n=_e.get(e.type);void 0===n&&(n={stringsArray:new WeakMap,keyString:new Map},_e.set(e.type,n));var t=n.stringsArray.get(e.strings);if(void 0!==t)return t;var o=e.strings.join($);return void 0===(t=n.keyString.get(o))&&(t=new Q(e,e.getTemplateElement()),n.keyString.set(o,t)),n.stringsArray.set(e.strings,t),t}var _e=new Map,ke=new WeakMap,we=function(e,n,t){var o=ke.get(n);void 0===o&&(z(n,n.firstChild),ke.set(n,o=new le(Object.assign({templateFactory:ve},t))),o.appendInto(n)),o.setValue(e),o.commit()};"undefined"!=typeof window&&(window.litHtmlVersions||(window.litHtmlVersions=[])).push("1.2.1");var be,Fe=function(e){for(var n=arguments.length,t=new Array(n>1?n-1:0),o=1;o<n;o++)t[o-1]=arguments[o];return new ae(e,t,"html",ye)},Be=new WeakMap,Ee=V(function(e){return function(n){var t=Be.get(n);if(void 0===e&&n instanceof ce){if(void 0!==t||!Be.has(n)){var o=n.committer.name;n.committer.element.removeAttribute(o)}}else e!==t&&n.setValue(e);Be.set(n,e)}}),Le=0;function Ie(e){be=e}function Se(){be=null,Le=0}var Pe=Symbol("haunted.phase"),Ce=Symbol("haunted.hook"),xe=Symbol("haunted.update"),Te=Symbol("haunted.commit"),Ae=Symbol("haunted.effects"),Re=Symbol("haunted.layoutEffects"),Me="haunted.context",Ue=function(){function e(n,t){r(this,e),this.update=n,this.host=t,this[Ce]=new Map,this[Ae]=[],this[Re]=[]}return i(e,[{key:"run",value:function(e){Ie(this);var n=e();return Se(),n}},{key:"_runEffects",value:function(e){var n=this[e];Ie(this);var t,o=B(n);try{for(o.s();!(t=o.n()).done;){t.value.call(this)}}catch(e){o.e(e)}finally{o.f()}Se()}},{key:"runEffects",value:function(){this._runEffects(Ae)}},{key:"runLayoutEffects",value:function(){this._runEffects(Re)}},{key:"teardown",value:function(){this[Ce].forEach(function(e){"function"==typeof e.teardown&&e.teardown()})}}]),e}(),De=Promise.resolve().then.bind(Promise.resolve());function Oe(){var e,n=[];function t(){e=null;var t=n;n=[];for(var o=0,r=t.length;o<r;o++)t[o]()}return function(o){n.push(o),null==e&&(e=De(t))}}var je=Oe(),Ne=Oe(),He=function(){function e(n,t){r(this,e),this.renderer=n,this.host=t,this.state=new Ue(this.update.bind(this),t),this[Pe]=null,this._updateQueued=!1}return i(e,[{key:"update",value:function(){var e=this;this._updateQueued||(je(function(){var n=e.handlePhase(xe);Ne(function(){e.handlePhase(Te,n),Ne(function(){e.handlePhase(Ae)})}),e._updateQueued=!1}),this._updateQueued=!0)}},{key:"handlePhase",value:function(e,n){switch(this[Pe]=e,e){case Te:return this.commit(n),void this.runEffects(Re);case xe:return this.render();case Ae:return this.runEffects(Ae)}this[Pe]=null}},{key:"render",value:function(){var e=this;return this.state.run(function(){return e.renderer.call(e.host,e.host)})}},{key:"runEffects",value:function(e){this.state._runEffects(e)}},{key:"teardown",value:function(){this.state.teardown()}}]),e}(),qe=function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").replace(/-+([a-z])?/g,function(e,n){return n?n.toUpperCase():""})};function Ve(e){var n=function(n){l(o,He);var t=y(o);function o(e,n,a){var i;return r(this,o),(i=t.call(this,e,a||n)).frag=n,i}return i(o,[{key:"commit",value:function(n){e(n,this.frag)}}]),o}();return function(e,t,a){var s=(a||t||{}).baseElement||HTMLElement,u=a||t||{},d=u.observedAttributes,g=void 0===d?[]:d,p=u.useShadowDOM,f=void 0===p||p,h=u.shadowRootInit,v=void 0===h?{}:h,_=function(t){l(a,s);var o=y(a);function a(){var t;return r(this,a),t=o.call(this),!1===f?t._scheduler=new n(e,m(t)):(t.attachShadow(c({mode:"open"},v)),t._scheduler=new n(e,t.shadowRoot,m(t))),t}return i(a,[{key:"connectedCallback",value:function(){this._scheduler.update()}},{key:"disconnectedCallback",value:function(){this._scheduler.teardown()}},{key:"attributeChangedCallback",value:function(e,n,t){if(n!==t){var o=""===t||t;Reflect.set(this,qe(e),o)}}}],[{key:"observedAttributes",get:function(){return e.observedAttributes||g||[]}}]),a}(),k=new Proxy(s.prototype,{getPrototypeOf:function(e){return e},set:function(e,n,t,r){var a;return n in e?(a=Object.getOwnPropertyDescriptor(e,n))&&a.set?(a.set.call(r,t),!0):(Reflect.set(e,n,t,r),!0):(a="symbol"===o(n)||"_"===n[0]?{enumerable:!0,configurable:!0,writable:!0,value:t}:function(e){var n=e;return Object.freeze({enumerable:!0,configurable:!0,get:function(){return n},set:function(e){n=e,this._scheduler.update()}})}(t),Object.defineProperty(r,n,a),a.set&&a.set.call(r,t),!0)}});return Object.setPrototypeOf(_.prototype,k),_}}var We=function e(n,t){r(this,e),this.id=n,this.state=t};function Ge(e){for(var n,t=Le++,o=be[Ce],r=o.get(t),a=arguments.length,i=new Array(a>1?a-1:0),s=1;s<a;s++)i[s-1]=arguments[s];return r||(r=f(e,[t,be].concat(i)),o.set(t,r)),(n=r).update.apply(n,i)}function ze(e){return Ge.bind(null,e)}function Xe(e){return ze(function(n){l(o,We);var t=y(o);function o(n,a,i,s){var u;return r(this,o),u=t.call(this,n,a),e(a,m(u)),u}return i(o,[{key:"update",value:function(e,n){this.callback=e,this.values=n}},{key:"call",value:function(){this.values&&!this.hasChanged()||this.run(),this.lastValues=this.values}},{key:"run",value:function(){this.teardown(),this._teardown=this.callback.call(this.state)}},{key:"teardown",value:function(){"function"==typeof this._teardown&&this._teardown()}},{key:"hasChanged",value:function(){var e=this;return!this.lastValues||this.values.some(function(n,t){return e.lastValues[t]!==n})}}]),o}())}function Je(e,n){e[Ae].push(n)}var $e=Xe(Je),Ye=ze(function(e){l(t,We);var n=y(t);function t(e,o,a){var i;return r(this,t),(i=n.call(this,e,o))._updater=i._updater.bind(m(i)),i._ranEffect=!1,i._unsubscribe=null,Je(o,m(i)),i}return i(t,[{key:"update",value:function(e){if(this.state.virtual)throw new Error("can't be used with virtual components");return this.Context!==e&&(this._subscribe(e),this.Context=e),this.value}},{key:"call",value:function(){this._ranEffect||(this._ranEffect=!0,this._unsubscribe&&this._unsubscribe(),this._subscribe(this.Context),this.state.update())}},{key:"_updater",value:function(e){this.value=e,this.state.update()}},{key:"_subscribe",value:function(e){var n={Context:e,callback:this._updater};this.state.host.dispatchEvent(new CustomEvent(Me,{detail:n,bubbles:!0,cancelable:!0,composed:!0}));var t=n.unsubscribe,o=n.value;this.value=t?o:e.defaultValue,this._unsubscribe=t}},{key:"teardown",value:function(){this._unsubscribe&&this._unsubscribe()}}]),t}());var Ke=ze(function(e){l(t,We);var n=y(t);function t(e,o,a,i){var s;return r(this,t),(s=n.call(this,e,o)).value=a(),s.values=i,s}return i(t,[{key:"update",value:function(e,n){return this.hasChanged(n)&&(this.values=n,this.value=e()),this.value}},{key:"hasChanged",value:function(){var e=this;return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).some(function(n,t){return e.values[t]!==n})}}]),t}());var Qe=Xe(function(e,n){e[Re].push(n)}),Ze=ze(function(e){l(t,We);var n=y(t);function t(e,o,a){var i;return r(this,t),(i=n.call(this,e,o)).updater=i.updater.bind(m(i)),"function"==typeof a&&(a=a()),i.makeArgs(a),i}return i(t,[{key:"update",value:function(){return this.args}},{key:"updater",value:function(e){"function"==typeof e&&(e=e(k(this.args,1)[0]));this.makeArgs(e),this.state.update()}},{key:"makeArgs",value:function(e){this.args=Object.freeze([e,this.updater])}}]),t}()),en=ze(function(e){l(t,We);var n=y(t);function t(e,o,a,i,s){var u;return r(this,t),(u=n.call(this,e,o)).dispatch=u.dispatch.bind(m(u)),u.currentState=void 0!==s?s(i):i,u}return i(t,[{key:"update",value:function(e){return this.reducer=e,[this.currentState,this.dispatch]}},{key:"dispatch",value:function(e){this.currentState=this.reducer(this.currentState,e),this.state.update()}}]),t}());var nn=Array.prototype.includes;var tn,on,rn,an=function(e){var n=Ve(e.render),t=function(e){return function(n){var t={Provider:function(e){l(o,h(HTMLElement));var n=y(o);function o(){var e;return r(this,o),(e=n.call(this)).listeners=new Set,e.addEventListener(Me,m(e)),e}return i(o,[{key:"disconnectedCallback",value:function(){this.removeEventListener(Me,this)}},{key:"handleEvent",value:function(e){var n=e.detail;n.Context===t&&(n.value=this.value,n.unsubscribe=this.unsubscribe.bind(this,n.callback),this.listeners.add(n.callback),e.stopPropagation())}},{key:"unsubscribe",value:function(e){this.listeners.delete(e)}},{key:"value",set:function(e){this._value=e;var n,t=B(this.listeners);try{for(t.s();!(n=t.n()).done;)(0,n.value)(e)}catch(e){t.e(e)}finally{t.f()}},get:function(){return this._value}}]),o}(),Consumer:e(function(e){return(0,e.render)(Ye(t))}),defaultValue:n};return t}}(n);return{component:n,createContext:t}}({render:we}).component,sn=(tn=new WeakMap,on=new WeakMap,rn=function(e){l(t,He);var n=y(t);function t(e,o){var a;return r(this,t),(a=n.call(this,e,o)).state.virtual=!0,a}return i(t,[{key:"render",value:function(){var e=this;return this.state.run(function(){return e.renderer.apply(e.host,e.args)})}},{key:"commit",value:function(e){this.host.setValue(e),this.host.commit()}},{key:"teardown",value:function(){v(d(t.prototype),"teardown",this).call(this);var e=on.get(this);tn.delete(e)}}]),t}(),function(e){return V(function(){for(var n=arguments.length,t=new Array(n),o=0;o<n;o++)t[o]=arguments[o];return function(n){var o=tn.get(n);o||(o=new rn(e,n),tn.set(n,o),on.set(o,n),function e(n,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.startNode,r=o.parentNode,a=new MutationObserver(function(r){var i,s=B(r);try{for(s.s();!(i=s.n()).done;){var u=i.value;if(nn.call(u.removedNodes,o)){a.disconnect(),o.parentNode instanceof ShadowRoot?e(n,t):n.teardown();break}if(nn.call(u.addedNodes,o.nextSibling)){a.disconnect(),e(n,t,o.nextSibling||void 0);break}}}catch(e){s.e(e)}finally{s.f()}});a.observe(r,{childList:!0})}(o,n)),o.args=t,o.update()}})});function un(){var e=_(['<svg class="','" style='," data-bfntooltip=",'>\n        <use xlink:href="','"></use>\n    </svg>']);return un=function(){return e},e}var cn=function(e){return Boolean(e&&e.getHTML&&e.getTemplateElement)},ln=function(e,n){var t=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(Array.isArray(e)){var o=k(e,2),r=o[0],a=o[1];return t?BeFunky.LanguageManager.getStringReplacements(r,a,n):function(e,n,t){for(var o=[],r=BeFunky.LanguageManager.getString(e,t).split(/({{[a-z0-9_!]+}})/i),a=0;a<r.length;a++){var i=r[a];if(i.startsWith("{{")){var s=i.replace(/[{}]/g,""),u=n[s];"function"==typeof u&&(u=u(s,t)),"string"==typeof u?0===a?(r[a]=u+(r[a+1]||""),r.splice(a+1,1)):(r[a-1]=(r[a-1]||"")+u+(r[a+1]||""),r.splice(a,2),a-=1):(cn(u)||BeFunky.throwError("Invalid template replacement for {{".concat(s,"}} in ").concat(e,": ").concat(BeFunky.getType(u))),o.push(u),r.splice(a,1))}}return Fe.apply(void 0,[r].concat(o))}(r,a,n)}var i=BeFunky.LanguageManager.getString(e,n);return t?i:Fe([i])};var dn=V(function(e,n){return function(t){return t.committer.element.setAttributeNS(e,t.committer.name,n)}});function gn(e,n){try{var t=function(e){l(o,h(HTMLElement));var t=y(o);function o(){return r(this,o),t.apply(this,arguments)}return i(o,[{key:"connectedCallback",value:function(){if(n)return n(this);if(!this.innerText){var e=document.createElement("p").setLang("error_no_custom_elements",{learn_more:BeFunky.toLinkHTML("https://support.befunky.com/hc/en-us/articles/360045806551",!0)});this.appendChild(e)}}}]),o}();customElements.define(e,t)}catch(e){BeFunky.logError(e,"Custom element fallback failed"),n&&n(document.createElement("div"))}}var pn=ze(function(e){l(t,We);var n=y(t);function t(e,o,a){var i;r(this,t),(i=n.call(this,e,o)).isTornDown=!1;var s=BeFunky.LanguageManager.contexts;if(!s.includes(a))throw new Error("Invalid useLanguageUpdate context: ".concat(a,". Should be one of these: ").concat(s.join(", "),"."));return i.languageContext=a,i.onLanguageChange=i.onLanguageChange.bind(m(i)),BeFunky.LanguageManager.addLanguageUpdateListener(i.onLanguageChange),i}return i(t,[{key:"onLanguageChange",value:function(e){e.includes(this.languageContext)&&this.state.update()}},{key:"update",value:function(e){this.isTornDown&&(BeFunky.LanguageManager.addLanguageUpdateListener(this.onLanguageChange),this.isTornDown=!1);var n=BeFunky.LanguageManager.language[this.languageContext],t=BeFunky.LanguageManager.loadedLanguages.includes(n);return"".concat(n,"-").concat(t)}},{key:"teardown",value:function(){this.isTornDown=!0,BeFunky.LanguageManager.removeLanguageUpdateListener(this.onLanguageChange)}}]),t}());BeFunky.lit={isTemplateResult:cn,icon:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"icon",t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=t.style,r=t.tooltip;return Fe(un(),n,Ee(o),Ee(r),dn("http://www.w3.org/1999/xlink","#".concat(e)))},elem:function(){var e=document.createElement("div");return we(Fe.apply(void 0,arguments),e),e.firstElementChild},html:Fe,string:function(e,n){var t=document.createElement("string");return Array.isArray(e)?t.setLang(e[0],e[1],n):t.setLang(e,n),t},setupState:function(e,n){var t={},o={};Object.entries(e).forEach(function(e){var n=k(e,2),r=n[0],a=n[1];t[r]=a,Object.defineProperty(o,r,{get:function(){return t[r]}})});return n({}),[o,function(e){var o=function(e,n){var t=!1,o={};return Object.entries(n).forEach(function(r){var a=k(r,2),i=a[0],s=a[1];e.hasOwnProperty(i)?s!==e[i]&&(t=!0,o[i]=[e[i],s],e[i]=s):BeFunky.throwError('Invalid state property "'.concat(i,'"'),Object.keys(e),Object.keys(n))}),{hasUpdated:t,updates:o}}(t,e),r=o.hasUpdated,a=o.updates;r&&n(a)}]},render:we,ifDefined:Ee,lang:ln,appLang:function(e,n){return ln(e,"app",n)},siteLang:function(e,n){return ln(e,"site",n)},modalLang:function(e,n){return ln(e,"modal",n)},component:an,useState:Ze,useMemo:Ke,useCallback:function(e,n){return Ke(function(){return e},n)},useEffect:$e,useLayoutEffect:Qe,useReducer:en,useRef:function(e){return Ke(function(){return{current:e}},[])},useContext:Ye,virtual:sn,useLanguageUpdate:pn,defineCustomElement:function(e,n,t){if(BeFunky.isInternetExplorer||BeFunky.safariVersion&&Math.floor(BeFunky.safariVersion)<=10)return BeFunky.logError("Rendering fallback <".concat(e,">")),gn(e,t);try{customElements.define(e,an(n,{useShadowDOM:!1}))}catch(n){"old"===BeFunky.Params.browserTier?BeFunky.logError("Unable to setup <".concat(e,">"),n):BeFunky.throwError(n,"Unable to setup <".concat(e,">")),gn(e,t)}}};var fn=function(){function e(){r(this,e),this.init()}return i(e,[{key:"init",value:function(){this.initDefaultValues()}},{key:"initDefaultValues",value:function(){var e=this;this.appLanguages=["en","es","pt","fr","de","it","tr","zh","ja","ko","ru","no","ar"],this.siteLanguages=["en","es","pt","fr","de","it"],this.contexts=["app","site","modal"],this.isDocumentReady=!1,BeFunky.onDocumentReady(function(){e.isDocumentReady=!0}),this.languageData=this.appLanguages.reduce(function(e,n){return e[n]={},e},{}),this.languageUpdateListeners=[],this.loadingPromises={},this.loadedLanguages=[],this.queueLanguageRender=BeFunky.debounce(this.renderLanguageStrings.bind(this),"raf"),this.defaultLanguage="en";var n,t=getCookie("lang"),o=document.documentElement.lang,r=[t,o,this.defaultLanguage].find(function(n){return e.appLanguages.includes(n)});n="true"===document.documentElement.getAttribute("data-use-app-lang")?r:[o,this.defaultLanguage].find(function(n){return e.appLanguages.includes(n)}),this._language={app:r,site:n,modal:n},BeFunky.Params.swfFlashVars.language=r,this.loadLanguage(n).then(function(){return e.queueLanguageRender()},function(){}),this.loadLanguage(r).then(function(){return e.queueLanguageRender()},function(){}),requestIdleCallback(function(){[r,n].includes(e.defaultLanguage)||e.loadLanguage(e.defaultLanguage).catch(function(){})})}},{key:"loadLanguage",value:function(e){var n=this;if(!this.appLanguages.includes(e))throw new Error("Invalid language ID");if(this.loadingPromises[e])return this.loadingPromises[e];var t="".concat(e).concat(BeFunky.Params.languageVersions[e],".json"),r="".concat(BeFunky.Params.globalAssetsPath,"languages/all/").concat(t),a=new Promise(function(t,a){BeFunky.request(r,{},function(r){var i=r.response,s=r.error;if(s||!i||"object"!==o(i))return n.loadingPromises[e]=void 0,BeFunky.logError('Unable to get translations for language "'.concat(e,'"'),s||"invalid_response"),a(s||"invalid_response");n.languageData[e]=i,n.loadedLanguages.push(e),t(i)})});return this.loadingPromises[e]=a,a}},{key:"setLanguage",value:function(e,n){var t=this;if(!this.appLanguages.includes(e))throw new Error("Invalid language ID");if(!Array.isArray(n)||!n.every(function(e){return t.contexts.includes(e)}))throw new Error("Invalid language context");n.forEach(function(n){t._language[n]!==e&&(t._language[n]=e,t.loadLanguage(e).then(function(){return t.queueLanguageRender()},function(){}))});var o=window.isFlashOpenned?this._language.app:this._language.site;this.language.modal!==o&&(this._language.modal=o,this.loadLanguage(o).then(function(){return t.queueLanguageRender()},function(){})),n.includes("app")&&(BeFunky.Params.swfFlashVars.language=this.language.app,window.BFN&&BFN.SettingsManager&&BFN.SettingsManager.updateSetting("language",this.language.app),window.BFN&&BFN.userVo&&(BFN.userVo.language=this.language.app))}},{key:"renderLanguageStrings",value:function(e){var n=this;if(!this.isDocumentReady)return this.queueLanguageRender();this.lastRender=this.lastRender||{app:"",site:"",modal:""};var t=[];Object.entries(this.lastRender).forEach(function(o){var r=k(o,2),a=r[0],i=r[1],s=n.language[a];if(s!==i){if("app"===a&&!BeFunky.appTemplateInjected)return;if(!n.loadedLanguages.includes(s))return;!function(e,n){e.forEach(function(e){if("function"!=typeof e.onLanguageUpdate){var t=e.getAttribute("data-lang");if(t.startsWith("<"))e.innerHTML=t;else{var o=BeFunky.LanguageManager.getString(t,n);"INPUT"===e.nodeName||"TEXTAREA"===e.nodeName?e.setAttribute("placeholder",o):o.includes("<")?e.innerHTML=o:e.textContent=o}}else e.onLanguageUpdate()})}(function(n){if("app"===n)return w(e?e.querySelectorAll("[data-lang]"):document.querySelectorAll("#bfn-app [data-lang]"));if("site"===n)return w(document.querySelectorAll("#site_root [data-lang]"));if("modal"===n)return w(document.querySelectorAll(".modal [data-lang], .dialog [data-lang]"))}(a),a),n.lastRender[a]=s,t.push(a),"app"===a&&window.BFN&&BFN.appContainer&&BFN.appContainer.removeClass("app-lang-".concat(i)).addClass("app-lang-".concat(s))}}),t.length&&this.languageUpdateListeners.forEach(function(e){e(t)})}},{key:"registerElement",value:function(e,n,t){var o=this;if(!e||!e.dataset.lang)return BeFunky.logError("Element must have a data-lang attribute.");var r=e.dataset.lang;e.onLanguageUpdate=function(){e.innerHTML=o.getStringReplacements(r,n,t)},e.onLanguageUpdate()}},{key:"getString",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"app";if("string"!=typeof e)return BeFunky.throwError("".concat(BeFunky.getType(e)," passed to LanguageManger.getString"),e),"";if(!this.contexts.includes(n))return BeFunky.throwError('Invalid context "'.concat(n,'" passed to LanguageManger.getString')),"";var t=this.language[n],o=this.languageData[t][e];if(o)return o;if(t!==this.defaultLanguage){var r=this.languageData[this.defaultLanguage][e];if(r)return r}return/^[a-z0-9_!]+$/.test(e)?e.split("_").map(function(e){return e.charAt(0).toUpperCase()+e.slice(1)}).join(" "):e}},{key:"isTranslated",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"app";return!!this.languageData[this.language[n]][e]}},{key:"getStringReplacements",value:function(e,n,t){var o=this.getString(e,t);return Object.keys(n).forEach(function(r){var a=n[r];if("function"==typeof a&&(a=a(r,t)),"string"!=typeof a)return BeFunky.throwError("Invalid string replacement for {{".concat(r,"}} in ").concat(e,": ").concat(BeFunky.getType(a)),a);o=o.split("{{".concat(r,"}}")).join(a)}),o}},{key:"addLanguageUpdateListener",value:function(e){this.languageUpdateListeners.includes(e)||this.languageUpdateListeners.push(e)}},{key:"removeLanguageUpdateListener",value:function(e){var n=this.languageUpdateListeners.indexOf(e);-1!==n&&this.languageUpdateListeners.splice(n,1)}},{key:"handleUserUpdateLanguage",value:function(e){this.setLanguage(e,["app"]),BFN&&BFN.BfnService&&BFN.BfnService.track("CREATE","LANGUAGE",this.language.app.toUpperCase())}},{key:"language",get:function(){return this._language}}]),e}();BeFunky.LanguageManager=new fn;var hn=["#E14A43","#FB9F39","#F5E949","#B7D93F","#67C369","#6A91CD","#966DB8","#CF6399"],mn=[0,2,4,6,1,3,5,7],yn=24,vn=Math.sqrt(Math.pow(yn,2)/2);function _n(){(function(){this.animationFactor=0,this.running=!1,this.active=!1,this.show=function(){this.style.display="block",this.bladeContainer.classList.add("animate-iris-blade-container");for(var e=0;e<this.bladeHolders.length;e++){var n=this.bladeHolders[e];n.classList.add("animate-iris-blade-holder")}}.bind(this),this.hide=function(){this.style.display="none",this.bladeContainer.classList.remove("animate-iris-blade-container");for(var e=0;e<this.bladeHolders.length;e++){var n=this.bladeHolders[e];n.classList.remove("animate-iris-blade-holder")}}.bind(this),this.style.position="relative",this.style.pointerEvents="none",this.style.width="".concat(2*yn,"px"),this.style.height="".concat(2*yn,"px"),this.style.display="none"}).call(this),function(){this.bladeContainer=document.createElement("div"),this.bladeContainer.style.position="absolute",this.bladeContainer.style.left="".concat(yn,"px"),this.bladeContainer.style.top="".concat(yn,"px"),this.appendChild(this.bladeContainer)}.call(this),function(){this.bladeHolders=[];for(var e=0;e<mn.length;e++){var n=mn[e],t=hn[n],o=n/hn.length*(2*Math.PI),r=document.createElement("div");r.id="blade_holder_".concat(n),r.style.position="absolute",r.style.left="".concat(Math.cos(o)*yn-Math.cos(o+Math.PI/2)*(yn/1.5),"px"),r.style.top="".concat(Math.sin(o)*yn-Math.sin(o+Math.PI/2)*(yn/1.5),"px"),this.bladeContainer.appendChild(r),this.bladeHolders.push(r);var a=document.createElement("div");a.id="blade_".concat(n),a.style.position="absolute",a.style.transform="rotate(".concat(o*(180/Math.PI),"deg)"),r.appendChild(a);var i=document.createElement("div");i.id="blade_graphic_".concat(n),i.style.position="absolute",i.style.backgroundColor="rgba(0,0,0,0)",i.style.transform="rotate(-45deg)",i.style.left="-".concat(vn,"px"),i.style.bottom="-".concat(yn+vn,"px"),i.style.border="".concat(vn+1,"px solid rgba(0,0,0,0)"),i.style.borderTop="".concat(vn+1,"px solid ").concat(t),i.style.opacity=.8,a.appendChild(i)}}.call(this)}var kn,wn,bn,Fn,Bn=function(){var e=document.createElement("div").setClass("load-screen");e.id="load_screen_root";var n=document.createElement("div").addClass("load-screen__iris");t=n,_n.call(t);var t;var o=document.createElement("div").addClass("load-screen__message");return e.appendChild(n),e.appendChild(o),BeFunky.onDocumentReady(function(){e.parentElement||document.body.appendChild(e)}),function(e){var n=function(){return BeFunky.confirm("confirm_cancel",{onConfirm:function(){bn=void 0,An(),"function"==typeof wn&&wn()},onCancel:function(){bn=void 0},confirmText:"yes",cancelText:"no"})};e.addEventListener("click",function(){Tn&&(bn=n())}),document.addEventListener("keyup",function(e){if(Pn&&!bn&&27===e.which){var t=BeFunky.getModal();t&&t.isDialog||(e.stopImmediatePropagation(),Tn&&(bn=n()))}})}(e),{containerElement:e,irisElement:n,messageElement:o}}(),En=Bn.containerElement,Ln=Bn.irisElement,In=Bn.messageElement,Sn="load-screen--active",Pn=!1,Cn=!1,xn="",Tn=!1;function An(){Pn&&(Pn=!1,En.removeClass(Sn),In.innerHTML="",xn="",Rn(!1),"function"==typeof bn&&bn())}function Rn(e){Cn!==e&&(Cn=e,e?Ln.show():Ln.hide())}function Mn(e){try{return BeFunky.LanguageManager.getString(e)}catch(n){return e}}function Un(){var e=_(['<div class="notifications" style="display: none"><div class="notifications__inner"></div></div>']);return Un=function(){return e},e}BeFunky.showLoadScreen=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.message,t=void 0===n?"":n,o=e.showIris,r=void 0===o||o,a=e.progress,i=void 0===a?"":a,s=e.isCancellable,u=void 0===s||s,c=e.onCancel;Pn=!0;var l="";t&&(l+=Mn(t)),"number"==typeof i&&(i="".concat(i,"%")),"string"==typeof i&&i&&(l+=' <strong class="load-screen__progress">'.concat(i,"</strong>")),In.innerHTML=l,xn=t,Rn(r),t||r||BeFunky.throwError("Please specify a message when hiding the load screen iris"),En.addClass(Sn);var d=Date.now();Fn={lastProgressTime:d,lastProgressValue:0,loadSpeed:0,lastDisplayTime:d,lastDisplayValue:0,animationFrame:null},function(e,n){if(clearTimeout(kn),Tn=!1,e){var t="function"==typeof n?500:1500;kn=setTimeout(function(){Tn=!0,wn=n},t)}}(u,c)},BeFunky.hideLoadScreen=An,BeFunky.moveLoadScreen=function(e){e!==En.parentElement&&e.appendChild(En)},BeFunky.updateLoadScreenProgress=function(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(a()){if(n=Math.round(n),Number.isNaN(n)||n<0||n>100)return BeFunky.throwError("Invalid load screen percentage",n);var o=Fn;cancelAnimationFrame(o.animationFrame);var r=Date.now();o.loadSpeed=(n-o.lastProgressValue)/(r-o.lastProgressTime),o.lastProgressValue=n,o.lastProgressTime=r,o.lastDisplayValue||(o.lastDisplayTime=r),function n(){o.animationFrame=requestAnimationFrame(function(){if(a()){var r=Date.now(),i=Math.min(1,Math.round(o.loadSpeed*(r-o.lastDisplayTime))),s=Math.min(o.lastProgressValue,Math.max(t,o.lastDisplayValue+i));s>o.lastDisplayValue&&(In.innerHTML="".concat(Mn(e),' <strong class="load-screen__progress">').concat(s,"%</strong>"),o.lastDisplayValue=s,o.lastDisplayTime=r),s<o.lastProgressValue&&n()}})}()}function a(){return Pn&&e===xn}},BeFunky.getLoadScreenMessage=function(){return xn},BeFunky.isLoadScreenActive=function(){return Pn};var Dn=BeFunky.lit,On=Dn.isTemplateResult,jn=Dn.render,Nn=(0,Dn.elem)(Un()),Hn=Nn.firstElementChild;function qn(e){return!("string"!=typeof e||!e.length)||!(!Array.isArray(e)||"string"!=typeof e[0]||!e[0].length)}function Vn(e){e&&(Hn.removeChild(e),Hn.firstElementChild||Nn.setStyles({display:"none"}))}BeFunky.onDocumentReady(function(){var e=document.querySelector(".section");e?e.insertBefore(Nn,e.firstChild):window.location.href.includes("/index-ui.html")||BeFunky.logWarning("Failed to append notifications container b/c section was not found")}),BeFunky.showNotification=function(e){var n=e.message,t=e.button,o=e.isDismissable,r=void 0===o||o,a=e.onDismiss,i=e.type,s=void 0===i?"error":i,u=BeFunky.createNotification({message:n,button:t,isDismissable:r,onDismiss:a,type:s});return function(e){Hn.insertBefore(e,Hn.firstChild),Nn.setStyles({display:""})}(u),window.scrollTo(0,0),function(){return Vn(u)}},BeFunky.createNotification=function(e){var n=e.message,t=e.button,o=e.isDismissable,r=void 0===o||o,a=e.onDismiss,i=e.type,s=void 0===i?"error":i;if(!qn(n)&&!On(n))throw new Error("Invalid message");if(t&&!qn(t.text))throw new Error("Invalid button");if(!["error","warning","success"].includes(s))throw new Error("Invalid type");t&&"function"!=typeof t.onClick&&(t.onClick=function(){}),"function"!=typeof a&&(a=function(){});var u,c=document.createElement("div").setClass("notification notification--".concat(s)),l=document.createElement("p").setClass("notification__message");On(n)?jn(n,l):Array.isArray(n)?l.setLang(n[0],n[1],"site"):l.setLang(n,"site"),t&&(u=document.createElement("button").setLang(t.text,"site").setClass("button button--small button--link").setStyles({padding:"0 8px"})).addEventListener("click",t.onClick);var d=document.createElement("div").setClass("notification__content");if(d.appendChild(l),u&&d.appendChild(u),c.appendChild(d),r){var g=document.createElement("button").setClass("button button--small button--link");g.setLang("dismiss","site"),g.addEventListener("click",function(){a(),Vn(c)}),d.appendChild(g)}return c};var Wn="function"==typeof Symbol&&"symbol"===o(Symbol.iterator)?function(e){return o(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":o(e)};function Gn(){return!("undefined"==typeof window||!window.history||!window.history.pushState)}function zn(e,n,t){this.root=null,this._routes=[],this._useHash=n,this._hash=void 0===t?"#":t,this._paused=!1,this._destroyed=!1,this._lastRouteResolved=null,this._notFoundHandler=null,this._defaultHandler=null,this._usePushState=!n&&Gn(),this._onLocationChange=this._onLocationChange.bind(this),this._genericHooks=null,this._historyAPIUpdateMethod="pushState",e?this.root=n?e.replace(/\/$/,"/"+this._hash):e.replace(/\/$/,""):n&&(this.root=this._cLoc().split(this._hash)[0].replace(/\/$/,"/"+this._hash)),this._listen(),this.updatePageLinks()}function Xn(e){return e instanceof RegExp?e:e.replace(/\/+$/,"").replace(/^\/+/,"^/")}function Jn(e){return e.replace(/\/$/,"").split("/").length}function $n(e,n){return Jn(n)-Jn(e)}function Yn(e){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]).map(function(n){var t=function(e){var n=[];return{regexp:e instanceof RegExp?e:new RegExp(e.replace(zn.PARAMETER_REGEXP,function(e,t,o){return n.push(o),zn.REPLACE_VARIABLE_REGEXP}).replace(zn.WILDCARD_REGEXP,zn.REPLACE_WILDCARD)+zn.FOLLOWED_BY_SLASH_REGEXP,zn.MATCH_REGEXP_FLAGS),paramNames:n}}(Xn(n.route)),o=t.regexp,r=t.paramNames,a=e.replace(/^\/+/,"/").match(o),i=function(e,n){return 0===n.length?null:e?e.slice(1,e.length).reduce(function(e,t,o){return null===e&&(e={}),e[n[o]]=decodeURIComponent(t),e},null):null}(a,r);return!!a&&{match:a,route:n,params:i}}).filter(function(e){return e})}function Kn(e,n){return Yn(e,n)[0]||!1}function Qn(e,n){var t=n.map(function(n){return""===n.route||"*"===n.route?e:e.split(new RegExp(n.route+"($|/)"))[0]}),o=Xn(e);return t.length>1?t.reduce(function(e,n){return e.length>n.length&&(e=n),e},t[0]):1===t.length?t[0]:o}function Zn(e,n,t){var o,r=function(e){return e.split(/\?(.*)?$/)[0]};return void 0===t&&(t="#"),Gn()&&!n?r(e).split(t)[0]:(o=e.split(t)).length>1?r(o[1]):r(o[0])}function et(e,n,t){if(n&&"object"===(void 0===n?"undefined":Wn(n))){if(n.before)return void n.before(function(){(!(arguments.length>0&&void 0!==arguments[0])||arguments[0])&&(e(),n.after&&n.after(t))},t);if(n.after)return e(),void(n.after&&n.after(t))}e()}zn.prototype={helpers:{match:Kn,root:Qn,clean:Xn,getOnlyURL:Zn},navigate:function(e,n){var t;return e=e||"",this._usePushState?(t=(t=(n?"":this._getRoot()+"/")+e.replace(/^\/+/,"/")).replace(/([^:])(\/{2,})/g,"$1/"),history[this._historyAPIUpdateMethod]({},"",t),this.resolve()):"undefined"!=typeof window&&(e=e.replace(new RegExp("^"+this._hash),""),window.location.href=window.location.href.replace(/#$/,"").replace(new RegExp(this._hash+".*$"),"")+this._hash+e),this},on:function(){for(var e=this,n=arguments.length,t=Array(n),o=0;o<n;o++)t[o]=arguments[o];if("function"==typeof t[0])this._defaultHandler={handler:t[0],hooks:t[1]};else if(t.length>=2)if("/"===t[0]){var r=t[1];"object"===Wn(t[1])&&(r=t[1].uses),this._defaultHandler={handler:r,hooks:t[2]}}else this._add(t[0],t[1],t[2]);else if("object"===Wn(t[0])){Object.keys(t[0]).sort($n).forEach(function(n){e.on(n,t[0][n])})}return this},off:function(e){return null!==this._defaultHandler&&e===this._defaultHandler.handler?this._defaultHandler=null:null!==this._notFoundHandler&&e===this._notFoundHandler.handler&&(this._notFoundHandler=null),this._routes=this._routes.reduce(function(n,t){return t.handler!==e&&n.push(t),n},[]),this},notFound:function(e,n){return this._notFoundHandler={handler:e,hooks:n},this},resolve:function(e){var n,t,o=this,r=(e||this._cLoc()).replace(this._getRoot(),"");this._useHash&&(r=r.replace(new RegExp("^/"+this._hash),"/"));var a=function(e){return e.split(/\?(.*)?$/).slice(1).join("")}(e||this._cLoc()),i=Zn(r,this._useHash,this._hash);return!this._paused&&(this._lastRouteResolved&&i===this._lastRouteResolved.url&&a===this._lastRouteResolved.query?(this._lastRouteResolved.hooks&&this._lastRouteResolved.hooks.already&&this._lastRouteResolved.hooks.already(this._lastRouteResolved.params),!1):(t=Kn(i,this._routes))?(this._callLeave(),this._lastRouteResolved={url:i,query:a,hooks:t.route.hooks,params:t.params,name:t.route.name},n=t.route.handler,et(function(){et(function(){t.route.route instanceof RegExp?n.apply(void 0,t.match.slice(1,t.match.length)):n(t.params,a)},t.route.hooks,t.params,o._genericHooks)},this._genericHooks,t.params),t):this._defaultHandler&&(""===i||"/"===i||i===this._hash||function(e,n,t){if(Gn()&&!n)return!1;if(!e.match(t))return!1;var o=e.split(t);return o.length<2||""===o[1]}(i,this._useHash,this._hash))?(et(function(){et(function(){o._callLeave(),o._lastRouteResolved={url:i,query:a,hooks:o._defaultHandler.hooks},o._defaultHandler.handler(a)},o._defaultHandler.hooks)},this._genericHooks),!0):(this._notFoundHandler&&et(function(){et(function(){o._callLeave(),o._lastRouteResolved={url:i,query:a,hooks:o._notFoundHandler.hooks},o._notFoundHandler.handler(a)},o._notFoundHandler.hooks)},this._genericHooks),!1))},destroy:function(){this._routes=[],this._destroyed=!0,this._lastRouteResolved=null,this._genericHooks=null,clearTimeout(this._listeningInterval),"undefined"!=typeof window&&(window.removeEventListener("popstate",this._onLocationChange),window.removeEventListener("hashchange",this._onLocationChange))},updatePageLinks:function(){var e=this;"undefined"!=typeof document&&this._findLinks().forEach(function(n){n.hasListenerAttached||(n.addEventListener("click",function(t){if((t.ctrlKey||t.metaKey)&&"a"==t.target.tagName.toLowerCase())return!1;var o=e.getLinkPath(n);e._destroyed||(t.preventDefault(),e.navigate(o.replace(/\/+$/,"").replace(/^\/+/,"/")))}),n.hasListenerAttached=!0)})},generate:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=this._routes.reduce(function(t,o){var r;if(o.name===e)for(r in t=o.route,n)t=t.toString().replace(":"+r,n[r]);return t},"");return this._useHash?this._hash+t:t},link:function(e){return this._getRoot()+e},pause:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._paused=e,this._historyAPIUpdateMethod=e?"replaceState":"pushState"},resume:function(){this.pause(!1)},historyAPIUpdateMethod:function(e){return void 0===e?this._historyAPIUpdateMethod:(this._historyAPIUpdateMethod=e,e)},disableIfAPINotAvailable:function(){Gn()||this.destroy()},lastRouteResolved:function(){return this._lastRouteResolved},getLinkPath:function(e){return e.getAttribute("href")},hooks:function(e){this._genericHooks=e},_add:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return"string"==typeof e&&(e=encodeURI(e)),this._routes.push("object"===(void 0===n?"undefined":Wn(n))?{route:e,handler:n.uses,name:n.as,hooks:t||n.hooks}:{route:e,handler:n,hooks:t}),this._add},_getRoot:function(){return null!==this.root?this.root:(this.root=Qn(this._cLoc().split("?")[0],this._routes),this.root)},_listen:function(){var e=this;if(this._usePushState)window.addEventListener("popstate",this._onLocationChange);else if("undefined"!=typeof window&&"onhashchange"in window)window.addEventListener("hashchange",this._onLocationChange);else{var n=this._cLoc(),t=void 0,o=void 0;(o=function(){t=e._cLoc(),n!==t&&(n=t,e.resolve()),e._listeningInterval=setTimeout(o,200)})()}},_cLoc:function(){return"undefined"!=typeof window?void 0!==window.__NAVIGO_WINDOW_LOCATION_MOCK__?window.__NAVIGO_WINDOW_LOCATION_MOCK__:Xn(window.location.href):""},_findLinks:function(){return[].slice.call(document.querySelectorAll("[data-navigo]"))},_onLocationChange:function(){this.resolve()},_callLeave:function(){var e=this._lastRouteResolved;e&&e.hooks&&e.hooks.leave&&e.hooks.leave(e.params)}},zn.PARAMETER_REGEXP=/([:*])(\w+)/g,zn.WILDCARD_REGEXP=/\*/g,zn.REPLACE_VARIABLE_REGEXP="([^/]+)",zn.REPLACE_WILDCARD="(?:.*)",zn.FOLLOWED_BY_SLASH_REGEXP="(?:/$|$)",zn.MATCH_REGEXP_FLAGS="";var nt,tt=BeFunky.Params.siteUrl.replace(/\/$/,""),ot=new zn(tt),rt=!1,at=window.location.href.replace(tt,"");if(at.includes("//")&&!at.match(/localhost|\.ngrok\.io/)){var it=window.location.href.replace(at,"");at=at.replace(/\/+/g,"/");try{window.history.replaceState({},"",it+at),BeFunky.logError("Removed duplicate slash from URL. Referrer = ",document.referrer)}catch(e){BeFunky.throwError(e)}}BeFunky.sessionRoutes=[at],BeFunky.initialRoute=at,BeFunky.isReplacingRoute=!1,BeFunky.ignoreDeepLinkAction=!1;var st,ut=!1;function ct(e){var n=e&&e.deepLink?e.deepLink:"";dt(function(){if(!window.isFlashOpenned){if(BeFunky.myPhotosPage&&BeFunky.myPhotosPage.imageToEdit){var e=BeFunky.myPhotosPage.imageToEdit;return BeFunky.myPhotosPage.imageToEdit="",window.openUploadPanel({type:"photoeditor",img:e,ignoreExistingProject:!0})}window.openUploadPanel(n)}})}BeFunky.pushRoute=function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if((e=e.replace(/\/?(\?|#|$)/,"/$1")).startsWith("/")||(e="/".concat(e)),!rt){if(yt(e)===yt(window.location.href))return;return BeFunky.logError("Queuing up route ".concat(e," while waiting on initial route resolution")),void(nt=[e,n])}BeFunky.isReplacingRoute=n,BeFunky.isCreateRoute()&&BeFunky.isCreateRoute(e)&&(BeFunky.isReplacingRoute=!0,e===yt(window.location.href).replace(/\/?(\?|#|$)/,"/$1")&&(BeFunky.isUseHTML5||setTimeout(function(){!BeFunky.isCreateRoute()||window.isFlashCreationComplated||BeFunky.isModalOpen()||BeFunky.promptUserToEnableFlash()},100))),BeFunky.isReplacingRoute&&ot.historyAPIUpdateMethod("replaceState"),ut=!1,ot.navigate(e),ut=!0},BeFunky.routes={"/explore":function(){dt(function(){mt(),BeFunky.explorePage.search(""),BeFunky.explorePage.openImage("")})},"/explore/photos":function(){dt(function(){mt(),BeFunky.explorePage.search(""),BeFunky.explorePage.openImage("")})},"/explore/photos/:keyword":function(e){var n=e.keyword;dt(function(){mt(),BeFunky.explorePage.search(n),BeFunky.explorePage.openImage("")})},"/explore/gallery/:imageID":function(e){var n=e.imageID;dt(function(e){if(!e){mt();var t=[BeFunky.explorePage,BeFunky.galleryPage,BeFunky.myPhotosPage].find(function(e){return!0===e.isAvailable});t?t.openImage(n):(document.getElementById("explore_single_image")||BeFunky.throwError("No page API handled single image route. Reloading page..."),setTimeout(function(){window.location.reload()},100))}})},"/gallery/:nick":function(e){e.nick;dt(function(){mt(),BeFunky.galleryPage.openImage("")})},"/myphotos":function(){dt(function(){mt(),BeFunky.myPhotosPage.selectFilter("all")})},"/myphotos/:filter":function(e){var n=e.filter;dt(function(){mt(),BeFunky.myPhotosPage.selectFilter(n)})},"/learn/search/:searchTerm":function(e){var n=e.searchTerm;dt(function(){BeFunky.blogSearchResults.search(n)})},"/learn/search":function(){dt(function(){BeFunky.blogSearchResults.search()})},"/create":ct,"/es/crear":ct,"/pt/criar":ct,"/de/erstellen":ct,"/create/:deepLink":ct,"/es/crear/:deepLink":ct,"/pt/criar/:deepLink":ct,"/de/erstellen/:deepLink":ct},BeFunky.originalPageRoute=yt(window.location.href),BeFunky.waitUntil({condition:function(){return(st=document.querySelector('link[rel="canonical"]'))||document.body},onSuccess:function(){if(!st||!st.href)return BeFunky.logError("Unable to get canonical tag for this page");BeFunky.canonicalRoute=yt(st.href)},onTimeout:function(){BeFunky.logError("Unable to get canonical tag for this page")}}),ot.notFound(function(){dt(function(e){if(!e){var n=yt(window.location.href);n!==BeFunky.originalPageRoute&&n!==BeFunky.canonicalRoute?(window.location.href.includes("undefined")&&(console.log(BeFunky.sessionRoutes),BeFunky.throwError("Undefined route")),console.log("Reloading page to force browser to navigate to server-side route:",window.location.href),window.location.reload()):BeFunky.isCreateRoute(n)||mt()}})});var lt=0;function dt(e){var n=0===lt;lt++;var t=window.location.href.replace(tt,"");n||(BeFunky.isReplacingRoute&&BeFunky.sessionRoutes.pop(),BeFunky.sessionRoutes.push(t),BeFunky.isReplacingRoute||(window.ga?(window.ga("set","page",t),window.ga("send","pageview")):BeFunky.logError("Unable to track client-side route in Google Analytics",{route:t})));var o=Date.now();BeFunky.onDocumentReady(function(){var r=Date.now()-o;r&&console.log("Waited ".concat(r,"ms for DOM ready before resolving route ").concat(t));if(console.log("Firing ".concat(n?"initial ":"","route callback"),t),BeFunky.ignoreDeepLinkAction=ut,ot.pause(),e(n),ot.resume(),n&&(rt=!0,nt)){var a=nt,i=k(a,2),s=i[0],u=i[1];BeFunky.pushRoute(s,u)}})}setTimeout(function(){Object.keys(BeFunky.routes).forEach(function(e){e.startsWith("/")&&!e.endsWith("/")||BeFunky.throwError("Invalid route definition:",e)}),console.log("Resolving first route",window.location.href),ot.on(BeFunky.routes).resolve()},0);var gt=["/explore","/explore/photos","/explore/photos/:keyword"],pt=["/gallery/:nick"],ft=["/myphotos","/myphotos/:filter"],ht=["/learn/search/:searchTerm","/learn/search"];function mt(){if(BeFunky.isUseHTML5){if(!window.isFlashOpenned)return}else{var e=window.getModalBackgroundImage(),n=e&&"block"===e.style.display;if(!window.isFlashOpenned&&!n)return}var t=BeFunky.LanguageManager.isTranslated("confirm_hide")?BeFunky.LanguageManager.getString("confirm_hide"):"Are you sure you would like to hide the application?";if(window.confirm(t))!function(){var e=BeFunky.getModal(),n=0;for(;e;){if(BeFunky.closeModal(e.modalID),console.log("Closed modal:",e.modalID),++n>10){BeFunky.throwError("Unexpected number of modals");break}e=BeFunky.getModal()}BeFunky.isUseHTML5||window.hideModalBackgroundImage()}(),window.hideEditor(!1),BeFunky.webglContextWasLost&&window.location.reload();else{var o=window.location.href;window.history.forward(),setTimeout(function(){o===window.location.href&&(console.log("Using Back instead of Forward to return to app"),window.history.back())},100)}}function yt(e){var n=e.replace(tt,"").split("?")[0].split("#")[0].replace(/\/$/,"");return n.startsWith("/")?n:"/".concat(n)}BeFunky.waitUntil({condition:function(){return!!BeFunky.explorePage},onSuccess:function(){BeFunky.onDocumentReady(function(){function e(e){ot._routes=ot._routes.filter(function(n){var t=n.route;return!e.includes(t)})}BeFunky.explorePage.isAvailable||e(gt),BeFunky.galleryPage.isAvailable||e(pt),BeFunky.myPhotosPage.isAvailable||e(ft),BeFunky.blogSearchResults.isAvailable||e(ht)})},onTimeout:function(){console.log("WebGL detection complete?",BeFunky.webGLDetectionComplete),console.log("BeFunky keys:",JSON.stringify(Object.keys(BeFunky).sort())),BeFunky.throwError("BeFunky.explorePage is unavailable")}}),BeFunky.onDocumentReady(function(){w(document.querySelectorAll("a[data-route]")).forEach(function(e){e.href.startsWith(tt)&&e.addEventListener("click",function(n){n.preventDefault(),null!==e.offsetParent?(BeFunky.trackDeepLinkButtonClick(e),BeFunky.pushRoute(e.href.replace(tt,""))):BeFunky.logError("Ignoring data-route link click b/c it's hidden")})})}),BeFunky.isCreateRoute=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.location.href;return["create","es/crear","pt/criar","de/erstellen"].some(function(n){return e.startsWith("/".concat(n))||e.startsWith("".concat(BeFunky.Params.siteUrl).concat(n))})},BeFunky.trackDeepLinkButtonClick=function(e){var n=e.href;if(n&&BeFunky.isCreateRoute(n)){var t,o,r=yt(n).split("/").pop();if(["create","crear","criar","erstellen"].includes(r))t="PHOTO-EDITOR";else{if(!window.deepLinkRouteData[r])return void BeFunky.throwError("Unsure how to track deep link button click",r,n);t=window.deepLinkRouteData[r].trackingID}var a=document.getElementById("site_nav");a&&a.contains(e)&&(o="HEADER"),BeFunky.trackDeepLink(t,o)}};var vt=["input","select","textarea","a[href]","button","[tabindex]","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false"])'],_t=vt.join(","),kt="undefined"==typeof Element?function(){}:Element.prototype.matches||Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector;function wt(e,n){n=n||{};var t,o,r,a=[],i=[],s=new St(e.ownerDocument||e),u=e.querySelectorAll(_t);for(n.includeContainer&&kt.call(e,_t)&&(u=Array.prototype.slice.apply(u)).unshift(e),t=0;t<u.length;t++)bt(o=u[t],s)&&(0===(r=Et(o))?a.push(o):i.push({documentOrder:t,tabIndex:r,node:o}));return i.sort(Lt).map(function(e){return e.node}).concat(a)}function bt(e,n){return!(!Ft(e,n)||function(e){return function(e){return It(e)&&"radio"===e.type}(e)&&!function(e){if(!e.name)return!0;var n=function(e){for(var n=0;n<e.length;n++)if(e[n].checked)return e[n]}(e.ownerDocument.querySelectorAll('input[type="radio"][name="'+e.name+'"]'));return!n||n===e}(e)}(e)||Et(e)<0)}function Ft(e,n){return n=n||new St(e.ownerDocument||e),!(e.disabled||function(e){return It(e)&&"hidden"===e.type}(e)||n.isUntouchable(e))}wt.isTabbable=function(e,n){if(!e)throw new Error("No node provided");return!1!==kt.call(e,_t)&&bt(e,n)},wt.isFocusable=function(e,n){if(!e)throw new Error("No node provided");return!1!==kt.call(e,Bt)&&Ft(e,n)};var Bt=vt.concat("iframe").join(",");function Et(e){var n=parseInt(e.getAttribute("tabindex"),10);return isNaN(n)?function(e){return"true"===e.contentEditable}(e)?0:e.tabIndex:n}function Lt(e,n){return e.tabIndex===n.tabIndex?e.documentOrder-n.documentOrder:e.tabIndex-n.tabIndex}function It(e){return"INPUT"===e.tagName}function St(e){this.doc=e,this.cache=[]}St.prototype.hasDisplayNone=function(e,n){if(e.nodeType!==Node.ELEMENT_NODE)return!1;var t=function(e,n){for(var t=0,o=e.length;t<o;t++)if(n(e[t]))return e[t]}(this.cache,function(n){return n===e});if(t)return t[1];var o=!1;return"none"===(n=n||this.doc.defaultView.getComputedStyle(e)).display?o=!0:e.parentNode&&(o=this.hasDisplayNone(e.parentNode)),this.cache.push([e,o]),o},St.prototype.isUntouchable=function(e){if(e===this.doc.documentElement)return!1;var n=this.doc.defaultView.getComputedStyle(e);return!!this.hasDisplayNone(e,n)||"hidden"===n.visibility};var Pt=wt,Ct=function(){for(var e,n=arguments.length,t=new Array(n),o=0;o<n;o++)t[o]=arguments[o];return(e=BeFunky).logFeature.apply(e,["pricing"].concat(t))},xt=BeFunky.Params.prices.filter(function(e){return e.active}),Tt="US",At=getCookie("ui_country");function Rt(){return At||Tt}var Mt="PENDING",Ut=(Ct("Waiting on /status/"),window.initialUserStatus.then(function(e){var n=e.data;if(n&&"1"===n.pl&&n.price_id&&n.price_pair_id&&(Mt=no([n.price_id,n.price_pair_id])))return BeFunky.setLocal("user_price",JSON.stringify({monthId:Mt.month.id,yearId:Mt.year.id,expires:Date.now()+2592e6})),Ct("Set price pair from user data",Mt),Mt;var t=zt();if(t&&(Mt=eo(t.country)))return Ct("Set price pair from promo in LocalStorage",Mt),Mt;BeFunky.removeLocal("user_promo");var o,r=Boolean(BeFunky.User.FlashVarsObject.subscr_count),a=function(){var e;try{e=JSON.parse(BeFunky.getLocal("user_trial"))}catch(e){}if(e&&e.country&&e.expires>Date.now())return e}();if(a&&!r&&(Mt=eo(a.country)))return Ct("Set price pair from trial in LocalStorage",Mt),Qt(!0,a.enablePaywall),Mt;BeFunky.removeLocal("user_trial");try{o=JSON.parse(BeFunky.getLocal("user_price"))}catch(e){}return o&&o.monthId&&o.yearId&&o.expires>Date.now()&&(Mt=no([o.monthId,o.yearId]))?(Ct("Set price pair from Plus-user price in LocalStorage",Mt),Mt):(BeFunky.removeLocal("user_price"),At&&(Mt=eo(At))?(Ct("Set price pair for user's country ".concat(At),Mt),Mt):(Mt=eo(Tt),Ct("Set price pair for fallback country ".concat(Tt),Mt),Mt))})).then(function(e){Mt=e}),Dt="year",Ot=[];function jt(){return Dt}function Nt(e){if(!["month","year"].includes(e))throw new Error("Invalid recurring value: ".concat(BeFunky.stringValue(e)));Dt=e,Ot.forEach(function(n){return n(e)})}function Ht(e){Ot.push(e)}function qt(){if("PENDING"!==Mt)return Mt||BeFunky.throwError("No month/year price group found",Mt),Mt;BeFunky.throwError("getPrices() called before /status/")}function Vt(){return Ut.then(function(){return qt()})}function Wt(e,n){var t=e.unit_amount,o=e.currency;return new Intl.NumberFormat([n],{style:"currency",currency:o,currencyDisplay:"symbol"}).format(t/100)}function Gt(){Vt().then(function(e){var n=e.month,t=e.year,o=[n.country,n.currency,n.unit_amount,t.unit_amount].join("_").toUpperCase();window.bf_eventTrack("PROMOTION","UPGRADE_PLUS",o)})}function zt(){var e;try{e=JSON.parse(BeFunky.getLocal("user_promo"))}catch(e){}if(e&&"string"==typeof e.code&&e.country&&e.expires>Date.now())return e}function Xt(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=e?7:30;BeFunky.setLocal("user_trial",JSON.stringify({country:"US",expires:Date.now()+864e5*n,enablePaywall:e})),Qt(!0,e)}BeFunky.trackPricesViewed=Gt;var Jt=!1,$t=!1,Yt=[];function Kt(){return Jt}function Qt(e,n){Ct("".concat(e?"Enabling":"Disabling"," free trial")),Ct("".concat(n?"Enabling":"Disabling"," paywall")),Jt=Boolean(e),$t=Boolean(n),Yt.forEach(function(e){return e(Jt,$t)})}function Zt(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];Yt.push(e),n&&e(Jt,$t)}function eo(e){var n=xt.find(function(n){return n.country===e&&"month"===n.recurring}),t=xt.find(function(n){return n.country===e&&"year"===n.recurring});return n&&t?{month:n,year:t}:BeFunky.Params.eurozoneCountries.includes(e)?eo("eurozone"):void 0}function no(e){if(Array.isArray(e)&&2===e.length&&e.every(function(e){return function(e){return BeFunky.Params.prices.some(function(n){return n.id===e})}(e)})){var n=e.map(function(e){return BeFunky.Params.prices.find(function(n){return n.id===e})}).filter(Boolean),t=n.find(function(e){return"month"===e.recurring}),o=n.find(function(e){return"year"===e.recurring});if(t&&o)return{month:t,year:o}}}function to(){var e=document.querySelector(".site-nav__popup-root"),n=document.querySelector(".site-nav__hamburger"),t=document.querySelector(".site-nav__popup-close"),o=document.querySelectorAll(".site-nav__popup-accordion"),r=document.getElementById("site_root");n.addEventListener("click",function(n){n.stopPropagation(),function(){if(a)return;a=!0,e.addClass("site-nav__popup-root--active"),r.addClass("site-root--site-nav-popup-active"),document.addEventListener("click",i)}()}),t.addEventListener("click",i),e.addEventListener("click",function(e){return e.stopPropagation()}),w(o).forEach(function(e){e.addEventListener("click",function(){return function(e){var n="site-nav__popup-accordion--open",t=e.hasClass(n);o.removeClass(n),t||e.addClass(n)}(e)})});var a=!1;function i(){a&&(a=!1,e.removeClass("site-nav__popup-root--active"),r.removeClass("site-root--site-nav-popup-active"),document.removeEventListener("click",i))}}BeFunky.getFreeTrialEnabled=Kt,BeFunky.isPaywallEnabled=function(){return $t},BeFunky.onFreeTrialEnabledChange=Zt,BeFunky.updateSiteNavForUser=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.username,t=e.email,o=e.isPlus,r=document.getElementById("site_nav");if(r)if(t){var a=document.querySelector(".site-nav__user-circle"),i=w(document.querySelectorAll(".site-nav__user-email")),s=i.map(function(e){return e.parentElement});n=n||"",a.textContent=n.slice(0,1).toUpperCase()||"?",s.forEach(function(e){e.title=t}),i[0].textContent=u(t,21),i[1].textContent=u(t,27),r.removeClass("site-nav--not-signed-in").addClass("site-nav--signed-in").toggleClass("site-nav--user-is-plus",o),window.innerWidth>767&&BeFunky.measureSiteNavDropdowns()}else r.addClass("site-nav--not-signed-in").removeClass("site-nav--signed-in").removeClass("site-nav--user-is-plus");function u(e,n){var t=e.length-n;if(t<=0)return e;if(t>0){var o=Math.round(.618*n),r=k(e.split("@"),2),a=r[0],i=r[1];if(i.length<=o){var s=a.slice(0,a.length-t-1);return"".concat(s,"...@").concat(i)}if(a.length<o){var u=i.slice(0,i.length-t-1);return"".concat(a,"@").concat(u,"...")}var c=Math.ceil(t/2),l=a.slice(0,a.length-c-1),d=i.slice(0,i.length-c-1);return"".concat(l,"...@").concat(d,"...")}}},BeFunky.onDocumentReady(function(){var e=document.getElementById("site_root");e&&(!function(){var e=document.querySelector(".site-nav");function n(){e.toggleClass("site-nav--scrolling",window.scrollY>0)}n(),BeFunky.addPassiveListener(window,"scroll",n)}(),function(){var e=document.getElementById("site_root"),n=document.querySelector(".site-nav__dropdown-root"),t=document.querySelector(".site-nav__dropdown-bg"),o=document.querySelector(".site-nav__dropdown-container"),r=document.querySelector(".site-nav__dropdown-arrow"),a=Array.from(document.querySelectorAll(".site-nav__item[data-dropdown]")),i=Array.from(document.querySelectorAll(".site-nav__dropdown-section[data-dropdown]")),s=[],u=!1;a.forEach(function(e){var n=e.getAttribute("data-dropdown"),t=i.find(function(e){return e.getAttribute("data-dropdown")===n});if(!t)return BeFunky.throwError('Unable to find dropdown section: "'.concat(n,'"'));var o=t.firstElementChild,r={index:s.length,name:n,opener:e,section:t,content:o,arrowOffset:parseInt(t.getAttribute("data-arrow-offset"))||-8};s.push(r),e.addEventListener("mouseenter",function(){l(r)}),e.addEventListener("click",function(){BeFunky.handleNextFocus(e,0,!1)}),e.delegateFocus=function(e){l(r);var n=Pt(o);return-1===e?n[n.length-1]:n[0]},o.addClass("focus-avoid"),o.exitFocusTrap=function(n){o.addClass("focus-avoid"),BeFunky.handleNextFocus(e,n),u===r&&d()},e.setAttribute("aria-haspopup",!0),e.setAttribute("aria-expanded",!1)});var c=BeFunky.debounce(p,"ric");function l(e){var a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(u!==e||a){if(u&&u!==e&&(u.opener.setAttribute("aria-expanded",!1),u.content.addClass("focus-avoid"),u=e,n.removeClass("site-nav__dropdown-root--disable-transitions")),!u)return u=e,n.addClass("site-nav__dropdown-root--disable-transitions"),l(e,!0),document.addEventListener("mouseover",g),void document.addEventListener("touchstart",g);u=e;var i=Math.round(e.openerMidX-e.contentWidth/2+e.xOffset),c=Math.round(e.openerMidX+e.arrowOffset);r.setStyles({transform:"translateX(".concat(c,"px)")}),o.setStyles({transform:"translateX(".concat(i,"px)"),width:"".concat(e.contentWidth,"px"),height:"".concat(e.contentHeight,"px")}),t.setStyles({transform:"translateX(".concat(i,"px)"),width:"".concat(e.contentWidth,"px"),height:"".concat(e.contentHeight,"px")}),s.forEach(function(n){var t,o=n.index,r=n.section;t=o<e.index?"left":o===e.index?"active":"right",r.setClass("site-nav__dropdown-section site-nav__dropdown-section--".concat(t))}),e.opener.setAttribute("aria-expanded",!0),n.removeClass("site-nav__dropdown-root--inactive"),e.content.removeClass("focus-avoid")}}function d(){u&&(u.opener.setAttribute("aria-expanded",!1),u.content.addClass("focus-avoid"),u=!1,n.addClass("site-nav__dropdown-root--inactive"),document.removeEventListener("mouseover",g),document.removeEventListener("touchstart",g))}function g(t){a.includes(t.target)||n.contains(t.target)||(e.contains(t.target)||window.isFlashOpenned)&&("mouseover"===t.type&&u&&u.content.contains(document.activeElement)||d())}function p(){window.isFlashOpenned||BeFunky.isUseHTML5&&BeFunky.isCreateRoute()||(n.setStyles({transform:"none",transition:"none"}),window.requestAnimationFrame(function(){s.forEach(function(e){var n=window.innerWidth,t=e.content.getBoundingClientRect(),o=e.opener.getBoundingClientRect(),r=o.left+o.width/2,a=r-t.width/2,i=n-(r+t.width/2),s=0;a<48?s=i>96?48-a:(n-t.width)/2-a:i<48&&(s=i-48),Object.assign(e,{contentWidth:t.width,contentHeight:t.height,openerMidX:r,xOffset:s})}),n.setStyles({transform:"",transition:""}),u&&l(u,!0)}))}window.addEventListener("load",c),window.addEventListener("resize",c),BeFunky.LanguageManager.addLanguageUpdateListener(function(e){e.includes("site")&&c()}),p(),BeFunky.measureSiteNavDropdowns=c}(),to(),[document.querySelector(".site-nav__dropdown-link--sign-out"),document.querySelector(".site-nav__popup-button--sign-out")].forEach(function(e){var n=window.location.href;n.endsWith("/")&&["/myphotos","/my-account"].every(function(e){return!n.includes(e)})&&(e.href+="?next=".concat(encodeURIComponent(n)))}),function(){var e=BeFunky.isCreateRoute()&&BeFunky.Params.canUseWebapp,n=window.innerWidth<768;function t(){w(document.querySelectorAll(".site-nav__dropdown-image")).forEach(function(e){return window.loadLazyImage(e)})}e||n?setTimeout(t,2e3):t()}(),window.onUserStatusChange(function(e){if(!e.email)return BeFunky.updateSiteNavForUser();var n=e.user_name,t=e.email,o=e.pl;BeFunky.updateSiteNavForUser({username:n,email:t,isPlus:"1"===o})}),Zt(function(n){e.querySelector(".site-nav__upgrade-button").setLang(n?"start_trial":"upgrade","site")}))}),BeFunky.onDocumentReady(function(){document.getElementById("site_root")&&function(){var e=document.querySelectorAll(".site-footer__language-choice a");function n(){var n=w(e).find(function(e){return e.getAttribute("data-choose-lang")===BeFunky.LanguageManager.language.site});n&&(document.querySelector(".site-footer__current-language").textContent=n.textContent)}n(),BeFunky.LanguageManager.addLanguageUpdateListener(function(e){e.includes("site")&&n()}),w(e).forEach(function(e){e.addEventListener("click",function(n){n.preventDefault();var t=e.getAttribute("data-choose-lang");if(!BeFunky.LanguageManager.siteLanguages.includes(t))return BeFunky.throwError("Language link missing valid language ID",t);var o=e.href.split("?")[0].split("#")[0]!==window.location.href.split("?")[0].split("#")[0],r=!1;function a(){r||(r=!0,window.location.href=e.href)}BeFunky.updateLanguage(t).then(function(){o&&a()}),o&&(BeFunky.showLoadScreen(),setTimeout(function(){BeFunky.throwError("Language change timed out after ".concat(1500,"ms")),setTimeout(a,50)},1500)),BeFunky.LanguageManager.setLanguage(t,["app","site"])})}),w(document.querySelectorAll("#get_started_modal .button")).forEach(function(e){e.addEventListener("click",function(){return BeFunky.closeModal("get_started_modal")})})}()}),BeFunky.panelHeader=function(e,n){var t=n.name,o=void 0===t?"":t,r=n.tag,a=void 0===r?"h2":r,i=n.modifier,s=void 0===i?"":i,u=n.helpEnabled,c=void 0!==u&&u,l=n.closeEnabled,d=void 0!==l&&l,g=n.arrowEnabled,p=void 0!==g&&g,f=n.plusEnabled,h=void 0!==f&&f,m=n.selectEnabled,y=void 0!==m&&m,v=n.deselectEnabled,_=void 0!==v&&v,w=n.batchEnabled,b=void 0!==w&&w,F=n.isPlus,B=void 0!==F&&F,E=n.helpClueID;return function(){var e=this;this.setAttribute("class",t("",[s]));var n=B&&!BeFunky.isPlus()?'<svg class="icon icon-size-regular panel-header__upgrade-star hide-if-premium"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#upgrade-star"></use></svg>':"";function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],t=e?"".concat("panel-header","__").concat(e):"panel-header",o=[t];return n.filter(Boolean).forEach(function(e){o.push("".concat(t,"--").concat(e))}),o.join(" ")}this.innerHTML="\n        <".concat(a,' class="').concat(t("text",[s,"wide"]),'">\n            <string data-lang="').concat(o,'">').concat(BeFunky.LanguageManager.getString(o),"</string>\n            ").concat(n,"\n        </").concat(a,">\n    "),this.init=function(){this.initDefaultValues()},this.initDefaultValues=function(){var e=this;this.heading=this.firstElementChild,this.headingString=this.heading.firstElementChild,this._headingText=o,this.buttonData={help:{icon:"help-icon-circle",event:"HELP",elem:null,position:"left"},close:{icon:"global-cancel-icon",event:"CLOSE",elem:null,position:"right"},plus:{icon:"zoom-plus-icon",event:"PLUS",elem:null,position:"left"},arrow:{icon:"global-arrow-up-icon",event:"ARROW",elem:null,position:"right"},select:{icon:"collage-wizard-select-all",tooltip:"select_all",event:"SELECT",elem:null,position:"left"},deselect:{icon:"collage-wizard-deselect-all",tooltip:"deselect_all",event:"DESELECT",elem:null,position:"right"},batch:{icon:"batch-icon-white",tooltip:"batch_tool_add",event:"BATCH",elem:null,position:"left"}},"preset"===s&&(this.buttonData.batch.icon="batch-icon-white-14"),this.leftButton=null,this.rightButton=null,this.prevButtons={left:"",right:""},this.currentIcons={left:"",right:""},this.buttons={left:"",right:""},this.animationFrameRequested=!1,Object.keys(this.buttonData).forEach(function(n){e["_".concat(n,"Enabled")]=!1}),this.helpEnabled=c,this.closeEnabled=d,this.arrowEnabled=p,this.plusEnabled=h,this.selectEnabled=y,this.deselectEnabled=_,this.batchEnabled=b,(E=E||this.getAttribute("data-help-clue"))&&this.addEventListener("HELP",function(){BFN.HelpClueManager.toggle(E)})},this.showButton=function(n){var t=e.buttonData[n].position;e.prevButtons[t]=e.buttons[t],e.buttons[t]=n,e.animationFrameRequested||e.updateButtons()},this.hideButton=function(n){var t=e.buttonData[n].position;e.buttons[t]&&(e.prevButtons[t]=e.buttons[t],e.buttons[t]="",e.animationFrameRequested||e.updateButtons())},this.updateButtons=function(){if(!e.buttonsAdded)return e.addButtons(),e.animationFrameRequested=!0,void requestAnimationFrame(e.updateButtons);e.animationFrameRequested=!1,e.heading.toggleClass("panel-header__text--wide",!e.buttons.left||!e.buttons.right),[["left",e.leftButton],["right",e.rightButton]].forEach(function(n){var t=k(n,2),o=t[0],r=t[1],a=e.buttons[o],i=e.prevButtons[o];if(a!==i){var s=e.buttonData[a]||{},u=e.buttonData[i]||{};s.tooltip?r.setAttribute("data-bfntooltip",s.tooltip):u.tooltip&&r.removeAttribute("data-bfntooltip"),s.icon&&e.updateButtonIcon(a,s.icon,o),r.toggleClass("panel-header__button--hidden",!a),r.tabIndex=a?0:-1}}),e.prevButtons=Object.assign({},e.buttons)},this.addButtons=function(){e.buttonsAdded||(e.buttonsAdded=!0,e.leftButton=document.createElement("button").setClass("button button--icon button--transparent ".concat(t("button",["hidden",s,e.buttons.left]))),e.rightButton=document.createElement("button").setClass("button button--icon button--transparent ".concat(t("button",["hidden",s,e.buttons.right,"rightmost"]))),e.leftButton.tabIndex=-1,e.rightButton.tabIndex=-1,e.appendChild(e.rightButton),e.appendChild(e.leftButton),e.addEventListener("click",function(n){var t=n.target;t===e.leftButton?e.dispatchEvent(new Event(e.buttonData[e.buttons.left].event)):t===e.rightButton&&e.dispatchEvent(new Event(e.buttonData[e.buttons.right].event))}))},this.updateButtonData=function(n,t){var o=t.icon,r=t.tooltip,a=e.buttonData[n];if(!a)throw"Invalid button name";var i=a.position;"string"==typeof r&&(a.tooltip=r,e.buttons[i]===n&&e.updateButtonTooltip(i,r)),"string"==typeof o&&(a.icon=o,e.buttons[i]===n&&e.updateButtonIcon(n,o,i))},this.updateButtonTooltip=function(n,t){e["".concat(n,"Button")].setAttribute("data-bfntooltip",t)},this.updateButtonIcon=function(n,t,o){var r=function(e,n,t){return'\n            <svg class="icon icon-size-medium icon--'.concat(e,'" ').concat(t?"":'style="backface-visibility: hidden;"','>\n                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#').concat(n,'"></use>\n            </svg>')}(n,t,"right"===o);r!==e.currentIcons[o]&&(e.currentIcons[o]=r,e["".concat(o,"Button")].innerHTML=r)},["help","close","plus","arrow","select","deselect","batch"].forEach(function(n){Object.defineProperty(e,"".concat(n,"Enabled"),{set:function(e){if(e=!!e,this["_".concat(n,"Enabled")]!==e){if(this["_".concat(n,"Enabled")]=e,e){var t=this.prevButtons[this.buttonData[n].position];t&&(this["_".concat(t,"Enabled")]=!1)}e?this.showButton(n):this.hideButton(n)}},get:function(){return this["_".concat(n,"Enabled")]}})}),Object.defineProperty(this,"headingText",{set:function(e){if("string"!=typeof e)return BeFunky.throwError("Invalid headingText ".concat(BeFunky.getType(e)));e=e.trim(),this._headingText!==e&&(this._headingText=e,this.headingString.setLang(this._headingText))},get:function(){return this._headingText}}),this.init()}.bind(e)()};"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;var oo,ro,ao=(function(e,n){e.exports=function(e){var n={};function t(o){if(n[o])return n[o].exports;var r=n[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,t),r.l=!0,r.exports}return t.m=e,t.c=n,t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:o})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==o(e)&&e&&e.__esModule)return e;var r=Object.create(null);if(t.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var a in e)t.d(r,a,function(n){return e[n]}.bind(null,a));return r},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="",t(t.s=0)}([function(e,n,t){function r(e){return(r="function"==typeof Symbol&&"symbol"==o(Symbol.iterator)?function(e){return o(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":o(e)})(e)}var a=t(1),i=t(7),s=i.get,u=(i.deepValue,i.isArray),c=function(){function e(n,t){var o=t.location,r=void 0===o?0:o,a=t.distance,i=void 0===a?100:a,u=t.threshold,c=void 0===u?.6:u,l=t.maxPatternLength,d=void 0===l?32:l,g=t.caseSensitive,p=void 0!==g&&g,f=t.tokenSeparator,h=void 0===f?/ +/g:f,m=t.findAllMatches,y=void 0!==m&&m,v=t.minMatchCharLength,_=void 0===v?1:v,k=t.id,w=void 0===k?null:k,b=t.keys,F=void 0===b?[]:b,B=t.shouldSort,E=void 0===B||B,L=t.getFn,I=void 0===L?s:L,S=t.sortFn,P=void 0===S?function(e,n){return e.score-n.score}:S,C=t.tokenize,x=void 0!==C&&C,T=t.matchAllTokens,A=void 0!==T&&T,R=t.includeMatches,M=void 0!==R&&R,U=t.includeScore,D=void 0!==U&&U,O=t.verbose,j=void 0!==O&&O;!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),this.options={location:r,distance:i,threshold:c,maxPatternLength:d,isCaseSensitive:p,tokenSeparator:h,findAllMatches:y,minMatchCharLength:_,id:w,keys:F,includeMatches:M,includeScore:D,shouldSort:E,getFn:I,sortFn:P,verbose:j,tokenize:x,matchAllTokens:A},this.setCollection(n),this._processKeys(F)}var n,t;return n=e,(t=[{key:"setCollection",value:function(e){return this.list=e,e}},{key:"_processKeys",value:function(e){if(this._keyWeights={},this._keyNames=[],e.length&&"string"==typeof e[0])for(var n=0,t=e.length;n<t;n+=1){var o=e[n];this._keyWeights[o]=1,this._keyNames.push(o)}else{for(var r=0,a=0,i=e.length;a<i;a+=1){var s=e[a];if(!s.hasOwnProperty("name"))throw new Error('Missing "name" property in key object');var u=s.name;if(this._keyNames.push(u),!s.hasOwnProperty("weight"))throw new Error('Missing "weight" property in key object');var c=s.weight;if(c<0||c>1)throw new Error('"weight" property in key must bein the range of [0, 1)');this._keyWeights[u]=c,r+=c}if(r>1)throw new Error("Total of weights cannot exceed 1")}}},{key:"search",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{limit:!1};this._log('---------\nSearch pattern: "'.concat(e,'"'));var t=this._prepareSearchers(e),o=t.tokenSearchers,r=t.fullSearcher,a=this._search(o,r);return this._computeScore(a),this.options.shouldSort&&this._sort(a),n.limit&&"number"==typeof n.limit&&(a=a.slice(0,n.limit)),this._format(a)}},{key:"_prepareSearchers",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=[];if(this.options.tokenize)for(var t=e.split(this.options.tokenSeparator),o=0,r=t.length;o<r;o+=1)n.push(new a(t[o],this.options));return{tokenSearchers:n,fullSearcher:new a(e,this.options)}}},{key:"_search",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1?arguments[1]:void 0,t=this.list,o={},r=[];if("string"==typeof t[0]){for(var a=0,i=t.length;a<i;a+=1)this._analyze({key:"",value:t[a],record:a,index:a},{resultMap:o,results:r,tokenSearchers:e,fullSearcher:n});return r}for(var s=0,u=t.length;s<u;s+=1)for(var c=t[s],l=0,d=this._keyNames.length;l<d;l+=1){var g=this._keyNames[l];this._analyze({key:g,value:this.options.getFn(c,g),record:c,index:s},{resultMap:o,results:r,tokenSearchers:e,fullSearcher:n})}return r}},{key:"_analyze",value:function(e,n){var t=this,o=e.key,r=e.arrayIndex,a=void 0===r?-1:r,i=e.value,s=e.record,c=e.index,l=n.tokenSearchers,d=void 0===l?[]:l,g=n.fullSearcher,p=n.resultMap,f=void 0===p?{}:p,h=n.results,m=void 0===h?[]:h;!function e(n,r,a,i){if(null!=r)if("string"==typeof r){var s=!1,c=-1,l=0;t._log("\nKey: ".concat(""===o?"--":o));var p=g.search(r);if(t._log('Full text: "'.concat(r,'", score: ').concat(p.score)),t.options.tokenize){for(var h=r.split(t.options.tokenSeparator),y=h.length,v=[],_=0,k=d.length;_<k;_+=1){var w=d[_];t._log('\nPattern: "'.concat(w.pattern,'"'));for(var b=!1,F=0;F<y;F+=1){var B=h[F],E=w.search(B),L={};E.isMatch?(L[B]=E.score,s=!0,b=!0,v.push(E.score)):(L[B]=1,t.options.matchAllTokens||v.push(1)),t._log('Token: "'.concat(B,'", score: ').concat(L[B]))}b&&(l+=1)}c=v[0];for(var I=v.length,S=1;S<I;S+=1)c+=v[S];c/=I,t._log("Token score average:",c)}var P=p.score;c>-1&&(P=(P+c)/2),t._log("Score average:",P);var C=!t.options.tokenize||!t.options.matchAllTokens||l>=d.length;if(t._log("\nCheck Matches: ".concat(C)),(s||p.isMatch)&&C){var x={key:o,arrayIndex:n,value:r,score:P};t.options.includeMatches&&(x.matchedIndices=p.matchedIndices);var T=f[i];T?T.output.push(x):(f[i]={item:a,output:[x]},m.push(f[i]))}}else if(u(r))for(var A=0,R=r.length;A<R;A+=1)e(A,r[A],a,i)}(a,i,s,c)}},{key:"_computeScore",value:function(e){this._log("\n\nComputing score:\n");for(var n=this._keyWeights,t=!!Object.keys(n).length,o=0,r=e.length;o<r;o+=1){for(var a=e[o],i=a.output,s=i.length,u=1,c=0;c<s;c+=1){var l=i[c],d=l.key,g=t?n[d]:1,p=0===l.score&&n&&n[d]>0?Number.EPSILON:l.score;u*=Math.pow(p,g)}a.score=u,this._log(a)}}},{key:"_sort",value:function(e){this._log("\n\nSorting...."),e.sort(this.options.sortFn)}},{key:"_format",value:function(e){var n=[];if(this.options.verbose){var t=[];this._log("\n\nOutput:\n\n",JSON.stringify(e,function(e,n){if("object"===r(n)&&null!==n){if(-1!==t.indexOf(n))return;t.push(n)}return n},2)),t=null}var o=[];this.options.includeMatches&&o.push(function(e,n){var t=e.output;n.matches=[];for(var o=0,r=t.length;o<r;o+=1){var a=t[o];if(0!==a.matchedIndices.length){var i={indices:a.matchedIndices,value:a.value};a.key&&(i.key=a.key),a.hasOwnProperty("arrayIndex")&&a.arrayIndex>-1&&(i.arrayIndex=a.arrayIndex),n.matches.push(i)}}}),this.options.includeScore&&o.push(function(e,n){n.score=e.score});for(var a=0,i=e.length;a<i;a+=1){var s=e[a];if(this.options.id&&(s.item=this.options.getFn(s.item,this.options.id)[0]),o.length){for(var u={item:s.item},c=0,l=o.length;c<l;c+=1)o[c](s,u);n.push(u)}else n.push(s.item)}return n}},{key:"_log",value:function(){var e;this.options.verbose&&(e=console).log.apply(e,arguments)}}])&&function(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}(n.prototype,t),e}();e.exports=c},function(e,n,t){var o=t(2),r=t(3),a=t(6),i=function(){function e(n,t){var o=t.location,r=void 0===o?0:o,i=t.distance,s=void 0===i?100:i,u=t.threshold,c=void 0===u?.6:u,l=t.maxPatternLength,d=void 0===l?32:l,g=t.isCaseSensitive,p=void 0!==g&&g,f=t.tokenSeparator,h=void 0===f?/ +/g:f,m=t.findAllMatches,y=void 0!==m&&m,v=t.minMatchCharLength,_=void 0===v?1:v,k=t.includeMatches,w=void 0!==k&&k;!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),this.options={location:r,distance:s,threshold:c,maxPatternLength:d,isCaseSensitive:p,tokenSeparator:h,findAllMatches:y,includeMatches:w,minMatchCharLength:_},this.pattern=p?n:n.toLowerCase(),this.pattern.length<=d&&(this.patternAlphabet=a(this.pattern))}var n,t;return n=e,(t=[{key:"search",value:function(e){var n=this.options,t=n.isCaseSensitive,a=n.includeMatches;if(t||(e=e.toLowerCase()),this.pattern===e){var i={isMatch:!0,score:0};return a&&(i.matchedIndices=[[0,e.length-1]]),i}var s=this.options,u=s.maxPatternLength,c=s.tokenSeparator;if(this.pattern.length>u)return o(e,this.pattern,c);var l=this.options,d=l.location,g=l.distance,p=l.threshold,f=l.findAllMatches,h=l.minMatchCharLength;return r(e,this.pattern,this.patternAlphabet,{location:d,distance:g,threshold:p,findAllMatches:f,minMatchCharLength:h,includeMatches:a})}}])&&function(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}(n.prototype,t),e}();e.exports=i},function(e,n){var t=/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g;e.exports=function(e,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:/ +/g,r=new RegExp(n.replace(t,"\\$&").replace(o,"|")),a=e.match(r),i=!!a,s=[];if(i)for(var u=0,c=a.length;u<c;u+=1){var l=a[u];s.push([e.indexOf(l),l.length-1])}return{score:i?.5:1,isMatch:i,matchedIndices:s}}},function(e,n,t){var o=t(4),r=t(5);e.exports=function(e,n,t,a){for(var i=a.location,s=void 0===i?0:i,u=a.distance,c=void 0===u?100:u,l=a.threshold,d=void 0===l?.6:l,g=a.findAllMatches,p=void 0!==g&&g,f=a.minMatchCharLength,h=void 0===f?1:f,m=a.includeMatches,y=void 0!==m&&m,v=s,_=e.length,k=d,w=e.indexOf(n,v),b=n.length,F=[],B=0;B<_;B+=1)F[B]=0;if(-1!==w){var E=o(n,{errors:0,currentLocation:w,expectedLocation:v,distance:c});if(k=Math.min(E,k),-1!==(w=e.lastIndexOf(n,v+b))){var L=o(n,{errors:0,currentLocation:w,expectedLocation:v,distance:c});k=Math.min(L,k)}}w=-1;for(var I=[],S=1,P=b+_,C=1<<(b<=31?b-1:30),x=0;x<b;x+=1){for(var T=0,A=P;T<A;)o(n,{errors:x,currentLocation:v+A,expectedLocation:v,distance:c})<=k?T=A:P=A,A=Math.floor((P-T)/2+T);P=A;var R=Math.max(1,v-A+1),M=p?_:Math.min(v+A,_)+b,U=Array(M+2);U[M+1]=(1<<x)-1;for(var D=M;D>=R;D-=1){var O=D-1,j=t[e.charAt(O)];if(j&&(F[O]=1),U[D]=(U[D+1]<<1|1)&j,0!==x&&(U[D]|=(I[D+1]|I[D])<<1|1|I[D+1]),U[D]&C&&(S=o(n,{errors:x,currentLocation:O,expectedLocation:v,distance:c}))<=k){if(k=S,(w=O)<=v)break;R=Math.max(1,2*v-w)}}if(o(n,{errors:x+1,currentLocation:v,expectedLocation:v,distance:c})>k)break;I=U}var N={isMatch:w>=0,score:0===S?.001:S};return y&&(N.matchedIndices=r(F,h)),N}},function(e,n){e.exports=function(e,n){var t=n.errors,o=void 0===t?0:t,r=n.currentLocation,a=void 0===r?0:r,i=n.expectedLocation,s=void 0===i?0:i,u=n.distance,c=void 0===u?100:u,l=o/e.length,d=Math.abs(s-a);return c?l+d/c:d?1:l}},function(e,n){e.exports=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,t=[],o=-1,r=-1,a=0,i=e.length;a<i;a+=1){var s=e[a];s&&-1===o?o=a:s||-1===o||((r=a-1)-o+1>=n&&t.push([o,r]),o=-1)}return e[a-1]&&a-o>=n&&t.push([o,a-1]),t}},function(e,n){e.exports=function(e){for(var n={},t=e.length,o=0;o<t;o+=1)n[e.charAt(o)]=0;for(var r=0;r<t;r+=1)n[e.charAt(r)]|=1<<t-r-1;return n}},function(e,n){var t=function(e){return Array.isArray?Array.isArray(e):"[object Array]"===Object.prototype.toString.call(e)},o=function(e){return null==e?"":function(e){if("string"==typeof e)return e;var n=e+"";return"0"==n&&1/e==-1/0?"-0":n}(e)},r=function(e){return"string"==typeof e},a=function(e){return"number"==typeof e};e.exports={get:function(e,n){var i=[];return function e(n,s){if(s){var u=s.indexOf("."),c=s,l=null;-1!==u&&(c=s.slice(0,u),l=s.slice(u+1));var d=n[c];if(null!=d)if(l||!r(d)&&!a(d))if(t(d))for(var g=0,p=d.length;g<p;g+=1)e(d[g],l);else l&&e(d,l);else i.push(o(d))}else i.push(n)}(e,n),i},isArray:t,isString:r,isNum:a,toString:o}}])}(oo={exports:{}},oo.exports),oo.exports),io=(ro=ao)&&ro.__esModule&&Object.prototype.hasOwnProperty.call(ro,"default")?ro.default:ro;ao.Fuse;function so(){var e=_(['<span class="plus-pricing__currency" style="margin: 0 0 0 4px">',"</span>"]);return so=function(){return e},e}function uo(){var e=_(['<span class="plus-pricing__small-amount">.',"</span>"]);return uo=function(){return e},e}function co(){var e=_(['\n            <div class="plus-pricing__price">\n                <span class="plus-pricing__currency">','</span>\n                <span class="plus-pricing__large-amount">',"</span>\n                ","\n                ","\n            </div>\n            "]);return co=function(){return e},e}function lo(){var e=_(['\n                <div class="plus-pricing__price">\n                    <span class="plus-pricing__currency">Kr. </span>\n                    <span class="plus-pricing__large-amount">','</span>\n                    <span class="plus-pricing__small-amount"><sup style="text-decoration: underline">',"</sup></span>\n                </div>\n                "]);return lo=function(){return e},e}function go(){var e=_(['<div class="plus-pricing__price"><div class="loading-spinner"></div></div>']);return go=function(){return e},e}function po(){var e=_(['<span class="plus-pricing__most-popular">',"</span>"]);return po=function(){return e},e}function fo(){var e=_(['<span class="plus-pricing__description">',"</span>"]);return fo=function(){return e},e}function ho(){var e=_(['<span class="plus-pricing__description">',"</span>"]);return ho=function(){return e},e}function mo(){var e=_(["\n        <label class=",' tabindex="0">\n            <input type="radio" name="plan" value="yearly" .checked='," @change=",">\n            ","\n            ","\n            ","\n        </label>\n        <label class=",' tabindex="0">\n            <input type="radio" name="plan" value="monthly" .checked='," @change=",">\n            ",'\n            <span class="plus-pricing__description">',"</span>\n        </label>"]);return mo=function(){return e},e}BeFunky.autocomplete=function(e,n){var t=n.inputElement,o=n.options,r=n.minValueLength,a=void 0===r?2:r,i=n.allowEmpty,s=void 0!==i&&i,u=n.generateItem,c=n.onSelect,l=void 0===c?function(){}:c;return function(){this.addClass("autocomplete"),t.hasAutocomplete=!0;var e=o.slice().filter(function(e){return"string"==typeof e.label&&e.label.length});function n(e,n,t){if("left"===n||"right"===n)return!0;if("keydown"!==t.type)if(e.hasClass("autocomplete__item")){var o="up"===n?e.previousElementSibling:e.nextElementSibling;if(o)o.focus();else if("up"===n){var r=e.parentElement.previousElementSibling;r&&"INPUT"===r.nodeName&&r.focus()}}else if("down"===n){var a=e.nextElementSibling.children;a.length>=2&&a[1].focus()}}this.init=function(){var r=this;this.updatePosition(),this.currentValue="",this._currentOption=void 0,this.noResultsText="No results",this.ignoreNextTextUpdate=!1,e.forEach(function(e){e.element=r.createItem(e)});var i={shouldSort:!0,includeScore:!0,includeMatches:!0,threshold:.2,location:0,distance:100,maxPatternLength:32,minMatchCharLength:a,keys:["label"]};this.fuse=new io(o,i);var s=BeFunky.debounce(this.handleTextUpdate.bind(this),25);t.addEventListener("change",s),t.addEventListener("keyup",s),t.addEventListener("focus",this.handleTextUpdate.bind(this)),t.addEventListener("blur",function(e){var n=e.relatedTarget||e.explicitOriginalTarget;void 0===n&&BeFunky.isSafari?setTimeout(function(){BeFunky.waitUntil({condition:function(){return!r.isHovered},onTimeout:function(){},onSuccess:function(){document.activeElement===t||r.contains(document.activeElement)||r.hide()},interval:200,maxAttempts:15})},200):r.contains(n)||(r.hide(),r.ignoreNextTextUpdate=!0,setTimeout(function(){r.ignoreNextTextUpdate=!1},500))});var u={callback:n,condition:function(e){return e.hasClass("autocomplete__item")||e.hasAutocomplete}};BeFunky.addArrowKeyHandler(u),t.addEventListener("keydown",function(e){"Enter"===e.key&&13===e.keyCode&&(r.handleTextUpdate(),r.currentValue.length<a||r.currentOption&&(e.preventDefault(),r.selectOption(r.currentOption)))}),this.addEventListener("click",function(e){var n=e.target;n&&n.hasClass("autocomplete__item")&&r.selectOption(n.option)}),this.addEventListener("focusout",function(e){var n=e.relatedTarget||e.explicitOriginalTarget||document.activeElement;n&&(n===t||r.contains(n))||r.hide()}),this.isHovered=!1,this.addEventListener("mouseenter",function(){r.isHovered=!0}),this.addEventListener("mouseleave",function(){r.isHovered=!1})},this.show=function(){this.addClass("autocomplete--active")},this.hide=function(){this.removeClass("autocomplete--active")},this.updateOptions=function(){var e=this.currentValue.length;if(e<a&&(0!==e||!s))return this.hide();var n=e?this.fuse.search(this.currentValue).filter(function(e){return e.score<.5}):[];if(u&&(!n.length||n[0].score>0)){var t=this.createItemFromUserInput();t&&(-1===t.index?n.push(t):n.splice(t.index,0,t))}var o=document.createDocumentFragment();if(n.length)n.forEach(function(e){var n=e.item,t=e.matches;if(!e.isGenerated){var r=0,a=n.label;t[0]&&t[0].indices.forEach(function(e){var t=k(e,2),o=t[0],i=t[1];a="".concat(a.slice(0,r+o),"<span>").concat(n.label.slice(o,i+1),"</span>").concat(n.label.slice(i+1)),r+=13}),n.element.innerHTML=a}o.appendChild(n.element)}),this.currentOption=n[0].item;else{var r=this.createItem({label:this.noResultsText});r.addClass("autocomplete__item--no-results"),o.appendChild(r),this.currentOption=void 0}for(;this.firstElementChild;)this.removeChild(this.firstElementChild);this.appendChild(o),this.show()},this.createItemFromUserInput=function(){var e=u(this.currentValue)||{},n=e.html,t=e.index;if(n){var o={label:this.currentValue};return o.element=this.createItem(o),o.element.innerHTML=n,{isGenerated:!0,index:t,item:{label:this.currentValue,element:o.element}}}},this.createItem=function(e){var n=this,t=document.createElement("button");return t.className="button button--list autocomplete__item",t.type="button",t.option=Object.assign({},e),t.textContent=e.label,t.addEventListener("focus",function(){n.currentOption=e}),t},this.selectOption=function(e){var n=this,o=e.label;o!==this.noResultsText&&(this.hide(),this.ignoreNextTextUpdate=!0,setTimeout(function(){n.ignoreNextTextUpdate=!1},500),t.value=o,l(e))},this.updatePosition=function(){var e=t.getBoundingClientRect(),n=this.getBoundingClientRect();if(e.width){var o=parseInt(this.style.top)||0,r=parseInt(this.style.left)||0;this.setStyles({top:"".concat(o+e.top-n.top+e.height+4,"px"),left:"".concat(r+e.left-n.left,"px"),width:"".concat(e.width,"px")})}},this.handleTextUpdate=function(){if(this.ignoreNextTextUpdate)this.ignoreNextTextUpdate=!1;else{var e=t.value.trim();if(e===this.currentValue){if(document.activeElement!==t)return;return e.length>=a?this.show():!e.length&&s?this.show():void 0}this.currentValue=e,this.updateOptions()}},Object.defineProperty(this,"currentOption",{set:function(e){if(this._currentOption!==e)if(this._currentOption&&this._currentOption.element.removeClass("autocomplete__item--selected"),e){if(!e.element||"string"!=typeof e.label)throw"Invalid currentOption";this._currentOption=e,this._currentOption.element.addClass("autocomplete__item--selected")}else this._currentOption=void 0},get:function(){return this._currentOption}}),this.init()}.bind(e)()},BeFunky.contextMenu=function(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=t.hideOnClick,r=void 0===o||o,a=t.onHide,i=t.offset,s=t.hoverOffEventTarget;return function(){var e=this;this.setAttribute("class","context-menu context-menu--hidden"),this.offsetX=parseInt(i&&i.x)||0,this.offsetY=parseInt(i&&i.y)||0,this.hoverOffEventTarget=s||BFN.appContainer;var t=function n(t,o,a){var i=a.onClick,s=a.hasDivider,u=a.children,c=a.translate,l=void 0===c||c,d=a.shortcutText,g=arguments.length>3&&void 0!==arguments[3]&&arguments[3],p="button button--list context-menu__item";s&&(p+=" context-menu__item--has-divider"),u&&(p+=" context-menu__item--has-children"),g&&(p+=" context-menu__item--is-child");var f=document.createElement("div");f.className=p;var h=document.createElement("string");if(l?h.setLang(o):h.innerHTML=o,f.appendChild(h),d&&f.appendChild(BFN.KeyboardManager.shortcutString(d)),f.contextMenuItemName=o,f.addEventListener("click",function(n){n.stopPropagation(),"function"!=typeof i||f.hasAttribute("disabled")||(i(n),r&&e.hide())}),u){h.setStyles({marginRight:"10px"}),f.insertAdjacentHTML("beforeend",'<svg class="icon icon-size-small">\n                    <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#global-arrow-down-icon"></use>\n                </svg>\n            ');var m=Object.keys(u);f.contextMenuItemChildren=m;var y=document.createElement("div").addClass("context-menu__children");f.appendChild(y),m.forEach(function(e){return n(y,e,u[e],!0)})}t.appendChild(f)},o=document.createDocumentFragment();Object.keys(n).forEach(function(e){return t(o,e,n[e])}),this.setStyles({display:"none"}),this.appendChild(o),requestAnimationFrame(function(){return requestAnimationFrame(function(){return e.setStyles({display:""})})}),this.init=function(){this.initDefaultValues()},this.initDefaultValues=function(){this.enabled=!0,this.visible=!1,this.lastShownTime=0,this.getItems(),this.target=this._target=null,this.oncontextmenu=function(){return!1},this.addEventListener(BeFunky.pointerdown,function(e){return e.stopPropagation()})},this.getItems=function(){var e=this;this.items={},w(this.children).forEach(function(n){if(e.items[n.contextMenuItemName]=n,n.contextMenuItemChildren){var t=n.lastElementChild.children;n.contextMenuItemChildren.forEach(function(n,o){if(e.items[n])throw"Duplicate context menu item name: ".concat(n);e.items[n]=t[o]})}})},this.show=function(n,t){e.visible=!0;var o=e.getBoundingClientRect(),r=Math.round(n+o.width-16),a=Math.round(t+o.height-16),i=window.innerWidth,s=window.innerHeight;r>i&&(n-=o.width-32),a>s&&(t-=o.height-32),n=Math.round(n),t=Math.round(t),e.setStyles({transform:"translateX(".concat(n,"px) translateY(").concat(t,"px)")}),e.removeClass("context-menu--hidden"),e.addEventListener(BeFunky.pointerover,e.stopPropagation),e.hoverOffEventTarget.addEventListener(BeFunky.pointerover,e.hide),document.addEventListener("keydown",function(n){[16,17,91,93].includes(n.keyCode)||e.hide()}),e.addEventListener("click",e.hide),e.dispatchEvent(new Event("SHOW")),w(e.querySelectorAll(".context-menu__children")).forEach(function(e){var n=e.getBoundingClientRect(),t=Math.round(n.left+n.width-16),o=Math.round(n.top+n.height-16);t>i&&e.addClass("context-menu__children--left-side"),o>s&&e.setStyles({transform:"translateY(".concat(s-o,"px)")})}),e.lastShownTime=Date.now()},this.hide=function(n){e.visible&&(e.visible=!1,"function"==typeof a&&a(n,Date.now()-e.lastShownTime),e.addClass("context-menu--hidden"),w(e.querySelectorAll(".context-menu__children")).forEach(function(e){e.removeClass("context-menu__children--left-side"),e.setStyles({transform:""})}),e.removeEventListener(BeFunky.pointerover,e.stopPropagation),e.hoverOffEventTarget.removeEventListener(BeFunky.pointerover,e.hide),document.removeEventListener("keydown",e.hide),e.removeEventListener("click",e.hide),e.dispatchEvent(new Event("HIDE")))},this.showButton=function(n){e.items[n].removeClass("context-menu__item--hidden")},this.hideButton=function(n){e.items[n].addClass("context-menu__item--hidden")},this.toggleButton=function(n,t){t?e.showButton(n):e.hideButton(n)},this.updateChildren=function(n,o){var r=e.items[n];if(!r)throw"Invalid context menu item name: ".concat(n);if(!r.contextMenuItemChildren)throw"Context menu item ".concat(n," does not support children");var a=r.lastElementChild,i=Object.keys(o);a.innerHTML="",a.contextMenuItemChildren=i,i.forEach(function(e){return t(a,e,o[e])}),e.getItems()},this.handleTargetClick=BeFunky.debounce(function(n){e.enabled&&e.show(n.pageX-16+e.offsetX,n.pageY-16-window.scrollY+e.offsetY)},0),this.stopPropagation=function(e){return e.stopPropagation()},Object.defineProperty(this,"target",{set:function(e){this.target!==e&&(e instanceof HTMLElement?(this._target&&(this._target.removeEventListener("click",this.handleTargetClick),this._target.removeEventListener(BeFunky.pointerup,this.handleTargetClick)),this._target=e,this._target.addEventListener("click",this.handleTargetClick),this._target.addEventListener(BeFunky.pointerup,this.handleTargetClick)):BeFunky.logError("Context menu target must be HTML Element"))},get:function(){return this._target}}),this.init()}.bind(e)()};var yo=BeFunky.lit,vo=yo.html,_o=yo.useLanguageUpdate,ko=yo.lang,wo=yo.defineCustomElement,bo=yo.useState,Fo=yo.useEffect;function Bo(e){var n=this,t=e.context,o=void 0===t?"site":t,r=e.showTotalAnnualPrice,a=void 0!==r&&r,i=k(bo(null),2),s=i[0],u=i[1],c=k(bo(jt()),2),l=c[0],d=c[1];Fo(function(){n.addClass("plus-pricing"),Vt().then(function(e){u(e)}),Ht(d)},[]),_o(o);var g=0;if(s){var p=12*s.month.unit_amount;g=Math.floor(100*(p-s.year.unit_amount)/p)}return vo(mo(),"plus-pricing__card ".concat("year"===l?"plus-pricing__card--selected":""),"year"===l,function(){return Nt("year")},s?h(s.year,!0):f(),a?vo(ho(),ko(["billed_annually",{price:s?"<strong>".concat(Wt(s.year,BeFunky.LanguageManager.language[o]),"</strong>"):"..."}],o)):vo(fo(),ko("billed_annually_text")),g>0?vo(po(),ko(["save_percent",{percent:g.toString()}],o)):"","plus-pricing__card ".concat("month"===l?"plus-pricing__card--selected":""),"month"===l,function(){return Nt("month")},s?h(s.month):f(),ko("billed_monthly",o));function f(){return vo(go())}function h(e){switch(arguments.length>1&&void 0!==arguments[1]&&arguments[1]&&"year"===e.recurring&&(e=Object.assign({},e,{unit_amount:parseInt(e.unit_amount)/12})),e.currency){case"usd":var n=k((e.unit_amount/100).toFixed(2).split("."),2);return g("$",n[0],n[1]);case"gbp":var t=k((e.unit_amount/100).toFixed(2).split("."),2);return g("",t[0],t[1]);case"eur":var o=k((e.unit_amount/100).toFixed(2).split("."),2);return g("",o[0],o[1]);case"mxn":var r=k((e.unit_amount/100).toFixed(2).split("."),2),a=r[0],i=r[1];return g("$",a,"00"!==i?i:"","MXN");case"isk":case"nok":var s=k((e.unit_amount/100).toFixed(2).split("."),2),u=s[0],c=s[1];return vo(lo(),u,c);case"cad":var l=k((e.unit_amount/100).toFixed(2).split("."),2);return g("$",l[0],l[1],"CAD");case"aud":var d=k((e.unit_amount/100).toFixed(2).split("."),2);return g("A$",d[0],d[1]);default:BeFunky.throwError("Unhandled currency: ".concat(e.currency))}function g(e,n,t,o){return vo(co(),e,n,t?vo(uo(),t):"",o?vo(so(),o):"")}}}function Eo(e){var n=!1;function t(){if(BeFunky.throwError("Failed to load or initialize Stripe"),!n){var e=BeFunky.isOnline()?["error_please_refresh",{contact_support:BeFunky.toLinkHTML("SUPPORT")}]:"user_offline",t=BeFunky.isOnline()?"".concat(BeFunky.Params.globalImagesPath,"site/illustrations/paper-refresh.svg"):"".concat(BeFunky.Params.globalImagesPath,"site/illustrations/warning.svg");BeFunky.acknowledge(e,{imageUrl:t})}}BeFunky.showLoadScreen({onCancel:function(){n=!0,BeFunky.throwError("User cancelled load screen while waiting on Stripe JS")}}),delete window.stripe_load_error,console.log("Loading Stripe JS..."),window.loadAndInitStripe(),BeFunky.waitUntil({condition:function(){return window.stripe||window.stripe_load_error||n},onSuccess:function(){if(!n){if(BeFunky.hideLoadScreen(),window.stripe)return e();t()}},onTimeout:function(){n||(BeFunky.hideLoadScreen(),t())},interval:200,maxAttempts:25})}function Lo(){var e=_(['<button type="submit" class="button button--fullwidth button--xl button--dark-blue" data-bf="confirm-upgrade__submit">',"</button>"]);return Lo=function(){return e},e}function Io(){var e=_(['<p class="payment-modal__billing-summary">',"</p>"]);return Io=function(){return e},e}function So(){var e=_(['<span id="payment_modal_promo_spinner" class="loading-spinner payment-modal__promo-spinner"></span>']);return So=function(){return e},e}function Po(){var e=_(['\n        <div class="form-field payment-modal__promo">\n            <label class="form-field__label" for="payment_modal_promo_inputs">','</label>\n            <fieldset class="form-field__fieldset" id="payment_modal_promo_inputs">\n                <input\n                    type="text"\n                    name="promo-code"\n                    class=','\n                    id="payment_modal_promo"\n                    value=',"\n                    @change=","\n                    @keyup=","\n                    @blur=","\n                >\n                ","\n\n                <button @click=",' type="button" id="payment_modal_apply_promo" class='," .disabled=",">\n                    <span>","</span>\n                    ","\n                    ","\n                </button>\n            </fieldset>\n        </div>"]);return Po=function(){return e},e}function Co(){var e=_(['\n        <div class="form-field">\n            <label class="form-field__label" for="payment_modal_card_inputs">','</label>\n            <fieldset class="form-field__fieldset" id="payment_modal_card_inputs">\n                ',"\n                ",'\n                <div id="payment_modal_card_type" class="payment-modal__card-type">','</div>\n\n                <div class="payment-modal__field-container">\n                    ',"\n                    ","\n\n                    ","\n                    ","\n                </div>\n            </fieldset>\n        </div>"]);return Co=function(){return e},e}function xo(){var e=_(['\n        <div class="form-field">\n            <label class="form-field__label" for="payment_modal_card_holder_name">','</label>\n            <input\n                type="text"\n                name="cc-holdername"\n                class=','\n                id="payment_modal_card_holder_name"\n                data-bf="confirm-upgrade__cc-holdername"\n                autocomplete="cc-name"\n                @change=',"\n                @keyup=","\n                @blur=","\n            >\n            ","\n        </div>"]);return xo=function(){return e},e}function To(){var e=_(['<p class="form-field__error">',"</p>"]);return To=function(){return e},e}function Ao(){var e=_(['\n        <div class="form-field payment-modal__wallet" style=',">\n            ",'\n            <div class="payment-modal__wallet-divider">\n                <hr>\n                <span data-lang="or_pay_with_card"></span>\n            </div>\n        </div>']);return Ao=function(){return e},e}function Ro(){var e=_(['<div class="form-errors">\n            <div class="form-errors__container">\n                <p>',"</p>\n            </div>\n            <button @click=",' class="button button--icon button--tiny form-errors__close-button">\n                ',"\n            </button>\n        </div>"]);return Ro=function(){return e},e}function Mo(){var e=_(['<h2 class="centered-modal__heading h3">',"</h2>"]);return Mo=function(){return e},e}function Uo(){var e=_(['\n                <h2 class="centered-modal__heading h3">','</h2>\n                <p class="centered-modal__column centered-modal__subheading text-lg">',"\n            "]);return Uo=function(){return e},e}function Do(){var e=_(['<h2 class="centered-modal__heading h3">',"</h2>"]);return Do=function(){return e},e}function Oo(){var e=_(['<plus-pricing context="modal" .showTotalAnnualPrice=',"></plus-pricing>"]);return Oo=function(){return e},e}function jo(){var e=_(["\n        ","\n        ",'\n        <div class="centered-modal__column">\n            <form id="payment_modal_form" @submit=',">\n                ","\n                ","\n                ","\n                ","\n                ","\n                ","\n                ",'\n            </form>\n            <p class="payment-modal__footer">\n                ',"\n                <string>","</string>\n            </p>\n        </div>\n        "]);return jo=function(){return e},e}function No(){var e=_(["<div></div>"]);return No=function(){return e},e}function Ho(){var e=_(['<div id="payment_modal_card_cvc" class="form-field__input payment-modal__card-cvc"></div>']);return Ho=function(){return e},e}function qo(){var e=_(['<div id="payment_modal_card_expiry" class="form-field__input payment-modal__card-expiry"></div>']);return qo=function(){return e},e}function Vo(){var e=_(['<div id="payment_modal_card_number" class="form-field__input payment-modal__card-number"><span>',"</span></div>"]);return Vo=function(){return e},e}Bo.observedAttributes=["context"],wo("plus-pricing",Bo);var Wo=BeFunky.lit,Go=Wo.html,zo=Wo.elem,Xo=Wo.icon,Jo=Wo.useLanguageUpdate,$o=Wo.modalLang,Yo=Wo.defineCustomElement,Ko=Wo.useState,Qo=Wo.useEffect,Zo=function(){for(var e,n=arguments.length,t=new Array(n),o=0;o<n;o++)t[o]=arguments[o];return(e=BeFunky).logFeature.apply(e,["payment"].concat(t))},er={},nr={number:zo(Vo(),$o("loading")),expiry:zo(qo()),cvc:zo(Ho()),wallet:zo(No())},tr={number:null,expiry:null,cvc:null,wallet:null},or={};Yo("payment-form",function(e){var n=e.mode,t=e.email,r=e.initialPromoCode,a=e.onPaymentSubmit;if(!["charge","update","update_from_payflow","free_trial"].includes(n))throw new Error("Invalid payment form mode: ".concat(n));var i=k(Ko(jt()),2),u=i[0],l=i[1],d=k(Ko(),2),g=d[0],p=d[1],f=k(Ko("object"===o(window.stripe)),2),h=f[0],m=f[1],y=k(Ko({}),2),v=y[0],_=y[1],w=k(Ko(""),2),b=w[0],F=w[1],B=k(Ko(r),2),E=B[0],L=B[1],I=k(Ko(!1),2),S=I[0],P=I[1],C=k(Ko(!1),2),x=C[0],T=C[1];Object.assign(or,{displayError:$,clearError:J,getSharedSubmitData:X,onPaymentSubmit:a,prices:g,recurring:u,setCardType:F,setWalletAvailable:T}),Zo("Render",{recurring:u,prices:g,isStripeLoaded:h,errors:v,cardType:b,promoCode:E,isValidatingPromo:S,isWalletAvailable:x});var A,R,M,U,D=["update","update_from_payflow"].includes(n),O=x&&!D,j="charge"===n&&"string"==typeof r,N=j&&!0===er[E],H=N||"free_trial"===n;return Qo(function(){Vt().then(function(e){p(e)}),Ht(l)},[]),Qo(function(){if(h){if(h&&g){var e=(n=BeFunky.LanguageManager.language.modal,t=["bg","cs","da","de","el","en","es","et","fi","fr","hu","id","it","ja","lt","lv","ms","mt","nb","nl","pl","pt","ro","ru","sk","sl","sv","tr","zh"].includes(n)?n:"auto",window.stripe.elements({locale:t,fonts:[{cssSrc:"https://fonts.googleapis.com/css2?family=Mulish:wght@400&display=swap"}]}));!function(e){var n={style:{base:{color:"#1D1B2F",fontWeight:400,fontFamily:"Mulish, Avenir Next, Trebuchet MS, system-ui, sans-serif",fontSize:"16px",fontSmoothing:"antialiased",lineHeight:"24px","::placeholder":{color:"#84809D"}},invalid:{color:"#1D1B2F"}},classes:{focus:"form-field__input--focused",invalid:"form-field__input--invalid"}};tr.number=e.create("cardNumber",n),tr.number.mount(nr.number),tr.number.on("change",function(e){var n=e.brand,t=e.error;n&&or.setCardType("unknown"===n?"":n),t?or.displayError("number",t.message):or.clearError("number")}),tr.expiry=e.create("cardExpiry",n),tr.expiry.mount(nr.expiry),tr.expiry.on("change",function(e){var n=e.error;n?or.displayError("expiry",n.message):or.clearError("expiry")}),tr.cvc=e.create("cardCvc",n),tr.cvc.mount(nr.cvc),tr.cvc.on("change",function(e){var n=e.error;n?or.displayError("cvc",n.message):or.clearError("cvc")})}(e),BeFunky.Params.isBeta&&function(e){var n=window.stripe.paymentRequest(c(c({},o()),{},{country:Rt(),requestPayerName:!0,requestPayerEmail:!0})),t=e.create("paymentRequestButton",{paymentRequest:n});function o(){var e=or.prices[or.recurring],n=e.unit_amount,t=e.currency;return{currency:t,total:{label:"month"===or.recurring?"BeFunky Plus Monthly":"BeFunky Plus Annual",amount:n}}}n.canMakePayment().then(function(e){Zo("canMakePayment",e),e?(or.setWalletAvailable(!0),t.mount(nr.wallet),n.on("paymentmethod",function(e){e&&e.paymentMethod&&or.onPaymentSubmit(c({paymentRequestPaymentMethod:e.paymentMethod,paymentRequestCompleteFunction:e.complete},or.getSharedSubmitData()))})):or.setWalletAvailable(!1)}),Ht(function(){Promise.resolve().then(function(){n.update(o())})})}(e)}}else Eo(function(){return m(!0)});var n,t},[h,g]),Qo(function(){j&&r?K(r):j||L()},[r]),Jo("modal"),Go(jo(),D?Go(Do(),$o("payment_modal_heading_update")):"free_trial"===n?Go(Uo(),$o("payment_modal_heading_7_day_trial"),$o("payment_modal_subheading_trial")):Go(Mo(),$o("payment_modal_heading")),D?"":Go(Oo(),!0),z,v.form?Go(Ro(),$o(v.form),function(){return J("form")},Xo("global-cancel-icon","icon icon-size-medium")):"",Go(Ao(),"display: ".concat(O?"":"none"),nr.wallet),(U=BeFunky.debounce(V,100),Go(xo(),$o("payment_modal_cc_name"),"form-field__input ".concat(v.name?"form-field__input--invalid":""),U,U,U,q("name"))),(["number","expiry","cvc"].forEach(function(e){v[e]&&nr[e].addClass("form-field__input--invalid")}),Go(Co(),$o("payment_modal_cc_info"),nr.number,q("number"),b?Xo("cc-".concat(b)):"",nr.expiry,q("expiry"),nr.cvc,q("cvc"))),j?(R=BeFunky.debounce(W,100),M=S||N?"payment-modal__promo-button button button--md button--secondary":"payment-modal__promo-button button button--md button--medium-grey",Go(Po(),$o("promo_code"),"form-field__input payment-modal__promo-input ".concat(v.promo?"form-field__input--invalid":""),r,R,R,R,q("promo"),G,M,S||Boolean(v.promo),$o(N?"promo_applied":"apply_promo"),N?Xo("checkmark","icon payment-modal__promo-checkmark"):"",S?Go(So()):"")):"",D?"":function(){if(!g)return"";var e="month"===u?"billing_summary_monthly":"billing_summary_annual";H&&(e+="_trial");var n={amount:function(){return"<strong>".concat(Wt(g[u],BeFunky.LanguageManager.language.modal),"</strong>")},subscription_policy:BeFunky.toLinkHTML("".concat(BeFunky.Params.siteUrl,"terms/?cmfrm=1#renewals"),!0)};return Go(Io(),$o([e,n]))}(),(A="submit_payment",H&&(A="start_trial"),D&&(A="update"),Go(Lo(),$o(A))),Xo("lock","icon",{style:"margin-top: -4px;"}),$o("payment_modal_digicert"));function q(e){var n=v[e]?$o(v[e]):"";return Go(To(),n)}function V(e){var n,t,o=e.target;t=(n=o).value.replace(/[\d@~`#$%^&*()\\\/<>! +=:;"{}[\]|?]/g,""),n.value=t,t.length>=3?J("name"):$("name","error_blank_name")}function W(e){var n,t,o=e.target;t=(n=o).value.replace(/[^a-z0-9-]/g,""),n.value=t,!t||t.length>=10&&!1!==er[t]?J("promo"):$("promo","error_invalid_promo_code"),L(o.value)}function G(){K(document.getElementById("payment_modal_promo").value.trim())}function z(e){e.preventDefault(),v.form&&J("form");var n=document.getElementById("payment_modal_card_holder_name"),t=n.value.trim();!v.name&&t?tr.number&&a(c({cardHolderName:t,stripeElement:tr.number},X())):n.dispatchEvent(new Event("change"))}function X(){return{email:t,mode:n,recurring:u,displayError:$,clearInputs:Y,promoCode:N?E:void 0}}function J(e){if(v.hasOwnProperty(e)){var n=Object.assign({},v);delete n[e],_(n)}}function $(e,n){var t="string"==typeof n&&/^[a-z0-9_]+$/.test(n)?BeFunky.LanguageManager.getString(n,"modal"):n;["name","number","expiry","cvc","promo","form"].includes(e)||BeFunky.throwError("Invalid field name: ".concat(e)),_(Object.assign({},v,s({},e,t))),console.log("Payment error displayed ".concat("form"===e?"on form":"on ".concat(e," field"),': "').concat(t,'"'))}function Y(){document.getElementById("payment_modal_card_holder_name").value="",tr.number.clear(),tr.expiry.clear(),tr.cvc.clear()}function K(e){er.hasOwnProperty(e)||(P(!0),BeFunky.requestAPI("transaction/validate-promo-code",{promo_code:e}).then(function(n){if("success"!==n.data)throw"invalid_response";er[e]=!0}).catch(function(n){"invalid_promo_code"===n?(er[e]=!1,$("promo","error_invalid_promo_code")):$("promo",BeFunky.failureReason(n))}).then(function(){P(!1)}))}}),BeFunky.isUseHTML5=!0,BeFunky.html5app_created=!1,BeFunky.flashDisabledPanel=null,BeFunky.originalPageTitle=document.title,BeFunky.appTemplate=null,BeFunky.appTemplateInjected=Boolean(document.getElementById("bfn-app").firstElementChild),BeFunky.readyHtml5App=function(){if(!BeFunky.html5app_created&&BeFunky.Params.canUseWebapp){if(BeFunky.appTemplateInjected)return document.getElementById("bfn-app").addClass("app-lang-".concat(BeFunky.LanguageManager.language.app)),e();BeFunky.showLoadScreen(),BeFunky.waitUntil({condition:function(){return null!==BeFunky.appTemplate&&!1===BeFunky.appTemplateInjected},onSuccess:function(){var n=BeFunky.appTemplate.content;BeFunky.appTemplateInjected=!0,BeFunky.LanguageManager.renderLanguageStrings(n),document.getElementById("bfn-app").addClass("app-lang-".concat(BeFunky.LanguageManager.language.app)).appendChild(n),BeFunky.cleanupEnterAppImmediately(),e()},onTimeout:function(){if(console.log("BeFunky.appTemplate",BeFunky.appTemplate),console.log("BeFunky.appTemplateInjected",BeFunky.appTemplateInjected),navigator.connection){console.log("Connection info:",["downlink","effectiveType","rtt"].map(function(e){return"\t".concat(e,": ").concat(navigator.connection[e])}).join("\t"))}BeFunky.throwError("Unable to inject bfn-app template in #bfn-app DIV."),BeFunky.hideLoadScreen()},interval:100,maxAttempts:300})}function e(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];t&&(window.appBundleLoaded||n("bundle",function(){return window.scriptHasLoaded("app")}),window.PIXI||n("scripts",function(){return window.scriptHasLoaded("scripts")})),BeFunky.waitUntil({condition:function(){return window.PIXI&&window.BFN&&window.BFN.readyApp&&BeFunky.svgSpriteLoaded},onSuccess:function(){t||(BeFunky.trackUserTiming("App Init","app_bundle","network")(Math.round(window.appBundleLoadTime)),BeFunky.trackUserTiming("App Init","scripts_js","network")(Math.round(window.scriptsLoadTime)));var e=function(){BFN.readyApp(function(){BeFunky.html5app_created=!0})};if(!BeFunky.Params.isAdmin||!window.adminScriptsPromise)return e();window.adminScriptsPromise.then(function(){window.dispatchEvent(new Event("BEFORE_INIT")),e()})},onTimeout:function(){if(console.log("typeof PIXI = ",o(window.PIXI)),console.log("typeof BFN = ",o(window.BFN)),window.BFN&&console.log("typeof BFN.readyApp = ",o(window.BFN.readyApp)),console.log("BeFunky.svgSpriteLoaded = ",BeFunky.svgSpriteLoaded),console.log("window.appBundleLoaded = ",window.appBundleLoaded),navigator.connection){console.log("Connection info:",["downlink","effectiveType","rtt"].map(function(e){return"\t".concat(e,": ").concat(navigator.connection[e])}).join("\t"))}if(!t)return BeFunky.throwError("Unable to initialize WebGL app. Attempting to load scripts with XHR..."),e(!0);BeFunky.throwError("Unable to initialize WebGL app."),BeFunky.hideLoadScreen(),BeFunky.acknowledge(["error_please_refresh",{contact_support:BeFunky.toLinkHTML("SUPPORT")}],{onAcknowledge:function(){return window.location.reload()},imageUrl:"".concat(BeFunky.Params.globalImagesPath,"site/illustrations/paper-refresh.svg")})},interval:10,maxAttempts:3e3})}function n(e,n){var t=document.querySelector('script[src*="/'.concat(e,'."]'));if(!t){var o=w(document.querySelectorAll("script")).map(function(e){return e.src}).filter(Boolean);return console.log("Scripts found:",JSON.stringify(o)),BeFunky.throwError('No script matching script[src*="/'.concat(e,'."]'))}var r=t.src;BeFunky.loadScriptWithXHR(r).then(function(){n(),BeFunky.throwError("Successfully loaded ".concat(e," with XHR"),r)}).catch(function(n){BeFunky.throwError("Unable to load ".concat(e," with XHR"),n,r)})}},BeFunky.prepareHtml5App=function(){if(BeFunky.isUseHTML5&&BeFunky.Params.canUseWebapp){var e=BeFunky.trackUserTiming("App Init","svg_and_html","network");Promise.all([BeFunky.loadSVGSprite(),BeFunky.loadAppHTML()]).then(function(){e()},function(e){BeFunky.throwError("App could not start up b/c SVG or HTML failed to load",e)})}};var rr,ar,ir,sr,ur,cr,lr=BeFunky.appTemplateInjected?Promise.resolve():void 0;BeFunky.loadAppHTML=function(){return lr||(lr=new Promise(function(e,n){var t="".concat(BeFunky.Params.globalAssetsPath,"html/bfn-app-min").concat(BeFunky.Params.BFN_APP_HTML_VERSION,".txt");BeFunky.request(t,{responseType:"text"},function(o){var r=o.error,a=o.response;if(r||!a||!a.length)return BeFunky.logError("Unable to download app HTML txt file",t,r||BeFunky.stringValue(a)),lr=void 0,n(r);BeFunky.appTemplate=document.createElement("template"),BeFunky.appTemplate.innerHTML=a,e()})}))},BeFunky.svgSpriteLoaded=!1,BeFunky.loadSVGSprite=function(){return rr||(rr=new Promise(function(e,n){var t="".concat(BeFunky.Params.globalAssetsPath,"icons/sprite").concat(BeFunky.Params.svgSpriteVersion,".svg");BeFunky.request(t,{responseType:"text"},function(t){var o=t.error,r=t.response;if(o)return BeFunky.logError("Unable to download SVG sprite",o),rr=void 0,n(o);var a=r.match(/<svg ([\s\S]*?)<\/svg>/g);if(!a||!a[0])return BeFunky.logError("Invalid SVG sprite response:",r),rr=void 0,n("invalid_response");BeFunky.onDocumentReady(function(){document.getElementById("svgContainer").innerHTML=a[0],BeFunky.svgSpriteLoaded=!0,e()})})}))},BeFunky.loadSVGSprite().catch(function(){}),window.caledFunctionName=null,window.calledParams=null,window.isFlashOpenned=!1,BeFunky.siteScrollY=0,window.openFlash=function(){if(BeFunky.Params.canUseWebapp){1===BeFunky.sessionRoutes.length&&BeFunky.isCreateRoute(BeFunky.sessionRoutes[0])?BeFunky.siteScrollY=0:BeFunky.siteScrollY=window.pageYOffset||0,window.isFlashOpenned=!1!==BeFunky.Params.isFlashPlayerCorrect||!0===BeFunky.isUseHTML5;var e=document.getElementById("bfn-app"),n=document.getElementById("appl-for-flash");if(BeFunky.isUseHTML5&&e&&"block"===e.style.display)BeFunky.logError("openFlash called unnecessarily b/c WebGL app is already open");else{BeFunky.moveModalRoot(e),BeFunky.moveLoadScreen(e),document.getElementById("main").setStyles({top:"0px",left:"",width:BeFunky.isUseHTML5?"100%":"".concat(window.setInitFlashWidth(),"px"),height:BeFunky.isUseHTML5?"100%":"".concat(window.setInitFlashHeight(),"px"),pointerEvents:""});var t=document.getElementById("site_root")||document.getElementById("wrapper");if(t.setStyles({display:"none"}),w(t.querySelectorAll('video, iframe[src^="https://player.vimeo.com"]')).forEach(function(e){"VIDEO"===e.nodeName?e.pause():e.contentWindow.postMessage(JSON.stringify({method:"pause"}),"*")}),document.body.addClass("prevent-body-scroll"),BeFunky.updateThemeColor("app"),BeFunky.LanguageManager.setLanguage(BeFunky.LanguageManager.language.app,["modal"]),BeFunky.isUseHTML5)return e.setStyles({display:"block"}),n.setStyles({display:"none"}),void BeFunky.readyHtml5App();n.setStyles({top:0,left:0,display:"block"}),e.setStyles({display:"none"});var o,r=document.getElementById(BeFunky.Params.swfId);try{r.setAttribute("width",window.setInitFlashWidth()),r.setAttribute("height",window.setInitFlashHeight())}catch(e){}BeFunky.isPlus()||1!==BeFunky.Params.isShowAds||window.calculateAdWidth(),window.scrollTo(0,0),BeFunky.isPlus()||1!==BeFunky.Params.isShowAds||window.flasRightBarAdDisplay(),setTimeout(function(){try{window.dispatchEvent(new Event("resize"))}catch(e){}},30);var a=r,i=setInterval(function(){a||(a=document.getElementById(BeFunky.Params.swfId)),window.isFlashCreationComplated?(clearInterval(i),o&&o()):o||a&&"function"===a.PercentLoaded||(o=BeFunky.promptUserToEnableFlash())},111)}}else BeFunky.logError("App not opened b/c device is mobile")},BeFunky.cleanupEnterAppImmediately=function(){var e=document.getElementById("app_loading_overlay");e&&(e.setStyles({display:"none"}),requestIdleCallback(function(){e.parentElement&&e.parentElement.removeChild(e)}))},window.urlUpload=function(e,n,t){BeFunky.befunkyPopupContainerClose(),window.currentDeepLinkParameters.img=e,window.isFlashCreationComplated&&window.applyDeepLinkParameters()},window.setDesignerTemplate=function(e,n){BeFunky.isUseHTML5?BeFunky.throwError("setDesignerTemplate deprecated"):e&&document.getElementById(BeFunky.Params.swfId).updateDefaultDesignerTemplate(e)},window.setPhotoEditorImage=function(e){BeFunky.isUseHTML5?BeFunky.throwError("setPhotoEditorImage deprecated"):document.getElementById(BeFunky.Params.swfId).ToJsUrlUploader(e,null,!1)},window.goToenableFlashPlugin=function(e){(e.includes("adobe.com")||e.includes("befunky.com"))&&(window.location.href=e,window.setCookie("cufpeclck","1",365),window.bf_eventTrack("EXTERNAL","FLASH_DETECT","CLICK_ENABLE"))},window.setApplicationMode=function(e){e&&"string"==typeof e||(e="photoeditor"),BeFunky.isUseHTML5?BeFunky.html5app_created&&BFN.AppModel.applicationModeChange(e):document.getElementById(BeFunky.Params.swfId).ApplicationModeChange(e)},window.currentDeepLinkParameters={type:"photoeditor"},window.openUploadPanel=function(e){var n=window.deepLinkRouteData[e]||e||{},t=n.type,o=void 0===t?"photoeditor":t,r=n.img,a=n.template,i=n.tag,s=n.ignoreExistingProject,u=void 0!==s&&s,c=n.availability;if(!BeFunky.Params.canUseWebapp)return BeFunky.logError("Deep link to app not opened b/c device is mobile"),BeFunky.handleMobileUserAttemptToOpenApp(c),void BeFunky.leaveCreateRoute();if(window.failed_webgl_tests.length&&!window.has_acknowledged_webgl_issue&&BeFunky.isUseHTML5){window.has_acknowledged_webgl_issue=!0;var l=window.failed_webgl_tests,d={failingTests:l,hasUsedAppBefore:Boolean("1"===getCookie("gl_sprt")||BeFunky.getLocal("__IndexedDB_version"))};if(l.includes("no_high_perf_canvas")){var g='\n                <p data-lang="acknowledge_perf_issue">'.concat(BeFunky.LanguageManager.getString("acknowledge_perf_issue"),"</p>\n                <p>").concat(BeFunky.toLinkHTML(function(){if(BeFunky.isChromium)return BeFunky.isEdge?"https://support.befunky.com/hc/en-us/articles/360054839372":"https://support.befunky.com/hc/en-us/articles/360054508232";return BeFunky.isFirefox?"https://support.befunky.com/hc/en-us/articles/360054510672":"https://support.befunky.com/hc/en-us/articles/360051734551"}(),!0)("learn_more","app"),"</p>\n            ");BeFunky.acknowledge(g,{isCritical:!0}),BeFunky.reportWarning("User entered app without high perf canvas",window.webglUnmaskedRenderer,JSON.stringify(d))}else BeFunky.reportWarning("User entered app after WebGL test failed ".concat(window.failed_webgl_tests[0]),JSON.stringify(d))}if(console.log("Handling ".concat(BeFunky.isUseHTML5?"WebGL":"Flash"," deep link. Type = ").concat(o,". Waiting on WebGl? ").concat(BeFunky.webGLDetectionComplete?"no":"yes")),BeFunky.webGLDetectionComplete){!BeFunky.isUseHTML5&&BeFunky.Params.isShowAds<1&&window.flashFreeTop>0&&(window.removeAds(),window.flashFreeTop=0,window.flashFreeRight=0,window.isflashFreeRight=!1);var p=!BeFunky.html5app_created&&BeFunky.Params.openurl?BeFunky.Params.openurl:r;if(window.currentDeepLinkParameters={type:o,template:a,tag:i,img:p,ignoreExistingProject:u},BeFunky.isUseHTML5)return BeFunky.setupPaywallOnce(),window.openFlash(),void window.applyDeepLinkParameters();BeFunky.acknowledge(BeFunky.webGLTestResultsTemplate(window.failed_webgl_tests,!1)),BeFunky.leaveCreateRoute(),window.failed_webgl_tests.length||BeFunky.throwError("BeFunky.isUseHTML5 inaccurate")}else{var f=!1;document.querySelector(".site-root--enter-app-immediately")||BeFunky.showLoadScreen({onCancel:function(){f=!0}});var h=Date.now(),m=!1;BeFunky.waitUntil({condition:function(){return!m&&Date.now()-h>1e3&&(BeFunky.logError("Waiting on /status/ and DOM ready before opening app."),m=!0),BeFunky.webGLDetectionComplete||f},onSuccess:function(){if(f)return BeFunky.leaveCreateRoute();BeFunky.hideLoadScreen(),window.openUploadPanel(e)},onTimeout:function(){if(f)return BeFunky.leaveCreateRoute();BeFunky.hideLoadScreen(),BeFunky.logError("Unable to open app b/c __bfnDefferReady() was not called after 10 seconds"),BeFunky.leaveCreateRoute()},interval:100,maxAttempts:100})}},BeFunky.setupPaywallOnce=BeFunky.once(function(){if(!BeFunky.getFreeTrialEnabled()&&BeFunky.isNewUserInUSA){if([["/features/photo-to-art/","/create/photo-to-art/"],["/features/photo-to-cartoon/","/create/photo-to-cartoon/"]].some(function(n){return BeFunky.sessionRoutes.map(e).isIdenticalTo(n)}))Xt(!0),bf_eventTrack("ONBOARDING_7DAY_TRIAL_SAVE","TRIAL OFFERED",BeFunky.initialRoute.split(/[?#]/)[0].split("/").filter(Boolean).pop())}function e(e){return e.split(/[?#]/)[0]}}),BeFunky.leaveCreateRoute=function(){setTimeout(function(){BeFunky.isCreateRoute()&&(BeFunky.sessionRoutes.length>1?window.history.back():BeFunky.canonicalRoute?BeFunky.pushRoute(BeFunky.canonicalRoute):BeFunky.throwError("Unable to leave create route")),BeFunky.updateThemeColor("site"),BeFunky.measureSiteNavDropdowns&&BeFunky.measureSiteNavDropdowns(),"none"!==document.getElementById("bfn-app").style.display&&window.hideEditor()},0)},BeFunky.handleMobileUserAttemptToOpenApp=function(e){var n="web_mobile_apps"===e,t="web_visionn_app"===e&&BeFunky.isIOS;if(n||t){var o=document.createElement("div");o.appendChild(document.createElement("p").setLang("try_mobile_app","site")),o.appendChild(document.createElement("p").setLang("edits_on_the_go","site"));var r=BeFunky.isIOS?"open_app_store":"open_play_store";return BeFunky.confirm(o,{confirmText:r,onConfirm:function(){window.open(s(),"_blank")}})}var a=document.createElement("div");a.appendChild(document.createElement("p").setLang("accessible_from_desktop","site")),a.appendChild(document.createElement("p").setLang("great_mobile_app","site"));var i=BeFunky.isIOS?"open_app_store":"open_play_store";return BeFunky.confirm(a,{confirmText:i,onConfirm:function(){window.open(s(),"_blank")}});function s(){if(t)return"https://itunes.apple.com/app/apple-store/id1142803226?mt=8";if(BeFunky.isIOS)return"https://itunes.apple.com/us/app/befunky-photo-editor/id442716817?mt=8";var e=/mobile/i.test(navigator.userAgent)?"BeFunkyPhotoEditor":"BeFunkyPad";return"https://play.google.com/store/apps/details?id=air.com.befunky.".concat(e)}},BeFunky.trackDeepLink=function(e,n){if("string"!=typeof e)return BeFunky.throwError("Invalid action: ".concat(BeFunky.getType(e)),e);if(BeFunky.Params.canUseWebapp||(e="".concat(e,"_").concat(BeFunky.isIOS?"IOS":"ANDROID")),!n){var t=w(BeFunky.sessionRoutes).reverse().find(function(e){return!BeFunky.isCreateRoute(e)});if(!t)return console.log("Session routes:",JSON.stringify(BeFunky.sessionRoutes)),void(BeFunky.isUseHTML5?BeFunky.throwError("Unable to find non-create route to track Deep Link button click"):BeFunky.logError("Deep Link button clicked after user failed to enter Flash app via deep link"));n="/"===t?"HOME":t.split("?")[0].split("#")[0].replace(/(^\/)|(\/$)/g,"").replace(/\//g,"_").toUpperCase()}window.bf_eventTrack("EXTERNAL",e,n)},window.hideEditor=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(console.log("Hiding ".concat(BeFunky.isUseHTML5?"WebGL":"Flash"," app")),BeFunky.isUseHTML5?document.getElementById("appl-for-flash").setStyles({display:"none"}):document.getElementById("appl-for-flash").setStyles({top:"-5000px",left:"-5000px"}),document.getElementById("bfn-app").setStyles({display:"none"}),BeFunky.moveModalRoot(document.body),BeFunky.moveLoadScreen(document.body),document.getElementById("main").setStyles({top:"-5000px",left:"-5000px"}),(document.getElementById("site_root")||document.getElementById("wrapper")).setStyles({display:""}),BeFunky.updateThemeColor("site"),window.flasRightBarAdDisplay(!0),BeFunky.isPlus()||window.calculateAdWidth(),!0!==BeFunky.befunkyPopupDivOpened&&document.body.removeClass("prevent-body-scroll"),window.isFlashOpenned=!1,document.title=BeFunky.originalPageTitle,BeFunky.LanguageManager.setLanguage(BeFunky.LanguageManager.language.site,["modal"]),(BeFunky.isUseHTML5||!e)&&BeFunky.isCreateRoute()){var n=w(BeFunky.sessionRoutes).slice(1).reverse().find(function(e){return!BeFunky.isCreateRoute(e)});"string"==typeof n?BeFunky.pushRoute(n):"string"==typeof BeFunky.canonicalRoute?BeFunky.pushRoute(BeFunky.canonicalRoute):BeFunky.logError("Unable to swap out create route for new one"),BeFunky.isUseHTML5||window.hideModalBackgroundImage()}return window.scrollTo?window.scrollTo(0,BeFunky.siteScrollY):document.documentElement.scrollTop=BeFunky.siteScrollY,BeFunky.measureSiteNavDropdowns&&BeFunky.measureSiteNavDropdowns(),window.Sentry&&Sentry.configureScope(function(e){e.setTag("app_section","site")}),!1},window.isFlashCreationComplated=!1,window.isFlashLoginCalled=!1,window.flashCreationComplateHandler=function(){if(BeFunky.flashDisabledPanel&&BeFunky.flashDisabledPanel.setStyles({display:"none"}),BeFunky.Params.openurl&&window.urlUpload(BeFunky.Params.openurl),window.isFlashCreationComplated=!0,window.applyDeepLinkParameters(),(!0===BeFunky.ISNOT_FLASH_LOGGEDIN||!1===window.isFlashLoginCalled)&&BeFunky.User.FlashVarsObject){try{document.getElementById(BeFunky.Params.swfId).userValueObj(BeFunky.User.FlashVarsObject)}catch(e){}!1===BeFunky.ISNOT_FLASH_LOGGEDIN&&(window.isFlashLoginCalled=!0),BeFunky.ISNOT_FLASH_LOGGEDIN=!1}},window.openEditor=function(e){return window.openUploadPanel(e)},window.applyDeepLinkParameters=function(){var e=window.currentDeepLinkParameters,n=e.type,t=e.template,o=e.tag,r=e.img,a=e.ignoreExistingProject;if(console.log("Entering app w/ deep link parameters:",window.currentDeepLinkParameters),!BeFunky.isUseHTML5)return window.setApplicationMode(n),"designer"===n&&(t||o)?window.setDesignerTemplate(t,o):r?window.setPhotoEditorImage(r,a):void 0;if(r){var i=a?"befunky":"sample";BeFunky.editorExternalImage={ignoreExistingProject:a,loadImage:function(){BFN.BfnService.ToJsUrlUploader(r,null,!0,i)}}}window.setApplicationMode(n)},BeFunky.promptUserToUpdateFlash=function(){var e=document.createElement("p").setLang("update_flash_prompt","site"),n=document.createElement("p").setLang("enable_flash_link",{tutorial:BeFunky.toLinkHTML("https://support.befunky.com/hc/en-us/articles/218015043-How-to-enable-Flash-Player",!0)},"site"),t=document.createElement("div");t.appendChild(e),t.appendChild(n),BeFunky.acknowledge(t,{buttonText:"update_flash_button",onAcknowledge:function(){window.open("https://get.adobe.com/flashplayer/","_blank")}})},BeFunky.promptUserToEnableFlash=function(){var e="";e=BeFunky.isChrome?"Chrome":BeFunky.isFirefox?"Firefox":BeFunky.isSafari?"Safari":BeFunky.isEdge?"Microsoft Edge":BeFunky.LanguageManager.getString("your_browser");var n=document.createElement("p").setLang("enable_flash_prompt",{browser:e,enable_flash_button:function(){return BeFunky.LanguageManager.getString("enable_flash_button")}},"site"),t=document.createElement("p").setLang("enable_flash_link",{tutorial:BeFunky.toLinkHTML("https://support.befunky.com/hc/en-us/articles/218015043-How-to-enable-Flash-Player",!0)},"site"),o=document.createElement("div");if(o.appendChild(n),o.appendChild(t),window.bf_eventTrack("EXTERNAL","FLASH_DETECT","SHOW_ENABLE"),!BeFunky.isFirefox)return BeFunky.acknowledge(o,{heading:["enable_flash_heading",{browser:e}],buttonText:"enable_flash_button",onAcknowledge:function(){if(!window.isFlashCreationComplated){window.goToenableFlashPlugin("https://get.adobe.com/flashplayer/");var n=document.createElement("div"),o=document.createElement("div").setStyles({position:"absolute",left:"-6rem",top:"-4rem",color:"white",fontSize:"100px",transform:"rotate(-45deg)"});o.textContent="",((r=navigator.userAgent.match(/Chrome\/([0-9]+)\./))?parseInt(r[1]):0)>=76?o.setStyles({display:"none"}):(BeFunky.isEdge||"ar"===window.browserlng)&&o.setStyles({left:"",right:"-6rem",transform:"rotate(45deg)"}),n.appendChild(o),n.appendChild(t),BeFunky.acknowledge(n,{heading:["enable_flash_heading",{browser:e}],onAcknowledge:function(){}})}var r}});if(!BeFunky.flashDisabledPanel){BeFunky.flashDisabledPanel=document.createElement("div"),BeFunky.flashDisabledPanel.setStyles({position:"absolute",top:"50%",left:"50%",height:"270px",maxWidth:"450px",marginTop:"-150px",marginLeft:"-225px",padding:"20px 30px",zIndex:"1",pointerEvents:"none",background:"#fff"}),BeFunky.flashDisabledPanel.innerHTML='\n                <h4 style="margin-bottom:18px;">Enable Flash for Firefox</h4>\n                <p>Firefox now requires you to enable Flash to use BeFunky. Don\'t worry, it\'s easy to do. Click the <strong>Enable Flash</strong> button below, then click <strong>Allow</strong> when Firefox\'s prompt appears.</p>\n                <button class="button button--blue" style="padding: 0 1rem;">Enable Flash</button>\n            ';var r=document.getElementById("main");r.insertBefore(BeFunky.flashDisabledPanel,r.firstElementChild)}BeFunky.flashDisabledPanel.setStyles({display:"block"})},document.addEventListener("visibilitychange",function(){var e=new Date,n="".concat(e.getHours(),":").concat(e.getMinutes(),":").concat(e.getSeconds());BeFunky.Params.IS_LC||console.log("Tab ".concat(document.visibilityState," at ").concat(n))}),BeFunky.updateThemeColor=function(e){},window.getWindowWidth=function(){return window.innerWidth},window.getWindowHeight=function(){return window.innerHeight},window.setInitFlashHeight=function(){var e=getWindowHeight();return window.flashFreeTop>0&&(e-=window.flashFreeTop),e},window.setInitFlashWidth=function(){var e=getWindowWidth();if(sr=sr||document.getElementById("main"),window.isflashFreeRight){e>=980?170!=window.flashFreeRight&&(window.flashFreeRight=170,"-5000px"!=sr.style.top&&addRightAds(!0)):e<980&&0!=window.flashFreeRight&&(window.flashFreeRight=0,removeAds(!0));try{var n=setInitFlashHeight()/2-300;n<5&&(n=5),document.getElementById("0x00001002").style.paddingTop="".concat(n,"px")}catch(e){}e-=window.flashFreeRight}return e},window.reResizeFlashHeight=function(){if(!BeFunky.isUseHTML5&&(BeFunky.isPlus()&&(window.removeAds(),window.flashFreeTop=0,window.flashFreeRight=0,window.isflashFreeRight=!1),"-5000px"!=(sr=sr||document.getElementById("main")).style.top&&"-5000"!=sr.style.top&&-5e3!=sr.style.top)){if(BeFunky.isPlus()||calculateAdWidth(),sr.setStyles({top:"",left:"",width:"".concat(setInitFlashWidth(),"px"),height:"".concat(setInitFlashHeight(),"px")}),!1===BeFunky.isUseHTML5)try{(cr=cr||document.getElementById(BeFunky.Params.swfId)).setAttribute("width",setInitFlashWidth()),cr.setAttribute("height",setInitFlashHeight())}catch(e){}(ur=ur||document.getElementById("site_root")||document.getElementById("wrapper")).setStyles({display:"none"});try{window.dispatchEvent(new Event("resize"))}catch(e){}}},window.calculateAdWidth=function(){var e=getWindowWidth(),n=e;ar=ar||document.getElementById("socialSharingDiv"),ir=ir||document.getElementById("relamIc"),ar&&"none"!==ar.style.display&&(n=e-240),ir&&ir.setStyles({width:"".concat(n,"px"),margin:"0px 0 0 0"})},window.windowOpenerInterval=null,window.createJavascriptElements=function(e,n){var t,o,r,a,i,s;null!=e&&(t=e,o=null,r=null,a=null,i=n,(s=document.createElement("script")).type="text/javascript",s.async=null==n,s.src=t,o&&(s.id=o),r&&s.setAttribute(r,a),null!=i&&(s.onreadystatechange=i,s.onload=i),(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(s))},window.toFlex=function(e){if(null!=windowOpenerInterval)try{clearInterval(windowOpenerInterval)}catch(e){}windowOpenerInterval=null},window.CheckVersion=function(){if(!BeFunky.isUseHTML5){var e="undefined";try{e=swfobject.getFlashPlayerVersion().major,"undefined"!=typeof swfobject&&null!=e&&e>=parseInt(BeFunky.Params.swfMinVersion.split(".")[0])!=!0&&(BeFunky.Params.isFlashPlayerCorrect=!1)}catch(e){BeFunky.Params.isFlashPlayerCorrect=!0}}},window.isEmailAddress=function(e){return/^[\w-+]+(\.[\w-+]+)*@([\w-]+\.)+[a-zA-Z]{2,10}$/.test(e)},window.StringBuffer=function(){this.buffer=[]},window.StringBuffer.prototype.append=function(e){return this.buffer.push(e),this},window.StringBuffer.prototype.toString=function(){return this.buffer.join("")},window.azrNumberFormatterRanges=[{divider:1e18,suffix:"P"},{divider:1e15,suffix:"E"},{divider:1e12,suffix:"T"},{divider:1e9,suffix:"G"},{divider:1e6,suffix:"M"},{divider:1e3,suffix:"K"}],window.azrFormatNumber=function(e){if(e<1e4)return e.toString();var n=10;(e>=1e5&&e<1e6||e>=1e8&&e<1e9)&&(n=0);for(var t=0;t<azrNumberFormatterRanges.length;t++)if(e>=azrNumberFormatterRanges[t].divider)return(Math.round(e/azrNumberFormatterRanges[t].divider*n)/n).toString()+azrNumberFormatterRanges[t].suffix;return e.toString()},window.azrUnformatNumber=function(e){e=e.toString();for(var n=0;n<azrNumberFormatterRanges.length;n++)if(e.substr(e.length-1)===azrNumberFormatterRanges[n].suffix)return parseInt(parseFloat(e.substr(0,e.length-1))*azrNumberFormatterRanges[n].divider);return parseInt(e)};try{window.base64_encode=function(e){for(var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",t=new StringBuffer,o=new Utf8EncodeEnumerator(e);o.moveNext();){var r=o.current;o.moveNext();var a=o.current;o.moveNext();var i=o.current,s=r>>2,u=(3&r)<<4|a>>4,c=(15&a)<<2|i>>6,l=63&i;isNaN(a)?c=l=64:isNaN(i)&&(l=64),t.append(n.charAt(s)+n.charAt(u)+n.charAt(c)+n.charAt(l))}return t.toString()}}catch(e){}try{window.base64_decode=function(e){for(var n=new StringBuffer,t=new Base64DecodeEnumerator(e);t.moveNext();){var o=t.current;if(128>o)n.append(String.fromCharCode(o));else if(o>191&&224>o){t.moveNext();var r=t.current;n.append(String.fromCharCode((31&o)<<6|63&r))}else{t.moveNext();r=t.current;t.moveNext();var a=t.current;n.append(String.fromCharCode((15&o)<<12|(63&r)<<6|63&a))}}return n.toString()}}catch(e){}window.Utf8EncodeEnumerator=function(e){this._input=e,this._index=-1,this._buffer=[]},window.Utf8EncodeEnumerator.prototype={current:Number.NaN,moveNext:function(){if(this._buffer.length>0)return this.current=this._buffer.shift(),!0;if(this._index>=this._input.length-1)return this.current=Number.NaN,!1;var e=this._input.charCodeAt(++this._index);return 13==e&&10==this._input.charCodeAt(this._index+1)&&(e=10,this._index+=2),e<128?this.current=e:e>127&&e<2048?(this.current=e>>6|192,this._buffer.push(63&e|128)):(this.current=e>>12|224,this._buffer.push(e>>6&63|128),this._buffer.push(63&e|128)),!0}},window.Base64DecodeEnumerator=function(e){this._input=e,this._index=-1,this._buffer=[]},window.Base64DecodeEnumerator.prototype={current:64,codex:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",moveNext:function(){if(this._buffer.length>0)return this.current=this._buffer.shift(),!0;if(this._index>=this._input.length-1)return this.current=64,!1;var e=this.codex.indexOf(this._input.charAt(++this._index)),n=this.codex.indexOf(this._input.charAt(++this._index)),t=this.codex.indexOf(this._input.charAt(++this._index)),o=this.codex.indexOf(this._input.charAt(++this._index)),r=e<<2|n>>4,a=(15&n)<<4|t>>2,i=(3&t)<<6|o;return this.current=r,64!=t&&this._buffer.push(a),64!=o&&this._buffer.push(i),!0}};try{window.MD5=function(e){function n(e,n){return e<<n|e>>>32-n}function t(e,n){var t,o,r,a,i;return r=2147483648&e,a=2147483648&n,i=(1073741823&e)+(1073741823&n),(t=1073741824&e)&(o=1073741824&n)?2147483648^i^r^a:t|o?1073741824&i?3221225472^i^r^a:1073741824^i^r^a:i^r^a}function o(e,o,r,a,i,s,u){return e=t(e,t(t(o&r|~o&a,i),u)),t(n(e,s),o)}function r(e,o,r,a,i,s,u){return e=t(e,t(t(o&a|r&~a,i),u)),t(n(e,s),o)}function a(e,o,r,a,i,s,u){return e=t(e,t(t(o^r^a,i),u)),t(n(e,s),o)}function i(e,o,r,a,i,s,u){return e=t(e,t(t(r^(o|~a),i),u)),t(n(e,s),o)}function s(e){var n,t="",o="";for(n=0;n<=3;n++)t+=(o="0"+(e>>>8*n&255).toString(16)).substr(o.length-2,2);return t}var u,c,l,d,g,p,f,h,m,y=Array();for(y=function(e){for(var n,t=e.length,o=t+8,r=16*((o-o%64)/64+1),a=Array(r-1),i=0,s=0;s<t;)i=s%4*8,a[n=(s-s%4)/4]=a[n]|e.charCodeAt(s)<<i,s++;return i=s%4*8,a[n=(s-s%4)/4]=a[n]|128<<i,a[r-2]=t<<3,a[r-1]=t>>>29,a}(e=function(e){e=e.replace(/\r\n/g,"\n");for(var n="",t=0;t<e.length;t++){var o=e.charCodeAt(t);o<128?n+=String.fromCharCode(o):o>127&&o<2048?(n+=String.fromCharCode(o>>6|192),n+=String.fromCharCode(63&o|128)):(n+=String.fromCharCode(o>>12|224),n+=String.fromCharCode(o>>6&63|128),n+=String.fromCharCode(63&o|128))}return n}(e)),p=1732584193,f=4023233417,h=2562383102,m=271733878,u=0;u<y.length;u+=16)c=p,l=f,d=h,g=m,p=o(p,f,h,m,y[u+0],7,3614090360),m=o(m,p,f,h,y[u+1],12,3905402710),h=o(h,m,p,f,y[u+2],17,606105819),f=o(f,h,m,p,y[u+3],22,3250441966),p=o(p,f,h,m,y[u+4],7,4118548399),m=o(m,p,f,h,y[u+5],12,1200080426),h=o(h,m,p,f,y[u+6],17,2821735955),f=o(f,h,m,p,y[u+7],22,4249261313),p=o(p,f,h,m,y[u+8],7,1770035416),m=o(m,p,f,h,y[u+9],12,2336552879),h=o(h,m,p,f,y[u+10],17,4294925233),f=o(f,h,m,p,y[u+11],22,2304563134),p=o(p,f,h,m,y[u+12],7,1804603682),m=o(m,p,f,h,y[u+13],12,4254626195),h=o(h,m,p,f,y[u+14],17,2792965006),p=r(p,f=o(f,h,m,p,y[u+15],22,1236535329),h,m,y[u+1],5,4129170786),m=r(m,p,f,h,y[u+6],9,3225465664),h=r(h,m,p,f,y[u+11],14,643717713),f=r(f,h,m,p,y[u+0],20,3921069994),p=r(p,f,h,m,y[u+5],5,3593408605),m=r(m,p,f,h,y[u+10],9,38016083),h=r(h,m,p,f,y[u+15],14,3634488961),f=r(f,h,m,p,y[u+4],20,3889429448),p=r(p,f,h,m,y[u+9],5,568446438),m=r(m,p,f,h,y[u+14],9,3275163606),h=r(h,m,p,f,y[u+3],14,4107603335),f=r(f,h,m,p,y[u+8],20,1163531501),p=r(p,f,h,m,y[u+13],5,2850285829),m=r(m,p,f,h,y[u+2],9,4243563512),h=r(h,m,p,f,y[u+7],14,1735328473),p=a(p,f=r(f,h,m,p,y[u+12],20,2368359562),h,m,y[u+5],4,4294588738),m=a(m,p,f,h,y[u+8],11,2272392833),h=a(h,m,p,f,y[u+11],16,1839030562),f=a(f,h,m,p,y[u+14],23,4259657740),p=a(p,f,h,m,y[u+1],4,2763975236),m=a(m,p,f,h,y[u+4],11,1272893353),h=a(h,m,p,f,y[u+7],16,4139469664),f=a(f,h,m,p,y[u+10],23,3200236656),p=a(p,f,h,m,y[u+13],4,681279174),m=a(m,p,f,h,y[u+0],11,3936430074),h=a(h,m,p,f,y[u+3],16,3572445317),f=a(f,h,m,p,y[u+6],23,76029189),p=a(p,f,h,m,y[u+9],4,3654602809),m=a(m,p,f,h,y[u+12],11,3873151461),h=a(h,m,p,f,y[u+15],16,530742520),p=i(p,f=a(f,h,m,p,y[u+2],23,3299628645),h,m,y[u+0],6,4096336452),m=i(m,p,f,h,y[u+7],10,1126891415),h=i(h,m,p,f,y[u+14],15,2878612391),f=i(f,h,m,p,y[u+5],21,4237533241),p=i(p,f,h,m,y[u+12],6,1700485571),m=i(m,p,f,h,y[u+3],10,2399980690),h=i(h,m,p,f,y[u+10],15,4293915773),f=i(f,h,m,p,y[u+1],21,2240044497),p=i(p,f,h,m,y[u+8],6,1873313359),m=i(m,p,f,h,y[u+15],10,4264355552),h=i(h,m,p,f,y[u+6],15,2734768916),f=i(f,h,m,p,y[u+13],21,1309151649),p=i(p,f,h,m,y[u+4],6,4149444226),m=i(m,p,f,h,y[u+11],10,3174756917),h=i(h,m,p,f,y[u+2],15,718787259),f=i(f,h,m,p,y[u+9],21,3951481745),p=t(p,c),f=t(f,l),h=t(h,d),m=t(m,g);return(s(p)+s(f)+s(h)+s(m)).toLowerCase()}}catch(e){}try{window.jsonParse=function(){var e=new RegExp('(?:false|true|null|[\\{\\}\\[\\]]|(?:-?\\b(?:0|[1-9][0-9]*)(?:\\.[0-9]+)?(?:[eE][+-]?[0-9]+)?\\b)|(?:"(?:[^\\0-\\x08\\x0a-\\x1f"\\\\]|\\\\(?:["/\\\\bfnrt]|u[0-9A-Fa-f]{4}))*"))',"g"),n=new RegExp("\\\\(?:([^u])|u(.{4}))","g"),t={'"':'"',"/":"/","\\":"\\",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"};function o(e,n,o){return n?t[n]:String.fromCharCode(parseInt(o,16))}var r=new String("");return Object,Array,function(t){var a,i,s=t.match(e),u=s[0];"{"===u?a={}:"["===u&&(a=[]);for(var c=[a],l=1,d=s.length;l<d;++l){var g;switch((u=s[l]).charCodeAt(0)){default:(g=c[0])[i||g.length]=+u,i=void 0;break;case 34:if(-1!==(u=u.substring(1,u.length-1)).indexOf("\\")&&(u=u.replace(n,o)),g=c[0],!i){if(!(g instanceof Array)){i=u||r;break}i=g.length}g[i]=u,i=void 0;break;case 91:g=c[0],c.unshift(g[i||g.length]=[]),i=void 0;break;case 93:c.shift();break;case 102:(g=c[0])[i||g.length]=!1,i=void 0;break;case 110:(g=c[0])[i||g.length]=null,i=void 0;break;case 116:(g=c[0])[i||g.length]=!0,i=void 0;break;case 123:g=c[0],c.unshift(g[i||g.length]={}),i=void 0;break;case 125:c.shift()}}return c.length,a}}()}catch(e){}window.parseXml=function(e){return(new window.DOMParser).parseFromString(e,"text/xml")},window.azrc={isFunction:function(e){return"[object Function]"===toString.call(e)},isArray:function(e){return"[object Array]"===toString.call(e)},isPlainObject:function(e){if(!e||"[object Object]"!==toString.call(e)||e.nodeType||e.setInterval)return!1;if(e.constructor&&!hasOwnProperty.call(e,"constructor")&&!hasOwnProperty.call(e.constructor.prototype,"isPrototypeOf"))return!1;var n;for(n in e);return void 0===n||hasOwnProperty.call(e,n)},extend:function(){var e,n,t,r,a,i,s=arguments[0]||{},u=1,c=arguments.length,l=!1;for("boolean"==typeof s&&(l=s,s=arguments[1]||{},u=2),"object"===o(s)||window.azrc.isFunction(s)||(s={}),c===u&&(s=this,--u);u<c;u++)if(null!=(e=arguments[u]))for(n in e)t=s[n],s!==(r=e[n])&&(l&&r&&(window.azrc.isPlainObject(r)||(a=window.azrc.isArray(r)))?(a?(a=!1,i=t&&window.azrc.isArray(t)?t:[]):i=t&&window.azrc.isPlainObject(t)?t:{},s[n]=window.azrc.extend(l,i,r)):void 0!==r&&(s[n]=r));return s}},BeFunky.ConvertToBool=function(e){return""!=e&&("1"==e||"true"==e||1==e||"yes"==e)},BeFunky.shareLink=function(e,n,t,o,r){var a="PINTEREST"===e.toUpperCase()?"http://pinterest.com/pin/create/button/?url=".concat(n,"&description=").concat(o,"&media=").concat(t):"TWITTER"===e.toLocaleUpperCase()?"".concat(BeFunky.Params.siteUrl,"tweetSend.php?url=").concat(n,"&imgtitle=").concat(o):"https://www.facebook.com/dialog/share?app_id=120991377944644&display=popup&href=".concat(n);if(r)try{window.openCustomPopup(a)}catch(e){}else{BeFunky.confirm(["open_share_popup",{ok:BeFunky.LanguageManager.getString("ok")}],{onConfirm:function(){window.openCustomPopup(a)},confirmText:"ok"})}},window.__documentReady=function(){window.addEventListener("resize",BeFunky.debounce(function(){if(!1===BeFunky.isUseHTML5){var e=document.getElementById("main");e&&e.setStyles({width:"".concat(setInitFlashWidth(),"px"),height:"".concat(setInitFlashHeight(),"px")});try{var n=document.getElementById(BeFunky.Params.swfId);n.setAttribute("width",setInitFlashWidth()),n.setAttribute("height",setInitFlashHeight())}catch(e){}return void window.calculateAdWidth()}if(BeFunky.html5app_created){if(BFN.FabricManager.iTextEditing&&BeFunky.isAndroid)return;BFN._appRect=null,BFN.BfnService.dispatchEvent(BFN.BfnServiceEvents.CUSTOM_RESIZE_EVENT)}},"raf"))},BeFunky.befunkyPopupDivOpened=!1;var dr=[];function gr(){BeFunky.LoginPanelObj.isLoggedInNextFunction&&BeFunky.LoginPanelObj.isLoggedInNextFunction===openFlash?openFlash():BeFunky.LoginPanelObj.closeNextFunction&&BeFunky.LoginPanelObj.closeNextFunction===openFlash?openFlash():BeFunky.LoginPanelObj.closeNextFunction&&"function"==typeof BeFunky.LoginPanelObj.closeNextFunction&&BeFunky.LoginPanelObj.closeNextFunction(),BeFunky.getModal()||hideModalBackgroundImage(),BeFunky.disposeServise()}BeFunky.befunkyPopupContainerOpen=function(e,n){var t=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=e.replace("#",""),r=document.getElementById(o);if(n||(n={}),dr.includes(o)||dr.push(o),t){var a=BeFunky.getModal(),i=a?a.modalElement.id:void 0;if(dr.includes(i)){BeFunky.preventModalDispose=!0,BeFunky.closeModal(i),BeFunky.preventModalDispose=!1;var s=document.getElementById("modal_root");s.addClass("modal-root--disable-transitions"),requestAnimationFrame(function(){s.removeClass("modal-root--disable-transitions")})}}BeFunky.befunkyPopupDivOpened=!0;var u=n.addCaptcha&&r.querySelector(".captcha");BeFunky.openModal(r,{onOpen:function(){!function(){if(u){var e=r.querySelector("[type=submit]");e.disabled=!0,BeFunky.renderOrResetCaptcha(u,function(){e.disabled=!1})}}()},onClose:function(){u&&u.parentElement&&u.parentElement.replaceChild(document.createElement("div").addClass("captcha"),u),function(e){var n=e.querySelector(".form-errors");n&&(n.innerHTML="");e.querySelectorAll(".form-field__input--invalid").removeClass("form-field__input--invalid")}(r),BeFunky.preventModalDispose?BeFunky.befunkyPopupDivOpened=!1:gr(),"function"==typeof r.onModalClose&&r.onModalClose(),n.onClose&&n.onClose()},addSiteClass:!0,addCloseButton:"boolean"!=typeof n.addCloseButton||n.addCloseButton,closeOnClickOutside:"boolean"!=typeof n.closeOnClickOutside||n.closeOnClickOutside,size:n.size||"large-nebula",isCritical:!!n.isCritical,destroyOnClose:!!n.destroyOnClose})},BeFunky.befunkyPopupContainerClose=function(){if(BeFunky.befunkyPopupDivOpened){BeFunky.registerComeFromUpgrade=!1;var e=BeFunky.getModal(),n=e?e.modalElement.id:void 0;n&&BeFunky.closeModal(n);var t=document.getElementById("modal_root");t.addClass("modal-root--disable-transitions"),requestAnimationFrame(function(){t.removeClass("modal-root--disable-transitions"),gr()})}return!1},BeFunky.disposeServise=function(){BeFunky.befunkyPopupDivOpened=!1,BeFunky.LoginPanelObj.panelType="SIGNIN",BeFunky.LoginPanelObj.isLoggedInNextFunction=!1,BeFunky.LoginPanelObj.closeNextFunction=!1,BeFunky.registerComeFromUpgrade=!1};var pr=function(){function e(){r(this,e),window.onUserStatusChange(this.handleUserDataChange.bind(this)),this.listenForUserChangesInOtherTabs(),this.setupPolling(),this.closeWarningDialog=function(){}}return i(e,[{key:"listenForUserChangesInOtherTabs",value:function(){var e=this;window.addEventListener("storage",function(n){if("latest_user_email"===n.key){var t=e.detectUserChangeInDifferentTab()||{},o=t.error,r=t.emailInBrowser,a=t.debugData;o?e.decodeUserToken().then(function(n){var t=n?Object.assign({},n,{email:e.anonymizeEmail(n.email)}):"(no_user)";return"not_logged_in"===o&&n?BeFunky.throwError("LocalStorage does not match Fastly",t,a):r&&r!==n.email?BeFunky.throwError("LocalStorage does not match Fastly",t,a):e.handleUserSessionError({error:o,userData:n})}).catch(function(e){"request_failed"===e?BeFunky.logError("/check-user/ polling failed: ".concat(e)):BeFunky.reportWarning("/check-user/ polling failed: ".concat(e),e)}):e.closeWarningDialog()}})}},{key:"setupPolling",value:function(){this.pollingTimeout=null,this.pollingInterval=36e5,this.resetPolling()}},{key:"resetPolling",value:function(){clearTimeout(this.pollingTimeout),this.pollingTimeout=setTimeout(this.checkUserToken.bind(this),this.pollingInterval)}},{key:"checkUserToken",value:function(e,n){var t=this;clearTimeout(this.pollingTimeout),this.decodeUserToken().then(function(o){var r;if(o&&!BeFunky.isLoggedIn()?r="already_logged_in":!o&&BeFunky.isLoggedIn()?r="not_logged_in":o.email&&window.latestUserData.email&&o.email!==window.latestUserData.email&&(r="wrong_user"),e&&e!==r){if(!o&&"not_logged_in"===e&&!BeFunky.isLoggedIn())return;var a=o?Object.assign({},o,{email:t.anonymizeEmail(o.email)}):"(no_user)";BeFunky.throwError('User session errors do not match. Fastly = "'.concat(r,'", ').concat(n,' = "').concat(e,'"'),a)}else r&&t.handleUserSessionError({error:r,userData:o})}).catch(function(e){"request_failed"===e?BeFunky.logError("/check-user/ polling failed: ".concat(e)):BeFunky.reportWarning("/check-user/ polling failed: ".concat(e),e)}).then(function(){t.resetPolling()})}},{key:"decodeUserToken",value:function(){return new Promise(function(e,n){var t="".concat(BeFunky.Params.siteUrl,"check-user/");BeFunky.request(t,{method:"POST"},function(t){var o=t.error,r=t.response;return"not_logged_in"===o?e(!1):r&&r.email?e(r):void n(o||"invalid_response")})})}},{key:"detectUserChangeInDifferentTab",value:function(){var e=window.latestUserData.email,n=BeFunky.getLocal("latest_user_email"),t=e?"Logged in as ".concat(this.anonymizeEmail(e)):"Logged out",o=n?"Logged in as ".concat(this.anonymizeEmail(n)):null===n?"Logged out":"Unknown",r="[In this tab: ".concat(t,"] vs [In browser: ").concat(o,"]");return!e&&n?{error:"already_logged_in",emailInThisTab:e,emailInBrowser:n,debugData:r}:e&&null===n?{error:"not_logged_in",emailInThisTab:e,emailInBrowser:n,debugData:r}:e&&n&&e!==n?{error:"wrong_user",emailInThisTab:e,emailInBrowser:n,debugData:r}:void 0}},{key:"anonymizeEmail",value:function(e){return"".concat(e.slice(0,2),"...@").concat(e.slice(e.indexOf("@")+1,e.indexOf("@")+3),"...")}},{key:"handleUserSessionError",value:function(e){var n=e.error,t=e.userData;this.closeWarningDialog();var o=window.latestUserData.email;if("already_logged_in"!==n)return"not_logged_in"===n?(window.updateUserStatus({error:"not_logged_in"}),this.handleClientSideLogout(),void(this.closeWarningDialog=BeFunky.acknowledge(["user_not_logged_in_refresh",{email:o}]))):void("wrong_user"!==n?BeFunky.throwError("Unhandled user session error",n):this.closeWarningDialog=BeFunky.acknowledge(["user_not_logged_in_refresh",{email:o}]));this.closeWarningDialog=BeFunky.confirm("user_already_logged_in",{confirmText:["continue_as_user",{username:t.user_name||t.email}],onConfirm:function(){BeFunky.requestAPI("auth/status",{},{showLoadScreen:!0}).then(function(e){var n=e.data;n.email?window.updateUserStatus(n):BeFunky.throwError("/status/ missing email",n)}).catch(function(e){BeFunky.reportWarning("/status/ failed when handling session error: ".concat(e))}).then(function(){BeFunky.hideLoadScreen()})},onCancel:function(){}})}},{key:"handleClientSideLogout",value:function(){if(BeFunky.User=BeFunky.getDefaultUser(),delete BeFunky.Params.swfFlashVars.pl,delete BeFunky.Params.swfFlashVars.user_name,delete BeFunky.Params.swfFlashVars.email,window.BFN&&BFN.BfnService&&BFN.BfnService.userLoggedIn)try{BFN.BfnService.getUserData()}catch(e){BeFunky.throwError("getUserData error after client-side logout",e)}}},{key:"handleUserDataChange",value:function(e){if(e.btknid){var n=e.user_name,t=e.email,o=e.pl,r=e.btknid,a=e.language,i=e.register_date,s=e.register_from,u=e.login_date,c=e.login_count,l=e.newUser,d=e.isMailVerified,g=e.plan_type,p=e.subscr_date,f=e.subscr_count,h=e.subscr_amount,m=e.subscr_first_date,y=e.subscr_ltv,v=e.subscr_usr,_=e.subscr_tusr,k=e.subscription_status,w=e.trial_source,b=e.payment_type,F=e.can_change_user_name,B=e.is_subscribe_newsletter,E=e.is_beta_user,L=void 0===E?0:E,I=e.options,S=e.luk;if(BeFunky.Params.btknid=r,BeFunky.Params.isBetaUser=1===L,BeFunky.User.email=t,BeFunky.User.username=n,BeFunky.User.language=a,BeFunky.User.register_date=i,BeFunky.User.register_from=s,BeFunky.User.login_date=u,BeFunky.User.login_count=parseInt(c),BeFunky.User.isNewUser=BeFunky.ConvertToBool(l),BeFunky.User.options=I,BeFunky.User.subscription_status=k,BeFunky.User.trial_source=w,BeFunky.User.payment_type=b,BeFunky.User.can_change_user_name=BeFunky.ConvertToBool(F),BeFunky.User.is_subscribe_newsletter=BeFunky.ConvertToBool(B),BeFunky.User.isMailVerified="1"===d,BeFunky.Params.isMailVerified="1"===d,BeFunky.User.FlashVarsObject.user_name=n,BeFunky.User.FlashVarsObject.email=t,BeFunky.User.FlashVarsObject.pl=o,BeFunky.User.FlashVarsObject.plan_type=g,BeFunky.User.FlashVarsObject.subscr_date=p,BeFunky.User.FlashVarsObject.subscr_count=f,BeFunky.User.FlashVarsObject.subscr_amount=h,BeFunky.User.FlashVarsObject.subscr_first_date=m,BeFunky.User.FlashVarsObject.subscr_ltv=y,BeFunky.User.FlashVarsObject.subscr_usr=v,BeFunky.User.FlashVarsObject.subscr_tusr=_,parseInt(o)<1&&(BeFunky.Params.swfFlashVars.pl=o,BeFunky.Params.swfFlashVars.user_name=n,BeFunky.Params.swfFlashVars.email=t),BeFunky.Params.swfFlashVars.ppicsrc="".concat(BeFunky.Params.swfUrl,"default-avatar.jpg"),BeFunky.User.FlashVarsObject.ppicsrc="".concat(BeFunky.Params.swfUrl,"default-avatar.jpg"),Kt()&&f&&(Qt(!1,!1),BeFunky.removeLocal("user_trial")),!1===BeFunky.isUseHTML5)try{document.getElementById(BeFunky.Params.swfId).userValueObj(BeFunky.User.FlashVarsObject)}catch(e){BeFunky.ISNOT_FLASH_LOGGEDIN=!0}else if(window.BFN&&BFN.BfnService)try{BFN.BfnService.getUserData()}catch(e){BeFunky.throwError("getUserData error",e)}window.Sentry&&Sentry.configureScope(function(e){e.setTag("plus",BeFunky.isPlus()),S&&e.setUser({id:S})}),setTimeout(function(){["free","plus"].includes(k)&&BeFunky.SettingsService.getUserSettings(function(e){"trialing"===e.settings.trialing&&BeFunky.SettingsService.updateSetting("trialing",k).then(function(){var e=parseInt(g)>0?"YEARLY":"MONTHLY",n="chromeos_perk_two_trial"===w?"TRIAL_CONVERSION":w.toUpperCase();"free"===k?bf_eventTrack(n,e,"TRIAL CANCELLED"):"plus"===k&&(bf_eventTrack(n,e,"TRIAL SUCCEEDED"),bf_eventTrack("CONVERSION",e,"CREDITCARD"))})})})}}}]),e}();function fr(){var e=_(["\n    <div>\n        <p>","</p>\n        <p>","</p>\n    </div>"]);return fr=function(){return e},e}BeFunky.UserManager=new pr,BeFunky.captchaWidget=null,BeFunky.renderOrResetCaptcha=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};if(!e)return BeFunky.throwError("Unable to find captcha container"),n();!function(e){if(o())return e();var n=["hl=".concat(BeFunky.LanguageManager.language[window.isFlashOpenned?"app":"site"]),"render=explicit"].join("&"),t="//www.google.com/recaptcha/api.js?".concat(n);function o(){return window.grecaptcha&&"function"==typeof window.grecaptcha.render}window.createJavascriptElements(t),BeFunky.waitUntil({condition:o,interval:300,maxAttempts:1e3,onSuccess:e,onTimeout:function(){BeFunky.throwError("Unable to load Google ReCAPTCHA",{grecaptcha:window.grecaptcha})}})}(function(){if(e.firstElementChild)return window.grecaptcha.reset(),n();var t=BeFunky.Params.IS_LC?"6LePbqoUAAAAAITuugtKJnS15GkfdP5MZGInsrk8":"6LcXOpkUAAAAAOKNQzyDv-gS8Nu6cTgwW6m3sXQu";return BeFunky.captchaWidget=window.grecaptcha.render(e,{sitekey:t,hl:BeFunky.LanguageManager.language[window.isFlashOpenned?"app":"site"],size:"invisible",callback:function(e){""!==e&&(BeFunky.invisibleCaptchaHandler(e),console.log("User successfully completed captcha"))}}),n()})},BeFunky.getCaptchaResponse=function(){try{return window.grecaptcha.getResponse(BeFunky.captchaWidget)}catch(e){}return""},BeFunky.invisibleCaptchaHandler=function(){"function"==typeof BeFunky.executeCaptchaCallback&&(BeFunky.executeCaptchaCallback(),BeFunky.executeCaptchaCallback=null)},BeFunky.executeCaptchaCallback=null,BeFunky.executeCaptcha=function(e){var n;(BeFunky.executeCaptchaCallback=e,window.grecaptcha.execute(BeFunky.captchaWidget),window.innerHeight<650)&&BeFunky.waitUntil({condition:function(){return!!(n=n||w(document.querySelectorAll('iframe[title^="recaptcha"]')).find(function(e){try{return"hidden"!==e.parentElement.parentElement.style.visibility}catch(e){}return!1}))},onTimeout:function(){},onSuccess:function(){var e=n.parentElement.getBoundingClientRect().top;n.parentElement.setStyles({maxHeight:"calc(100vh - ".concat(e,"px)"),overflowY:"auto"})},interval:300,maxAttempts:15})},window.flashFreeTop=100,window.isflashFreeRight=!0,window.flashFreeRight=170,window.adRefreshCounter=0,window.googletag=window.googletag||{},googletag.cmd=googletag.cmd||[],window.ad_slot1=null,window.ad_slot2=null,window.ad_slot3=null,window.is_ads_added=!1,window.is_ads_initted=!1,window.slot_rendered_count=0,window.isadblocked=!1,window.checkAdblockIntervarCount=0,window.initAds=function(){document.getElementById("0x00001001").innerHTML='\n        <div id="div-gpt-ad-1466445154244-0" style="height: 90px; z-index:1010; display: block;"  class="pub_300x250 pub_300x250m pub_728x90 text-ad textAd text_ad text_ads text-ads text-ad-links adsbox doubleclick ad-placement carbon-ads"></div>\n        <div id="bfn-plus-dsp-bottom" style="height: 90px; z-index:1011; display:none;"><a href="'.concat(BeFunky.Params.siteUrl,"pricing/\" onclick=\"try{if(document.getElementById(BeFunky.Params.swfId) != null && typeof document.getElementById(BeFunky.Params.swfId).upgradePanelListener != 'undefined'){document.getElementById(BeFunky.Params.swfId).upgradePanelListener('BOTTOM_BNR');} else {BeFunky.openUpgradePanel('BOTTOM_BNR');}} catch(err){} return false;\"><img data-src=\"").concat(BeFunky.Params.globalImagesPath,'befunky-plus-dsp-bottom-final-v1.jpg" border="0" class="notlazy" style="display: block !important;"/></a></div>\n    '),document.getElementById("rightReklamIc").innerHTML='\n        <div id="div-gpt-ad-1466462088410-0" style="width: 160px; height: 600px; z-index:1010; display: block;" class="pub_300x250 pub_300x250m pub_728x90 text-ad textAd text_ad text_ads text-ads text-ad-links adsbox doubleclick ad-placement carbon-ads"></div>\n        <div id="bfn-plus-dsp-right" style="width: 160px; height: 600px; z-index:1011; display:none;"><a href="'.concat(BeFunky.Params.siteUrl,"pricing/\" onclick=\"try{if(document.getElementById(BeFunky.Params.swfId) != null && typeof document.getElementById(BeFunky.Params.swfId).upgradePanelListener != 'undefined'){document.getElementById(BeFunky.Params.swfId).upgradePanelListener('RIGHT_BNR');} else {BeFunky.openUpgradePanel('RIGHT_BNR');}} catch(err){} return false;\"><img data-src=\"").concat(BeFunky.Params.globalImagesPath,'befunky-plus-dsp-right-final-v1.jpg" border="0" class="notlazy" style="display: block !important;"/></a></div>\n    '),"none"===document.querySelector(".doubleclick").style.display?(slot_rendered_count=0,checkAdblockIntervarCount=5,checkAdBlocker(!1,!0)):(!function(){var e=document.createElement("script");e.async=!0,e.type="text/javascript";var n="https:"==document.location.protocol;e.src="".concat(n?"https:":"http:","//www.googletagservices.com/tag/js/gpt.js");var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}(),googletag.cmd.push(function(){googletag.pubads().enableSingleRequest(),googletag.enableServices(),is_ads_initted=!0,googletag.pubads().addEventListener("slotRenderEnded",function(e){slot_rendered_count+=1})}))},window.addAds=function(){0!=is_ads_initted?(null!=ad_slot1&&0!=is_ads_initted&&googletag.destroySlots([ad_slot1]),ad_slot1=null,is_ads_added=!1,googletag.cmd.push(function(){ad_slot1=googletag.defineSlot("/291414075/BeFunky_AllPages_Above_The_Fold_970_90",[728,90],"div-gpt-ad-1466445154244-0").addService(googletag.pubads())}),setTimeout(function(){null!=ad_slot1&&0!=is_ads_initted&&0==is_ads_added&&(googletag.cmd.push(function(){googletag.display("div-gpt-ad-1466445154244-0")}),is_ads_added=!0,addRightAds(isFlashCreationComplated))},333)):0==isadblocked?setTimeout("addAds()",100):setTimeout("checkAdBlocker(true)",555)},window.addRightAds=function(e){if(window.flashFreeRight>0&&1==window.isflashFreeRight&&BeFunky.Params.isShowAds>0&&0==("1"==BeFunky.User.FlashVarsObject.pl||BeFunky.User.FlashVarsObject.pl>0)){try{document.getElementById("0x00001002").style.cssText+=";display: block !important;"}catch(e){}1==is_ads_added&&0!=is_ads_initted?(null!=ad_slot2&&googletag.destroySlots([ad_slot2]),ad_slot2=null,ad_slot3=null,googletag.cmd.push(function(){ad_slot2=googletag.defineSlot("/291414075/wide_skyscrapper",[160,600],"div-gpt-ad-1466462088410-0").addService(googletag.pubads())}),setTimeout(function(){try{var e=setInitFlashHeight()/2-300;if(e<5&&(e=5),document.getElementById("0x00001002").setStyles({"padding-top":"".concat(e,"px")}),170==window.flashFreeRight&&null!=ad_slot2)try{googletag.cmd.push(function(){googletag.display("div-gpt-ad-1466462088410-0")})}catch(e){}if(0==slot_rendered_count)setTimeout("checkAdBlocker()",1e3);else try{document.getElementById("bfn-plus-dsp-bottom").style.cssText+=";display: none !important;",document.getElementById("bfn-plus-dsp-right").style.cssText+=";display: none !important;"}catch(e){}}catch(e){}},555)):0==slot_rendered_count&&setTimeout("checkAdBlocker()",1e3)}},window.checkAdBlocker=function(e,n){try{document.getElementById("bfn-plus-dsp-bottom").style.cssText+=";display: none !important;",document.getElementById("bfn-plus-dsp-right").style.cssText+=";display: none !important;"}catch(e){}if(0==slot_rendered_count)if(checkAdblockIntervarCount>4){if(isadblocked=!0,e||window.bf_eventTrack("EXTERNAL","AD_BLOCK","OPENED"),0==(n|=!1)&&BeFunky.Params.isShowAds>0&&0==("1"==BeFunky.User.FlashVarsObject.pl||BeFunky.User.FlashVarsObject.pl>0)){try{document.getElementById("bfn-plus-dsp-bottom").style.cssText+=";display: block !important;",document.querySelector("#bfn-plus-dsp-bottom img").dataset.src!=document.querySelector("#bfn-plus-dsp-bottom img").src&&(document.querySelector("#bfn-plus-dsp-bottom img").src=document.querySelector("#bfn-plus-dsp-bottom img").dataset.src)}catch(e){}if(window.flashFreeRight>0&&1==window.isflashFreeRight){document.getElementById("0x00001002").style.cssText+=";display: block !important;";var t=setInitFlashHeight()/2-300;t<5&&(t=5),document.getElementById("0x00001002").setStyles({"padding-top":"".concat(t,"px")});try{document.getElementById("bfn-plus-dsp-right").style.cssText+=";display: block !important;",document.querySelector("#bfn-plus-dsp-right img").dataset.src!=document.querySelector("#bfn-plus-dsp-right img").src&&(document.querySelector("#bfn-plus-dsp-right img").src=document.querySelector("#bfn-plus-dsp-right img").dataset.src)}catch(e){}}}}else checkAdblockIntervarCount+=1,setTimeout("checkAdBlocker()",1e3)},window.removeAds=function(e){if(1!=e){try{document.getElementById("reklamDiv").style.cssText+=";display: none !important;",document.getElementById("0x00001002").style.cssText+=";display: none !important;"}catch(e){}document.getElementById("reklamDiv").innerHTML="",document.getElementById("0x00001002").innerHTML=""}flasRightBarAdDisplay(!0,e)},window.refreshAds=function(e){setTimeout(function(){try{1==is_ads_added&&null!=ad_slot1&&0!=is_ads_initted&&BeFunky.Params.isShowAds>0&&0==("1"==BeFunky.User.FlashVarsObject.pl||BeFunky.User.FlashVarsObject.pl>0)&&"none"!=document.getElementById("reklamDiv").style.display&&(googletag.pubads().refresh([ad_slot1]),null!=ad_slot2&&170==window.flashFreeRight&&"none"!=document.getElementById("reklamDiv").style.display?googletag.pubads().refresh([ad_slot2]):null!=ad_slot3&&130==flashFreeRight&&googletag.pubads().refresh([ad_slot3]))}catch(e){}},2500)},window.flasRightBarAdDisplay=function(e,n){var t=!1;if(null!=e&&1==e&&(t=!0),1==t)try{if(1!=n){document.getElementById("reklamDiv").removeClass("top-reklam-with-app").addClass("top-reklam-normal"),document.getElementById("relamIc").removeClass("top-reklam-with-app").addClass("top-reklam-normal");try{document.getElementById("reklamDiv").style.cssText+=";display: none !important;"}catch(e){}null!=ad_slot1&&0!=is_ads_initted&&(googletag.destroySlots([ad_slot1]),ad_slot1=null)}try{document.getElementById("0x00001002").style.cssText+=";display: none !important;"}catch(e){}null!=ad_slot2&&0!=is_ads_initted&&(googletag.destroySlots([ad_slot2]),ad_slot2=null)}catch(e){}else{try{document.getElementById("reklamDiv").removeClass("top-reklam-normal").addClass("top-reklam-with-app"),document.getElementById("relamIc").removeClass("top-reklam-normal").addClass("top-reklam-with-app");try{document.getElementById("reklamDiv").style.cssText+=";display: block !important;"}catch(e){}if(document.getElementById("0x00001002").innerHTML.length>0&&document.getElementById("div-gpt-ad-1466462088410-0").innerHTML.length>0&&window.flashFreeRight>0)try{document.getElementById("0x00001002").style.cssText+=";display: block !important;"}catch(e){}}catch(e){}try{BeFunky.Params.isShowAds>0&&addAds()}catch(e){}}},BeFunky.disableAdsForPlusUsers=function(){BeFunky.isPlus()&&(window.flashFreeTop=0,window.flashFreeRight=0,window.isflashFreeRight=!1),BeFunky.Params.isShowAds=BeFunky.isPlus()?0:1,!0===window.webgl_is_supported&&(document.querySelectorAll(".doubleclick").setStyles({display:"none"}),BeFunky.Params.isShowAds=0,window.flashFreeTop=0,window.flashFreeRight=0,window.isflashFreeRight=!1,window.removeAds())},BeFunky.closeAccount=function(e){var n={closeKey:e};BeFunky.requestAPI("auth/close-account",n,{showLoadScreen:!0}).then(function(e){if("success"!==e.data)throw"invalid_response";BeFunky.showLoadScreen({message:"closing_account",progress:0}),setTimeout(BeFunky.updateAccountCloseStatus,2555)}).catch(function(e){BeFunky.throwError("Unable to close account",JSON.stringify({error:e})),yr()})};var hr=!1,mr=0;function yr(){var e=BeFunky.lit,n=e.elem,t=e.lang;BeFunky.acknowledge(n(fr(),t("error_close_account","site"),t(["error_please_refresh",{contact_support:BeFunky.toLinkHTML("SUPPORT")}],"site")))}function vr(){var e=_(['\n            <h3 class="h5">','</h3>\n            <p class="form-modal__confirmation">',"</p>\n        "]);return vr=function(){return e},e}function _r(){var e=_(['\n                    <div class="form-field">\n                        <label class="form-field__label" for=',">","</label>\n                        ",'\n                        <p class="form-field__error">',"</p>\n                    </div>\n                "]);return _r=function(){return e},e}function kr(){var e=_(['\n                    <textarea\n                        class="','"\n                        id=',"\n                        name=","\n                        type=",'\n                        required\n                        rows="8"\n                        cols="50"\n                    ></textarea>\n                ']);return kr=function(){return e},e}function wr(){var e=_(['\n                    <textarea\n                        class="','"\n                        id=',"\n                        name=","\n                        type=",'\n                        required\n                        rows="8"\n                        cols="50"\n                        @change=',"\n                        @keyup=","\n                        @blur=","\n                    ></textarea>\n                "]);return wr=function(){return e},e}function br(){var e=_(['\n                    <input\n                        class="','"\n                        id=',"\n                        name=","\n                        type=","\n                        maxLength=","\n                        required\n                    >\n                "]);return br=function(){return e},e}function Fr(){var e=_(['\n                    <input\n                        class="','"\n                        value=',"\n                        id=","\n                        name=","\n                        type=","\n                        maxLength=","\n                        required\n                        @change=","\n                        @keyup=","\n                        @blur=","\n                    >\n                "]);return Fr=function(){return e},e}function Br(){var e=_(["<div>","</div>"]);return Br=function(){return e},e}function Er(){var e=_(['\n                <div class="form-errors">\n                    <div class="form-errors__container">\n                    ',"\n                    </div>\n                    <button @click=",' type="button" class="button button--circle button--outline button--white button--icon button--tiny form-errors__close-button">\n                        ',"\n                    </button>\n                </div>\n            "]);return Er=function(){return e},e}function Lr(){var e=_(['\n                <p class="form-modal__notification">',"</p>\n            "]);return Lr=function(){return e},e}function Ir(){var e=_(['\n        <h3 class="h5">',"</h3>\n        <form class="," @submit=",">\n            ","\n            ","\n            ",'\n            <button class="button button--dark-blue button--lg" type="submit">',"</button>\n        </form>\n        "]);return Ir=function(){return e},e}function Sr(){var e=_([""]);return Sr=function(){return e},e}BeFunky.updateAccountCloseStatus=function(){hr||(hr=!0,BeFunky.requestAPI("auth/close-account-status",{}).then(function(e){hr=!1;var n=parseInt(e.data.stepPercentageComplete)||0;if(n?mr=n:mr++,BeFunky.showLoadScreen({message:"closing_account",progress:mr}),1===parseInt(e.data.isFinished))return BeFunky.hideLoadScreen(),void BeFunky.acknowledge("account_deleted",{onAcknowledge:function(){BeFunky.signOut()},imageUrl:"".concat(BeFunky.Params.globalImagesPath,"site/illustrations/shredder.svg")});setTimeout(BeFunky.updateAccountCloseStatus,100)}).catch(function(e){hr=!1,BeFunky.hideLoadScreen(),BeFunky.throwError("Unable to get account close status",JSON.stringify({error:e})),yr()}))},window.get_browser=function(){var e,n=navigator.userAgent,t=n.match(/(opera|chrome|safari|firefox|msie|edge|trident(?=\/))\/?\s*(\d+)/i)||[];if(/trident/i.test(t[1]))return{name:"IE",version:(e=/\brv[ :]+(\d+)/g.exec(n)||[])[1]||""};if("Chrome"===t[1]){if(null!=(e=n.match(/\bOPR\/(\d+)/)))return{name:"Opera",version:e[1]};if(null!=(e=n.match(/Edge?\/(\d+)/)))return{name:"Edge",version:e[1]}}return t=t[2]?[t[1],t[2]]:[navigator.appName,navigator.appVersion,"-?"],null!=(e=n.match(/version\/(\d+)/i))&&t.splice(1,1,e[1]),{name:t[0],version:t[1]}},window.getSystemInformation=function(e){var n="".concat(BeFunky.Params.globalAssetsPath,"js/ua-parser-0.7.22.min.js");return BeFunky.loadScript(n,function(){return Boolean(window.UAParser)}).then(function(){return(new UAParser).getResult()}).then(function(n){if(delete n.ua,delete n.cpu,n.wbglts=window.webglTextureSize||-1,n.wbglcts=window.webglCombinedTextureUnits||-1,n.wbglumr=window.webglUnmaskedRenderer||-1,n.screen=window.screen?"".concat(screen.width," x ").concat(screen.height):"",n.viewport="".concat(window.innerWidth," x ").concat(window.innerHeight),n.appType=BeFunky.isUseHTML5?"HTML5":"FLASH",n.performance_issue=window.webGLPerformanceIssue||"Not checked",e){return Object.entries(n).map(function(e){var n=k(e,2),t=n[0],o=n[1];return"--".concat(t.toUpperCase(),": ").concat(function(e){return JSON.stringify(e).replace(/"([:,])"/g,"$1 ").replace(/"/g,"")}(o))}).join(", ")}return n})};var Pr=BeFunky.lit,Cr=Pr.html,xr=Pr.setupState,Tr=Pr.render,Ar=Pr.lang,Rr=Pr.icon;function Mr(e,n){var t=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).formClass,o=void 0===t?"form-modal__form":t,r={title:"test",notification:"",button:"submit",context:"site",confirmation:"",fields:[{name:"test",label:"label",maxLength:100,errorMessage:"error_message",isValid:!0,type:"text",sanitize:function(e){return e},validate:function(){return!0}}],onSubmit:console.log,submissionErrors:[]};n=Object.assign(r,n);var a=!1,i=BeFunky.debounce(function(){Tr(u.confirmation?Cr(vr(),Ar(u.title,u.context),Ar(u.confirmation,u.context)):Cr(Ir(),Ar(u.title,u.context),o,g,u.notification?Cr(Lr(),Ar(u.notification,u.context)):"",u.submissionErrors.length?Cr(Er(),u.submissionErrors.map(function(e){return Cr(Br(),Ar(e,u.context))}),d,Rr("global-cancel-icon","icon icon-size-tiny")):"",u.fields.map(function(e){var n,t,o=e.name,r=e.label,a=e.type,i=void 0===a?"text":a,s=e.errorMessage,c=void 0===s?"":s,l=e.maxLength,d=e.isValid,g=e.sanitize,f=e.fieldType,h=void 0===f?"input":f,m=e.initialValue,y=void 0===m?"":m;return"function"==typeof g&&(n=BeFunky.debounce(function(e){e.target.value=g(e.target.value)},100)),"input"===h&&(t=n?Cr(Fr(),"form-field__input ".concat(!1===d?"form-field__input--invalid":""),y,p(o),o,i,l,n,n,n):Cr(br(),"form-field__input ".concat(!1===d?"form-field__input--invalid":""),p(o),o,i,l)),"textarea"===h&&(t=n?Cr(wr(),"form-field__textarea ".concat(!1===d?"form-field__textarea--invalid":""),p(o),o,i,n,n,n):Cr(kr(),"form-field__textarea ".concat(!1===d?"form-field__textarea--invalid":""),p(o),o,i)),Cr(_r(),p(o),Ar(r,u.context),t,Ar(c,u.context))}),Ar(u.button,u.context)),e),a||(a=!0,function(e){for(var n=e.querySelectorAll("input"),t=0;t<n.length;t++)if(n[t].offsetParent){n[t].focus();break}}(e))},"raf"),s=k(xr(n,i),2),u=s[0],c=s[1];BeFunky.LanguageManager.addLanguageUpdateListener(i);var l=Math.floor(1e6*Math.random());return{teardown:function(){return Tr(Cr(Sr()),e)},setFormState:c};function d(){c({submissionErrors:[]})}function g(e){e.preventDefault();var n=u.fields.map(function(e){return e.name}).reduce(function(e,n){return e[n]=document.getElementById(p(n)).value,e},{}),t=u.fields.map(function(e){var t="function"!=typeof e.validate||e.validate(n[e.name],n);return Object.assign({},e,{isValid:t})});c({fields:t}),t.every(function(e){return e.isValid})&&u.onSubmit(n)}function p(e){return"input_".concat(l,"_").concat(e.replace(/^[^a-z]+|[^\w:.-]+/gi,""))}}function Ur(){var e=_(["\n    ",'\n    <p style="margin-bottom: 0.5rem">',"</p>\n    <button @click=",' class="button button--secondary">',"</button>"]);return Ur=function(){return e},e}function Dr(){var e=_(['<p style="margin-bottom: 0.5rem">',"</p>"]);return Dr=function(){return e},e}function Or(){var e=_(["\n        <p>","</p>\n        ","\n        ","\n        <button @click=",' class="button button--secondary">',"</button>\n        "]);return Or=function(){return e},e}function jr(){var e=_(["<li>","</li>"]);return jr=function(){return e},e}function Nr(){var e=_(['\n                <p style="margin-bottom: 0.5rem">',"</p>\n                <ul>\n                    <li>","</li>\n                    <li>","</li>\n                    ","\n                </ul>\n            "]);return Nr=function(){return e},e}function Hr(e){try{var n=document.createElement("canvas"),t={failIfMajorPerformanceCaveat:e,alpha:!0,antialias:!0,premultipliedAlpha:!0,preserveDrawingBuffer:!0,stencil:!0};return n.getContext("webgl",t)||n.getContext("experimental-webgl",t)}catch(e){BeFunky.throwError("canvas issue",e)}return null}BeFunky.webGLDetectionComplete=!1,window.webgl_is_supported=!1,window.graphic_black_list=[],window.failed_webgl_tests=[],window.webGLSupportControl=function(){BeFunky.webGLDetectionComplete=!0,BeFunky.Params.canUseWebapp&&window.setWebGLIsSupported(),BeFunky.isAndroid&&!window.webgl_is_supported&&(BeFunky.logError("Android tablet did not pass WebGL support test"),BeFunky.Params.canUseWebapp=!1),/(Windows 7|Windows NT 6.1)/.test(navigator.userAgent||"")||window.webglTextureSize<=4096||!BeFunky.isRetina()?window.bfn_resolution=1:window.bfn_resolution=2},window.setWebGLIsSupported=function(){var e=BeFunky.runWebGLTests(),n=e.results,t=e.canvasContext,o=n.filter(function(e){return!e.hasPassed}).map(function(e){return e.name});if(window.failed_webgl_tests=o,requestIdleCallback(function(){return function(e){if(BeFunky.testingFlags.includes("disable_webgl_performance_check"))return;if(e.includes("no_webgl_canvas"))return;var n,t=!e.includes("no_high_perf_canvas"),o=window.webglUnmaskedRenderer||"(unknown)";try{n=JSON.parse(BeFunky.getLocal("last_renderer"))}catch(e){}if(BeFunky.setLocal("last_renderer",JSON.stringify({isHighPerformance:t,renderer:o})),n&&n.isHighPerformance!==t){var r=t?"WEBGL_PERF_FIXED":"WEBGL_PERF_BROKEN",a=o===n.renderer?"SAME: ".concat(o):"".concat(n.renderer,"  ").concat(o);bf_eventTrack("EXTERNAL",r,a),t?BeFunky.reportWarning("WebGL performance was fixed",a):BeFunky.logWarning("WebGL performance got worse:",a)}}(o)}),window.webgl_is_supported=function(e){if(!e.length)return setCookie("gl_sprt","1",365),!0;if(1===e.length&&"no_high_perf_canvas"===e[0])return BeFunky.logWarning("Allowing user to use app w/ low perf canvas"),!0;if(n=getCookie("gl_sprt"),t=BeFunky.getLocal("__IndexedDB_version"),Boolean(BeFunky.Params.canUseWebapp&&("1"===n||t))&&!e.includes("no_webgl_canvas"))return BeFunky.reportWarning("Enabling WebGL even though test failed: ".concat(e[0]),{failingTests:e}),!0;var n,t;return setCookie("gl_sprt","0",365),!1}(o),window.webgl_is_supported){window.FixedPixiPaddingSize=8;window.BfnmaxImageSize=4096-window.FixedPixiPaddingSize,window.webglCombinedTextureUnits=t.getParameter(t.MAX_COMBINED_TEXTURE_IMAGE_UNITS);var r=window.webglTextureSize>window.BfnmaxImageSize&&window.webglCombinedTextureUnits>79?8192:Math.min(4096,window.webglTextureSize)||4096;window.BfnmaxImageSize=Math.min(window.BfnmaxImageSize,r-window.FixedPixiPaddingSize),console.log("Max Image Size Set:",window.BfnmaxImageSize,"Max Image Size that BeFunky can support:",r),window.bf_eventTrack("EXTERNAL","WEBGL_GRAPHIC",window.webglUnmaskedRenderer||"(unknown)"),navigator.deviceMemory&&window.bf_eventTrack("EXTERNAL","DEVICE_MEMORY",navigator.deviceMemory)}else{BeFunky.logError("WebGL test failed",window.failed_webgl_tests);var a=o.includes("no_webgl_canvas")?"no_webgl_canvas":o[0];window.bf_eventTrack("EXTERNAL","WEBGL_DISABLED_REASON",a.toUpperCase())}},BeFunky.runWebGLTests=function(){var e,n=[],t=function(e,t){n.push({name:e,hasPassed:!t})},o=navigator.userAgent||"";if(t("old_windows_version",/(Windows NT 5.1|Windows NT 5.2|Windows NT 6.0|Windows XP)/.test(o)),t("old_mac_version",function(e){if(/(MacPPC|MacIntel|Mac_PowerPC|Macintosh|Mac OS X)/.test(e)){var n=/10[._\d]+/.exec(e);if(n){var t=n[0];/[_]/.test(t)&&(t=t.split("_").join("."));var o=t.split(".");if(o[1]&&parseInt(o[1])<10)return!0}}return!1}(o)),t("old_browser_version",!function(){var e=null,n=null;try{var t=window.get_browser();e=t.name,n=Number(t.version)}catch(e){}if(n&&e&&("CHROME"===e.toUpperCase()&&n<55||"FIREFOX"===e.toUpperCase()&&n<48||"MSIE"===e.toUpperCase()&&n<=11||"IE"===e.toUpperCase()&&n<=11||"EDGE"===e.toUpperCase()&&n<=14||"SAFARI"===e.toUpperCase()&&n<10||BeFunky.isMac&&BeFunky.macOS10Version<11&&"SAFARI"===e.toUpperCase()&&n<=10||"OPERA"===e.toUpperCase()&&n<40))return!1;return!0}()),BeFunky.testingFlags.includes("disable_webgl_performance_check")?window.webGLPerformanceIssue=function(e){try{e||(e=document.createElement("canvas"));var n={failIfMajorPerformanceCaveat:!0},t=e.getContext("webgl",n)||e.getContext("experimental-webgl",n);if(!t)return"Yes";if(void 0===t.getContextAttributes().failIfMajorPerformanceCaveat)return"Not implemented"}catch(e){}return"No"}():(t("no_high_perf_canvas",!((e=Hr(!0))instanceof WebGLRenderingContext)),window.webGLPerformanceIssue=e instanceof WebGLRenderingContext?"No":"Yes"),e||t("no_webgl_canvas",!((e=Hr(!1))instanceof WebGLRenderingContext)),!e)return{results:n,canvasContext:e};var r=e.getExtension("OES_standard_derivatives"),a=e.getParameter(e.MAX_TEXTURE_SIZE);t("no_oes_standard_derivatives",!r),t("small_texture_size",a<4096);var i=e.getExtension("WEBGL_debug_renderer_info");if(i){var s=!!BeFunky.Params.isAdmin&&getCookie("webglUnmaskedRenderer");window.webglUnmaskedRenderer=s||e.getParameter(i.UNMASKED_RENDERER_WEBGL)}return{results:n,canvasContext:e}},BeFunky.webGLTestResultsTemplate=function(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e=e||BeFunky.runWebGLTests().results.filter(function(e){return!e.hasPassed}).map(function(e){return e.name});var t=BeFunky.lit,o=t.html,r=t.lang,a=[{errors:["old_windows_version"],message:"error_old_windows",link:"https://support.befunky.com/hc/en-us/articles/360045634352#h_your-operating-system-is-out-of-date"},{errors:["old_mac_version"],message:"error_old_mac",link:"https://support.befunky.com/hc/en-us/articles/360045634352#h_your-operating-system-is-out-of-date"},{errors:["old_browser_version"],message:"error_old_browser",link:"https://support.befunky.com/hc/en-us/articles/360045634352#h_your-browser-is-out-of-date"},{errors:["no_oes_standard_derivatives","small_texture_size"],message:"acknowledge_cant_run_app",link:"https://support.befunky.com/hc/en-us/articles/360045634352#h_your-computer-doesnt-meet-the-minimum-requirements"},{errors:["no_webgl_canvas"],message:o(Nr(),r("acknowledge_cant_run_app"),r("verify_hardware_acceleration"),r("restart_browser"),BeFunky.isWindows?o(jr(),r("update_gpu_driver")):""),link:"https://support.befunky.com/hc/en-us/articles/360045634352#h_your-browser-is-unable-to-run-befunky"},{errors:["no_high_perf_canvas"],message:"acknowledge_perf_issue",link:function(){if(BeFunky.isChromium)return BeFunky.isEdge?"https://support.befunky.com/hc/en-us/articles/360054839372":"https://support.befunky.com/hc/en-us/articles/360054508232";return BeFunky.isFirefox?"https://support.befunky.com/hc/en-us/articles/360054510672":"https://support.befunky.com/hc/en-us/articles/360051734551"}(),type:"warning"}].map(function(n){return c(c({},n),{},{errors:n.errors.filter(function(n){return e.includes(n)})})}).filter(function(e){return e.errors.length});return n?o(Or(),r("checked_your_computer"),e.length?s(a[0]):i(),e.length?"":o(Dr(),r("contact_our_support_team")),u,r("contact_support_heading")):e.length?s(a[0]):o(Ur(),i(),r("contact_our_support_team"),u,r("contact_support_heading"));function i(){var e=BeFunky.createNotification({message:"computer_meets_the_requirements",type:"success",isDismissable:!1});return e.setStyles({margin:"0 0 1.5rem 0",fontSize:"inherit"}),e}function s(e){var n=e.message,t=e.link,o=e.type,r=void 0===o?"error":o,a=BeFunky.createNotification({message:n,type:r,isDismissable:!1,button:{text:"learn_more",onClick:function(){return window.open(t,"_blank")}}});return a.setStyles({margin:"0 0 1.5rem 0",fontSize:"inherit"}),a}function u(){var n,t=function(e){var n=document.createElement("div").setClass("modal form-modal");return n.id="modal_form_".concat(e),n}("support"),o=BeFunky.isLoggedIn()?BeFunky.User.email:"";window.getSystemInformation(!0).then(function(e){n=e});var r=Mr(t,{title:"contact_support_heading",fields:[{name:"email",label:"email",type:"text",initialValue:o,errorMessage:"error_invalid_email",validate:window.isEmailAddress,sanitize:function(e){return e.trim()}},{name:"comment",label:"comment",fieldType:"textarea",type:"text"}],button:"submit",onSubmit:function(t){var o=t.email,r=t.comment,a="".concat(n," \n\n----WEBGL INFO----\n\n").concat(function(){if(0===e.length)return"Passed all WebGL tests";if(1===e.length)return"Failed one WebGL test: ".concat(e[0]);return"Failed ".concat(e.length," WebGL tests: ").concat(e.join(", "))}());BeFunky.requestAPI("auth/send-feedback",{email:o,subject:"Compatibility Check Results",message:r,system_info:a},{showLoadScreen:!0}).then(function(e){if("success"!==e.data)throw"invalid_response";i({confirmation:"contact_support_thanks"})}).catch(function(e){BeFunky.logError("Unable to send compatibility check support email",e),i({submissionErrors:[BeFunky.failureReason(e)]})})}}),a=r.teardown,i=r.setFormState;!function(e,n){BeFunky.openModal(e,{addSiteClass:!0,addCloseButton:!0,size:"small-nebula",destroyOnClose:!0,onClose:n})}(t,a)}},window.googleAuth2=null;var qr=!1;BeFunky.loginWithGoogle=function(){"localhost"===window.location.hostname?document.domain="localhost":document.domain="befunky.com",BeFunky.showLoadScreen(),window.openCustomPopup("".concat(BeFunky.Params.siteUrl,"GoogleLogin.php?__optkn=").concat(getCsToken()),BeFunky.attemptGoogleLogin)},BeFunky.attemptGoogleLogin=function(e){if(e&&"cancel"!==e){var n=e.id,t=e.name,o=e.email,r=e.profile_image;qr=!0,BeFunky.handleSocialLogin("google",{id:n,name:t,email:o,profile_image:r}).catch(function(){}).then(function(){qr=!1,BeFunky.hideLoadScreen()})}else qr||BeFunky.hideLoadScreen()},window.DRV_CLIENT_ID="303057181160-pvs0ajfctrvv15i4rmirjsve2plp8m92.apps.googleusercontent.com",window.DRV_SCOPES="https://www.googleapis.com/auth/drive https://www.googleapis.com/auth/drive.file",window.DRV_ACCESS=null,window.DRV_ACCESS_TIME=null,window.DRV_FLASH_CALLBACK=null,window.DRV_CLIENT_VERSION="v3",window.googleDrivePickerOpenerButton=document.createElement("button");var Vr=BeFunky.isUseHTML5&&window.$googleDriveState?deferredPromise():void 0,Wr=function(){for(var e,n=arguments.length,t=new Array(n),o=0;o<n;o++)t[o]=arguments[o];return(e=BeFunky).logFeature.apply(e,["google_drive"].concat(t))};function Gr(e){if("undefined"!=typeof Dropbox)return window.dropboxApiLoaded=!0,void(null!==e&&e());var n,t,o,r,a;0==dropboxApiRequested&&(window.dropboxApiRequested=!0,n=document,t="script",o="dropboxjs",a=n.getElementsByTagName(t)[0],n.getElementById(o)||((r=n.createElement(t)).id=o,r.setAttribute("data-app-key","xcse408r9ipxqtk"),r.src="https://www.dropbox.com/static/api/2/dropins.js",a.parentNode.insertBefore(r,a))),setTimeout(function(){Gr(e)},555)}window.ready(function(){var e=document.querySelector(".googleDriveLoginBtn");if(e&&e.addEventListener("click",function(){driveInmediateDisplay()}),window.googleDrivePickerOpenerButton.id="___googleDrivePickerOpenerButton",window.googleDrivePickerOpenerButton.addEventListener("click",function(){if(null!==window.driveApiLoadedCallback){try{window.driveApiLoadedCallback()}catch(e){}window.driveApiLoadedCallback=null}}),"undefined"!=typeof $googleDriveState&&null!=$googleDriveState){try{createJavascriptElements("https://apis.google.com/js/api.js?onload=onDrvApiLoad")}catch(e){}BeFunky.isUseHTML5&&(Wr("setup BeFunky.editorExternalImage"),BeFunky.editorExternalImage={ignoreExistingProject:!0,loadImage:function(){Vr.then(function(e){downloadDriveFile(e)}).catch(function(e){BeFunky.logError("Failed to load Drive image:",e),BeFunky.hideLoadScreen(),window.BFN&&BFN.AppModel.viewingEditor&&!BFN.PhotoEditorModel.currentTexture&&UIToggler.toggleSampleImagePopover(!0)}).then(function(){Vr=void 0})}})}}),window.onDrvApiLoad=function(){Wr("onDrvApiLoad");var e=function(){console.log("GOOGLE client init"),gapi.client.init({apiKey:"AIzaSyAs50xh8tgvIStq5wYwMuEylaLS2-kYaqw"}).then(function(){dv_handleAuthResult()})},n=function(){var n=gapi.auth2.getAuthInstance().currentUser.get(),t=n.getAuthResponse().access_token,o=n.getAuthResponse().id_token;o&&o.length>0&&t&&t.length>0&&(DRV_ACCESS=t,gapi.load("client",e))},t=function(){gapi.auth2.getAuthInstance().signIn().then(function(){console.log("GOOGLE signed in"),n()}).catch(function(e){console.log(e)})};gapi.load("auth2",{callback:function(){gapi.auth2.init({client_id:DRV_CLIENT_ID,scope:DRV_SCOPES}).then(function(){!0===gapi.auth2.getAuthInstance().isSignedIn.get()?n():BeFunky.confirm("google_drive_access",{onConfirm:t,onCancel:function(){BeFunky.logError("User cancelled Drive access")},confirmText:"ok",cancelText:"cancel"})}).catch(function(e){console.log(e)})}})},window.googleDriveCallbackCheck=function(){var e=!1;try{window.addEventListener("focus",function(n){e=!0},!1)}catch(e){}var n=setInterval(function(){null!==DRV_ACCESS?window.clearInterval(n):!1!==e&&(window.clearInterval(n),null===DRV_ACCESS&&(null!==DRV_FLASH_CALLBACK?dv_handleAuthResult(null):notApiLoadedGoToApp()))},1e3)},window.driveInmediateDisplay=function(e){if(0!=("undefined"!=typeof gapi&&void 0!==gapi.client&&void 0!==gapi.client.load)){if(DRV_FLASH_CALLBACK=null!==e?e:null,null!=$googleDriveState)try{document.getElementById("dynamic-content-state").style.display="none"}catch(e){}if(null===DRV_ACCESS)gapi.auth2.authorize({client_id:DRV_CLIENT_ID,scope:DRV_SCOPES,immediate:!1},dv_handleAuthResult),null!==DRV_FLASH_CALLBACK&&googleDriveCallbackCheck();else if(null!=DRV_FLASH_CALLBACK&&null!==DRV_ACCESS)if("undefined"!=typeof gapi&&void 0!==gapi.client&&void 0!==gapi.client.load)gapi.client.load("drive",window.DRV_CLIENT_VERSION,driveClientLoaded);else try{createJavascriptElements("https://apis.google.com/js/api.js?onload=onDrvApiLoad")}catch(e){}}else{window.driveApiLoadedCallback=function(){window.driveInmediateDisplay(e)};try{createJavascriptElements("https://apis.google.com/js/api.js?onload=onDrvApiLoad")}catch(e){}}},window.dv_handleAuthResult=function(e){Wr("dv_handleAuthResult",{authResult:e,DRV_ACCESS:DRV_ACCESS});var n=null;if(e||null===DRV_ACCESS)try{n=e.access_token?e.access_token:null}catch(e){}else n=DRV_ACCESS;if(null!==n)if(DRV_ACCESS=n,$googleDriveState,"undefined"!=typeof gapi&&void 0!==gapi.client&&void 0!==gapi.client.load)Wr("call gapi.client.load()"),gapi.client.load("drive",window.DRV_CLIENT_VERSION,driveClientLoaded);else{Wr("create JS with onDrvApiLoad");try{createJavascriptElements("https://apis.google.com/js/api.js?onload=onDrvApiLoad")}catch(e){}}else{if(null!=$googleDriveState)try{document.getElementById("dynamic-content-state").style.display="block",document.querySelector("#dynamic-content-state #loader").style.display="none",document.querySelector("#dynamic-content-state .message-box").style.display="block"}catch(e){}sendToFlashFromDrvParams()}null!==window.driveApiLoadedCallback&&window.googleDrivePickerOpenerButton.click()},window.driveClientLoaded=function(){Wr("driveClientLoaded"),DRV_FLASH_CALLBACK||null==$googleDriveState||(bf_eventTrack("EXTERNAL","GOOGLE_DRIVE","OPEN"),checkDriveFile($googleDriveState)),sendToFlashFromDrvParams()},window.sendToFlashFromDrvParams=function(){if(null!==DRV_FLASH_CALLBACK){var e="https://www.googleapis.com/upload/drive/v3/files";if(null!=DRV_ACCESS)if(0==BeFunky.isUseHTML5)try{document.getElementById(BeFunky.Params.swfId).callbackFromJs(e,DRV_ACCESS)}catch(e){}else try{BFN.BfnService.callbackFromJs(e,DRV_ACCESS)}catch(e){}else if(0==BeFunky.isUseHTML5)try{document.getElementById(BeFunky.Params.swfId).callbackFromJs()}catch(e){}else try{BFN.BfnService.callbackFromJs()}catch(e){}DRV_FLASH_CALLBACK=null}},window.checkDriveFile=function(e){Wr("checkDriveFile",e);try{BeFunky.showLoadScreen();var n="v3"===window.DRV_CLIENT_VERSION?"id,webContentLink,mimeType":"id,downloadUrl,mimeType";gapi.client.drive.files.get({fileId:e,fields:n}).execute(function(e){Wr("checkDriveFile response",e),Vr?e.error?(Wr("driveImageReadyPromise rejected"),Vr.reject(e.error)):(Wr("driveImageReadyPromise resolved"),Vr.resolve(e)):downloadDriveFile(e)})}catch(e){BeFunky.hideLoadScreen(),Vr&&Vr.reject(e)}},window.downloadDriveFile=function(e){Wr("downloadDriveFile",e);try{if(null===e)return void BeFunky.hideLoadScreen();var n=void 0!==e.downloadUrl?e.downloadUrl:void 0!==e.webContentLink&&e.webContentLink;if(n){"v3"===window.DRV_CLIENT_VERSION&&(n="https://www.googleapis.com/drive/v3/files/".concat(e.id,"?alt=media"));var t=gapi.auth.getToken().access_token,o=e.mimeType;if(null!=t){if(BeFunky.isUseHTML5){var r={responseType:"blob",headers:{Authorization:"Bearer ".concat(t)}};return BeFunky.request(n,r,function(e){var n=e.response,t=e.error;if(t&&(BeFunky.throwError("Unable to download Drive image",t),BeFunky.hideLoadScreen(),window.BFN&&BFN.AppModel.viewingEditor&&!BFN.PhotoEditorModel.currentTexture&&UIToggler.toggleSampleImagePopover(!0)),window.$googleDriveState){var o=window.location.href;if(o.includes("?state="))try{window.history.replaceState({},"",o.split("?state=")[0])}catch(e){BeFunky.throwError(e)}}BFN.PhotoEditorModel.loadBase64OrBlob(n),BFN.BfnService.track("CREATE","UPLOAD","DRIVE"),BFN.BfnService.trackMediaOpened("image","drive")})}var a=function(){try{"none"!==document.getElementById("modalBackgroundImg").style.display&&hideModalBackgroundImage()}catch(e){}try{setApplicationMode("photoeditor")}catch(e){}openFlash();try{document.getElementById("dynamic-content-state").style.display="none"}catch(e){}},i=null;if("undefined"!=typeof XMLHttpRequest)"withCredentials"in(i=new XMLHttpRequest)?i.open("GET",n,!0):"undefined"!=typeof XDomainRequest&&(i=new XDomainRequest).open("GET",n);else{try{i=new ActiveXObject("Microsoft.XMLHTTP")}catch(e){}if(null==i)try{i=new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(e){}if(null==i)try{i=new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(e){}if(null==i)try{i=new ActiveXObject("Microsoft.XMLHTTP")}catch(e){}i.open("GET",n)}try{i.responseType="arraybuffer"}catch(e){}i.setRequestHeader("Authorization","Bearer ".concat(t)),i.onload=function(){var e=new FileReader;e.onload=function(n){a();try{var t=n.target.result;if(t=(t=(t=t.replace("image/jpeg;","")).replace("image/png;","")).replace("data:base64,",""),0==BeFunky.isUseHTML5){try{document.getElementById(BeFunky.Params.swfId).ToJsBase64Uploader(t)}catch(e){}t=null,BeFunky.hideLoadScreen()}else setTimeout(function(){try{BFN.BfnService.ToJsBase64Uploader(t,void 0,"drive"),t=null}catch(e){}BeFunky.hideLoadScreen()},2e3)}catch(e){BeFunky.hideLoadScreen()}e=null};try{e.readAsDataURL(new Blob([i.response],{type:o}))}catch(e){try{var r="https://upload.befunky.com/restupload/driveImageRequest.bfn?dwnurl=".concat(encodeURIComponent(n),"&actoken=").concat(t,"&mtype=").concat(o,"&CSRFtoken=").concat(getCsToken());if(0==BeFunky.isUseHTML5)try{document.getElementById(BeFunky.Params.swfId).ToJsUrlUploader(r,null,!1)}catch(e){}else setTimeout(function(){try{BFN.BfnService.ToJsUrlUploader(r,null,!0,"drive")}catch(e){}},2e3)}catch(e){}}},i.onerror=function(){BeFunky.hideLoadScreen(),a();var e="https://upload.befunky.com/restupload/driveImageRequest.bfn?dwnurl=".concat(encodeURIComponent(n),"&actoken=").concat(t,"&mtype=").concat(o,"&CSRFtoken=").concat(getCsToken());if(0==BeFunky.isUseHTML5)try{document.getElementById(BeFunky.Params.swfId).ToJsUrlUploader(e,null,!1)}catch(e){}else try{BFN.BfnService.ToJsUrlUploader(e,null,!0,"drive")}catch(e){}},i.send()}}}catch(e){BeFunky.hideLoadScreen()}},window.insertDriveFile=function(e,n){Wr("insertDriveFile",e,n);var t=function(t){if(Wr("drv_pickerFolderCallback",t),t[google.picker.Response.ACTION]==google.picker.Action.PICKED){try{"none"!==document.getElementById("modalBackgroundImg").style.display&&hideModalBackgroundImage()}catch(e){}openFlash();var o=t[google.picker.Response.DOCUMENTS][0].id;if(null!=o){var r="-------314159265358979323846",a="\r\n--".concat(r,"\r\n"),i="\r\n--".concat(r,"--"),s={title:n,name:n,mimeType:"image/jpeg",parents:[o]},u="".concat(a,"Content-Type: application/json\r\n\r\n").concat(JSON.stringify(s)).concat(a,"Content-Type: image/jpeg\r\nContent-Transfer-Encoding: base64\r\n\r\n").concat(e).concat(i);gapi.client.request({path:"/upload/drive/v3/files",method:"POST",params:{uploadType:"multipart"},headers:{"Content-Type":'multipart/mixed; boundary="'.concat(r,'"')},body:u}).execute(function(e){if(0==BeFunky.isUseHTML5)try{document.getElementById(BeFunky.Params.swfId).callbackDriveInsertFile()}catch(e){}else try{BFN.BfnService.callbackDriveInsertFile()}catch(e){}})}}else if(t[google.picker.Response.ACTION]==google.picker.Action.CANCEL)if(notApiLoadedGoToApp(),0==BeFunky.isUseHTML5)try{document.getElementById(BeFunky.Params.swfId).callbackDriveInsertFile("error")}catch(e){}else try{BFN.BfnService.callbackDriveInsertFile("cancel")}catch(e){}},o=function(){if(!1!==drv_pickerApiLoaded&&null!==DRV_ACCESS){var e=(new google.picker.DocsView).setIncludeFolders(!0).setMimeTypes("application/vnd.google-apps.folder").setSelectFolderEnabled(!0);(new google.picker.PickerBuilder).setAppId("303057181160").setOAuthToken(DRV_ACCESS).setTitle("Select a Folder").addView(e).setDeveloperKey("AIzaSyAs50xh8tgvIStq5wYwMuEylaLS2-kYaqw").setOrigin("".concat(window.location.protocol,"//").concat(window.location.host)).setCallback(t).build().setVisible(!0)}else notApiLoadedGoToApp()};!1!==drv_pickerApiLoaded&&null!==DRV_ACCESS?o():!1===drv_pickerApiLoaded&&null!==DRV_ACCESS?gapi.load("picker",{callback:function(){drv_pickerApiLoaded=!0,window.driveApiLoadedCallback=o,window.googleDrivePickerOpenerButton.click()}}):0==drvImmediatTryed&&(drvImmediatTryed=!0,document.body.addClass("prevent-body-scroll"),gapi.auth2.authorize({client_id:DRV_CLIENT_ID,scope:DRV_SCOPES,immediate:!1},function(e){if(e&&!e.error){DRV_ACCESS=e.access_token;try{DRV_ACCESS_TIME=(new Date).getTime()}catch(e){}gapi.load("picker",{callback:function(){drv_pickerApiLoaded=!0,window.driveApiLoadedCallback=o,window.googleDrivePickerOpenerButton.click()}})}}),googleDriveCallbackCheck())},window.drv_pickerApiLoaded=!1,window.drvImmediatTryed=!1,window.driveApiLoadedCallback=null,window.drv_OpenPicker=function(){if("undefined"!=typeof gapi&&void 0!==gapi.client&&void 0!==gapi.client.load)!1!==drv_pickerApiLoaded&&null!==DRV_ACCESS?drv_createPicker():!1===drv_pickerApiLoaded&&null!==DRV_ACCESS?gapi.load("picker",{callback:onDrvPickerApiLoad}):0==drvImmediatTryed&&(drvImmediatTryed=!0,document.body.addClass("prevent-body-scroll"),gapi.auth2.authorize({client_id:DRV_CLIENT_ID,scope:DRV_SCOPES,immediate:!1},handleDrvApiAuthResultImmediate),googleDriveCallbackCheck());else{window.driveApiLoadedCallback=window.drv_OpenPicker;try{createJavascriptElements("https://apis.google.com/js/api.js?onload=onDrvApiLoad")}catch(e){}}},window.handleDrvApiAuthResultImmediate=function(e){e&&!e.error&&(DRV_ACCESS=e.access_token,gapi.load("picker",{callback:onDrvPickerApiLoad}))},window.onDrvPickerApiLoad=function(){drv_pickerApiLoaded=!0,window.driveApiLoadedCallback=drv_createPicker,window.googleDrivePickerOpenerButton.click()},window.drv_createPicker=function(){if(drv_pickerApiLoaded&&DRV_ACCESS){var e=new google.picker.View(google.picker.ViewId.DOCS);e.setMimeTypes("image/png,image/jpeg,image/jpg"),(new google.picker.PickerBuilder).setAppId("303057181160").setOAuthToken(DRV_ACCESS).addView(e).addView(new google.picker.DocsUploadView).setDeveloperKey("AIzaSyAs50xh8tgvIStq5wYwMuEylaLS2-kYaqw").setOrigin("".concat(window.location.protocol,"//").concat(window.location.host)).setCallback(drv_pickerCallback).build().setVisible(!0)}else notApiLoadedGoToApp()},window.notApiLoadedGoToApp=function(){drvImmediatTryed=!1;try{"none"!==document.getElementById("modalBackgroundImg").style.display&&hideModalBackgroundImage()}catch(e){}openFlash()},window.gaDriveScrollHandler=function(){window.scrollTo(0,0)},window.drv_pickerCallback=function(e){if(e.action==google.picker.Action.PICKED){var n=e.docs[0].id;if(window.removeEventListener("scroll",window.gaDriveScrollHandler),null!==n){try{openFlash()}catch(e){}if("undefined"!=typeof gapi&&void 0!==gapi.client&&void 0!==gapi.client.load)gapi.client.load("drive",window.DRV_CLIENT_VERSION,function(){if(0==BeFunky.isUseHTML5)checkDriveFile(n);else try{BFN.PhotoEditorModel.confirmEditorLoadImage(function(){checkDriveFile(n)})}catch(e){checkDriveFile(n)}});else try{createJavascriptElements("https://apis.google.com/js/api.js?onload=onDrvApiLoad")}catch(e){}}}else if(e.action.toLowerCase()!==google.picker.Action.LOADED){window.removeEventListener("scroll",window.gaDriveScrollHandler);try{"none"!==document.getElementById("modalBackgroundImg").style.display&&hideModalBackgroundImage()}catch(e){}try{openFlash()}catch(e){}}else window.addEventListener("scroll",window.gaDriveScrollHandler)},window.loadExternalImage=function(e,n){var t=new Image;t.setAttribute("crossOrigin","Anonymous"),t.onload=function(){var e=document.createElement("CANVAS"),o=e.getContext("2d");e.height=this.height,e.width=this.width,o.drawImage(this,0,0);var r=e.toDataURL("image/png");if(r=(r=(r=r.replace("image/jpeg;","")).replace("image/png;","")).replace("data:base64,",""),e=null,o=null,t=null,0==BeFunky.isUseHTML5)try{document.getElementById(BeFunky.Params.swfId).ToJsBase64Uploader(r)}catch(e){}else try{BFN.BfnService.ToJsBase64Uploader(r,n,"dropbox")}catch(e){}},t.src=e},window.dropboxApiLoaded=!1,window.dropboxApiRequested=!1,window.dBoxOpenPicker=function(){var e=document.getElementById("dropbox-btn");if(null!=e&&(e.removeEventListener("click",window.dBoxOpenPicker),e.removeEventListener("click",window.dBoxSaveFileHandler)),0==window.dropboxApiLoaded){var n=document.getElementById("dropbox-btn");return null==n&&((n=document.createElement("button")).setAttribute("style","display:none"),n.id="dropbox-btn",document.body.appendChild(n)),n.addEventListener("click",window.dBoxOpenPicker),void Gr(function(){n.click()})}document.body.addClass("prevent-body-scroll");var t={success:function(e){try{"none"!=document.getElementById("modalBackgroundImg").style.display&&hideModalBackgroundImage()}catch(e){}try{setApplicationMode("photoeditor")}catch(e){}openFlash();try{loadExternalImage(e[0].link,e[0].name)}catch(e){}},cancel:function(){try{"none"!=document.getElementById("modalBackgroundImg").style.display&&hideModalBackgroundImage()}catch(e){}openFlash()},linkType:"direct",multiselect:!1,extensions:[".jpg",".jpeg",".png",".bmp",".gif"]};Dropbox.choose(t)},window.dBoxSaveFileHandler=function(){var e=document.getElementById("dropbox-btn");null!=e&&(e.removeEventListener("click",window.dBoxOpenPicker),e.removeEventListener("click",window.dBoxSaveFileHandler)),window.dBoxSaveFile(window.dBoxSaveFileObj.url,window.dBoxSaveFileObj.filename)},window.dBoxSaveFileObj={url:"",filename:""},window.dBoxSaveFile=function(e,n){window.dBoxSaveFileObj={url:e,filename:n};var t=document.getElementById("dropbox-btn");if(null!=t&&(t.removeEventListener("click",window.dBoxOpenPicker),t.removeEventListener("click",window.dBoxSaveFileHandler)),0==window.dropboxApiLoaded)return null==t&&((t=document.createElement("button")).setAttribute("style","display:none"),t.id="dropbox-btn",document.body.appendChild(t)),t.addEventListener("click",window.dBoxSaveFileHandler),void Gr(function(){t.click()});document.body.addClass("prevent-body-scroll");var o=!1,r=!1,a=null;if(Dropbox.isBrowserSupported()){var i={success:function(){if(o=!0,0==BeFunky.isUseHTML5)try{document.getElementById(BeFunky.Params.swfId).handlerDrobboxInsert("success")}catch(e){}else try{BFN.BfnService.handlerDropBoxInsert("success")}catch(e){}},progress:function(e){0==r&&(r=!0,a=setTimeout(function(){if(null!=a&&(clearTimeout(a),a=null),0==o)if(0==BeFunky.isUseHTML5)try{document.getElementById(BeFunky.Params.swfId).handlerDrobboxInsert("cancel")}catch(e){}else try{BFN.BfnService.handlerDropBoxInsert("cancel")}catch(e){}},2e4))},cancel:function(){if(o=!0,null!=a&&(clearTimeout(a),a=null),0==BeFunky.isUseHTML5)try{document.getElementById(BeFunky.Params.swfId).handlerDrobboxInsert("cancel")}catch(e){}else try{BFN.BfnService.handlerDropBoxInsert("cancel")}catch(e){}},error:function(e){if(o=!0,null!=a&&(clearTimeout(a),a=null),0==BeFunky.isUseHTML5)try{document.getElementById(BeFunky.Params.swfId).handlerDrobboxInsert("error")}catch(e){}else try{BFN.BfnService.handlerDropBoxInsert("error")}catch(e){}}};Dropbox.save(e,n,i)}else if(0==BeFunky.isUseHTML5)try{document.getElementById(BeFunky.Params.swfId).handlerDrobboxInsert("error")}catch(e){}else try{BFN.BfnService.handlerDropBoxInsert("error")}catch(e){}},BeFunky.handleSocialLogin=function(e,n){return new Promise(function(t,o){if(!["google","facebook"].includes(e))return o("Invalid social provider: ".concat(e));var r=n.id,a=n.email,i=n.name,s=n.gender,u=n.user_birthday,c=n.access_token,l={user_id:r,sntype:"google"===e?"GOOGLE":"FACEBOOK",email:a,CSRFtoken:getCsToken(),screenname:i,gender:s||"",user_birthday:u||"",access_token:c||""};BeFunky.requestAPI("auth/sn-login",l).then(function(n){var o=["true",!0].includes(n.data.newUser)?"_NEW":"";return window.bf_eventTrack("EXTERNAL","SIGNIN_SOCIAL",e.toUpperCase()+o),BeFunky.onLoginSuccess(n.data),t(n.data)}).catch(function(r){if("already_logged_in"===r)return BeFunky.handleAlreadyLoggedInError(a).then(function(e){BeFunky.onLoginSuccess(e),t(e)}).catch(function(a){if("different_user_logged_out"!==a)throw r;BeFunky.logError("Attempting sign in again now that existing user has been signed out"),BeFunky.handleSocialLogin(e,n).then(t,o)});throw r}).catch(function(e){return BeFunky.logError("Social login failed:",e),o(e)})})},window.openCustomPopupInstance=null,window.openCustomPopup=function(e,n){var t=600;e.includes("weheartit.com")&&(t=800);var o=screen.width/2-375,r=screen.height/2-t/2;try{openCustomPopupInstance=window.open(e,"APP","top=".concat(r,",left=").concat(o,",width=").concat(750,",height=").concat(t,",resizable=1"),!0);try{openCustomPopupInstance.focus()}catch(e){}}catch(e){n?n("cancel"):toFlex({cancel:1})}windowOpenerInterval=setInterval(function(){if(null==openCustomPopupInstance||openCustomPopupInstance.closed){try{clearInterval(windowOpenerInterval)}catch(e){}windowOpenerInterval=null,setTimeout(function(){n?n("cancel"):toFlex({cancel:1})},555)}},500)},window.snLoggedinType="",window.snWinType="",window.snType="FACEBOOK";var zr=function(){function e(){r(this,e),this.currentCallback=null,this.currentParams=null}return i(e,[{key:"login",value:function(){var e=this;BeFunky.confirm("You need to login to Etsy",{onConfirm:function(){"localhost"===window.location.hostname?document.domain="localhost":document.domain="befunky.com",window.openCustomPopup("".concat(BeFunky.Params.siteUrl,"api/etsy/token/?__optkn=").concat(getCsToken()),window.BeFunky.etsy_manager.loginSuccess)},onCancel:function(){e.currentCallback=null,e.currentParams=null},confirmText:"ok",cancelText:"cancel"})}},{key:"loginSuccess",value:function(e){"cancel"!=e&&null!==this.currentCallback&&(null!==this.currentParams&&"object"==o(this.currentParams)&&void 0!==this.currentParams.length?3==this.currentParams.length?this.currentCallback(this.currentParams[0],this.currentParams[1],this.currentParams[2]):2==this.currentParams.length?this.currentCallback(this.currentParams[0],this.currentParams[1]):1==this.currentParams.length&&this.currentCallback(this.currentParams[0]):null!==this.currentParams?this.currentCallback(this.currentParams):this.currentCallback())}},{key:"getUserInfo",value:function(){var e=this;this.currentCallback=this.getUserInfo,BeFunky.requestAPI("etsy/get-user",{},{showLoadScreen:!0}).then(function(e){console.log(e)}).catch(function(n){"no_access_token"!==n?"invalid_response"===n?BeFunky.throwError("Etsy error: ",n):BeFunky.logError("Etsy error: ",n):e.login()})}},{key:"getShops",value:function(){var e=this;this.currentCallback=this.getShops,BeFunky.requestAPI("etsy/shops",{},{showLoadScreen:!0}).then(function(e){console.log(e)}).catch(function(n){"no_access_token"!==n?"invalid_response"===n?BeFunky.throwError("Etsy error: ",n):BeFunky.logError("Etsy error: ",n):e.login()})}},{key:"getListing",value:function(e){var n=this;this.currentCallback=this.getListing;var t={};e&&(this.currentParams=e,t={shop_name:e}),BeFunky.requestAPI("etsy/listing",t,{showLoadScreen:!0}).then(function(e){console.log(e)}).catch(function(e){"no_access_token"!==e?"invalid_response"===e?BeFunky.throwError("Etsy error: ",e):BeFunky.logError("Etsy error: ",e):n.login()})}},{key:"uploadAvatar",value:function(e){var n=this;this.currentCallback=this.getListing,this.currentParams=e;var t=function(e){BeFunky.requestAPI("etsy/upload-avatar",{image_url:e},{showLoadScreen:!0}).then(function(e){console.log(e)}).catch(function(e){"no_access_token"!==e?"invalid_response"===e?BeFunky.throwError("Etsy error: ",e):BeFunky.logError("Etsy error: ",e):n.login()})};if("string"==typeof e)return t(e);var o=void 0!==e.type?e.type:"image/jpeg";window.DirectUPL.upload(function(e){var n;e&&e.url&&e.s3_name?t(e.url):(n=e,console.log("Upload Etsy Error: ",n))},{bucket:"artsyupload",content_type:o,blob:e})}},{key:"uploadShopBanner",value:function(e,n){var t=this;this.currentCallback=this.getListing,this.currentParams=[e,n];var o=function(e){BeFunky.requestAPI("etsy/upload-banner",{image_url:e,shop_id:n},{showLoadScreen:!0}).then(function(e){console.log(e)}).catch(function(e){"no_access_token"!==e?"invalid_response"===e?BeFunky.throwError("Etsy error: ",e):BeFunky.logError("Etsy error: ",e):t.login()})};if("string"==typeof e)return o(e);var r=void 0!==e.type?e.type:"image/jpeg";window.DirectUPL.upload(function(e){var n;e&&e.url&&e.s3_name?o(e.url):(n=e,console.log("Upload Etsy Error: ",n))},{bucket:"artsyupload",content_type:r,blob:e})}},{key:"uploadListing",value:function(e,n,t){var o=this;this.currentCallback=this.getListing,this.currentParams=[e,n,t];var r=function(e){var r={image_url:e,listing_id:n};!1!==t&&(r.image_id=t),BeFunky.requestAPI("etsy/upload-listing",r,{showLoadScreen:!0}).then(function(e){console.log(e)}).catch(function(e){"no_access_token"!==e?"invalid_response"===e?BeFunky.throwError("Etsy error: ",e):BeFunky.logError("Etsy error: ",e):o.login()})};if("string"==typeof e)return r(e);var a=void 0!==e.type?e.type:"image/jpeg";window.DirectUPL.upload(function(e){var n;e&&e.url&&e.s3_name?r(e.url):(n=e,console.log("Upload Etsy Error: ",n))},{bucket:"artsyupload",content_type:a,blob:e})}}]),e}();window.BeFunky.etsy_manager=new zr;var Xr=function(){function e(){r(this,e),this.mightBeAuthorized=Boolean(getCookie("PHPSESSID"))}return i(e,[{key:"login",value:function(){var e=this,n=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return new Promise(function(t,o){var r=function(){e.loginSuccess&&e.loginSuccess("cancel"),e.loginSuccess=function(n){if("cancel"===n)return o("cancelled_by_user");e.mightBeAuthorized=!0,t()},"localhost"===window.location.hostname?document.domain="localhost":document.domain="befunky.com",window.openCustomPopup("".concat(BeFunky.Params.siteUrl,"api/google-photos/token/?__optkn=").concat(getCsToken()),window.BeFunky.GooglePhotosManager.loginSuccess)};if(!n)return r();BeFunky.confirm("google_photos_access",{onConfirm:r,imageUrl:"".concat(BeFunky.Params.globalImagesPath,"site/illustrations/gear.svg"),onCancel:function(){return o("cancelled_by_user")},confirmText:"ok",cancelText:"cancel"})})}},{key:"requestGooglePhotosAPI",value:function(e,n){var t=this;return BeFunky.requestAPI(e,n,{logErrorMessage:!0}).catch(function(o){if("no_access_token"!==o)throw o;return t.mightBeAuthorized=!1,t.login().then(function(){return t.requestGooglePhotosAPI(e,n)})})}},{key:"getAlbums",value:function(){return this.requestGooglePhotosAPI("google-photos/albums").then(function(e){var n=e.data;if(!Array.isArray(n))throw"invalid_response";return n})}},{key:"getAlbumMedia",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return this.requestGooglePhotosAPI("google-photos/search-media",{album_id:e,next_page:n}).then(function(e){if(!Array.isArray(e.data))throw"invalid_response";return{mediaItems:e.data,nextPageToken:e.next_page}})}},{key:"getMediaItem",value:function(e){return this.requestGooglePhotosAPI("google-photos/get-media-item",{id:e}).then(function(e){var n=e.data;if(!n.id)throw"invalid_response";return n})}},{key:"getAllMedia",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this.requestGooglePhotosAPI("google-photos/list-all-media",{next_page:e}).then(function(e){if(!Array.isArray(e.data))throw"invalid_response";return{mediaItems:e.data,nextPageToken:e.next_page}})}},{key:"createAlbum",value:function(e){return this.requestGooglePhotosAPI("google-photos/create-album",{title:e}).then(function(e){var n=e.data;if(!n.album_id)throw"invalid_response";return n})}},{key:"uploadMedia",value:function(e,n,t){var o=this;return BeFunky.uploadFileToS3(e,{bucket:"artsyupload",blob:e,contentType:e.type||"image/jpeg"}).then(function(e){var r,a=e.url;return r={image_url:a,file_name:n},t&&(r.album_id=t),o.requestGooglePhotosAPI("google-photos/upload-media",r)})}},{key:"downloadGooglePhoto",value:function(e){var n=this;return Promise.all([o(),t()]).catch(function(r){BeFunky.logError("Google Photo baseUrl may have expired. Refreshing metadata...",r);var a=e.id.replace("google_photos_","");return n.getMediaItem(a).then(function(r){var a=k(n.mediaItemsToImageObjects([r]),1)[0];return e.imageWidth===a.imageWidth&&e.imageHeight===a.imageHeight||BeFunky.throwError("Google Photos image dimensions changed",e,a),e.thumbURL=a.thumbURL,e.imageURL=a.imageURL,Promise.all([o(),t()])})});function t(){return new Promise(function(n,t){var o="".concat(BFN.userVo.uplUri,"/loadImage.php?c=").concat(encodeURIComponent(e.imageURL));BeFunky.request(o,{responseType:"blob"},function(e){var o=e.response,r=e.error;o instanceof Blob?n(o):t(r||"invalid_response")})})}function o(){return new Promise(function(n,t){var o=new Image;o.onerror=function(){t("request_failed")},o.onload=function(){var t=document.createElement("canvas"),r=t.getContext("2d");t.width=e.thumbWidth,t.height=e.thumbHeight,r.drawImage(o,0,0,t.width,t.height),n(t.toDataURL("image/jpeg",.9))},o.crossOrigin="anonymous",o.src="".concat(BFN.userVo.uplUri,"/loadImage.php?c=").concat(encodeURIComponent(e.thumbURL))})}}},{key:"mediaItemsToImageObjects",value:function(e){var n=BeFunky.isRetina()?300:200;return e.filter(function(e){var n=e.mimeType,t=e.width,o=e.height;return/^image\//.test(n)&&t&&o}).map(function(e){var t,o,r,a=e.width/e.height,i=BFN.maxImageSize;return e.width<i&&e.height<i?(t="".concat(e.baseUrl,"=w").concat(e.width),o=e.width,r=e.height):a>=1?(t="".concat(e.baseUrl,"=w").concat(i),o=i,r=Math.round(i/a)):(t="".concat(e.baseUrl,"=h").concat(i),o=Math.round(i*a),r=i),{id:"google_photos_".concat(e.id),imageURL:t,imageWidth:o,imageHeight:r,thumbURL:"".concat(e.baseUrl,"=h").concat(n),thumbWidth:Math.round(n*a),thumbHeight:n}})}}]),e}();BeFunky.GooglePhotosManager=new Xr;var Jr,$r,Yr=BeFunky.once(function(){var e=BeFunky.imageLibraryModal({imageSelectionHandler:function(n){return urlUpload(n.imageURL),BeFunky.closeModal(e.id),!1},isSelected:function(){return!1},initialMode:"UPLOAD_MENU",onClose:openFlash});e.addClass("bfn"),document.body.appendChild(e),BeFunky.flashImageLibrary=e});BeFunky.openPreviousUploadsPanel=function(){Yr(),BeFunky.flashImageLibrary.open("befunky")},BeFunky.openFacebookPanel=function(){Yr(),BeFunky.flashImageLibrary.open("facebook")},BeFunky.Flash={},BeFunky.Flash.getPreviousUploads=function(e,n){function t(e){try{document.getElementById(BeFunky.Params.swfId).flash_getPreviousUploadsHandler(e)}catch(e){console.log("Flash calling error getPreviousUploads: ",e)}}BeFunky.requestAPI("photo/previous-uploads",{start:e,end:n}).then(function(e){if(void 0===e.data||null==e.data)throw"invalid_response";t(JSON.stringify(e))}).catch(function(e){t("error")})},BeFunky.Flash.getLayersImages=function(e,n){function t(e){try{document.getElementById(BeFunky.Params.swfId).flash_getLayersHandler(e)}catch(e){console.log("Flash calling error: ",e)}}BeFunky.requestAPI("photo/library-images",{start:e,end:n}).then(function(e){if(void 0===e.data||null==e.data)throw"invalid_response";t(JSON.stringify(e))}).catch(function(e){t("error")})},BeFunky.Flash.deleteLayerImage=function(e){function n(e){try{document.getElementById(BeFunky.Params.swfId).flash_deleteLayersHandler(e)}catch(e){console.log("Flash calling error: ",e)}}BeFunky.requestAPI("photo/delete-image",{imgIds:e}).then(function(e){if("success"!==e.data)throw"invalid_response";n("success")}).catch(function(e){n("error")})},BeFunky.Flash.getProjects=function(e,n){function t(e){try{document.getElementById(BeFunky.Params.swfId).flash_getProjectsHandler(e)}catch(e){console.log("Flash calling error: ",e)}}BeFunky.requestAPI("photo/projects/get",{start:e,end:n}).then(function(e){if(void 0===e.data||null==e.data)throw"invalid_response";t(JSON.stringify(e))}).catch(function(e){t("error")})},BeFunky.Flash.deleteProject=function(e){function n(e){try{document.getElementById(BeFunky.Params.swfId).flash_deleteProjectHandler(e)}catch(e){console.log("Flash calling error: ",e)}}BeFunky.requestAPI("photo/projects/delete",{template:e}).then(function(e){if("success"!==e.data)throw"invalid_response";n("success")}).catch(function(e){n("error")})},BeFunky.openEtsyPanel=function(){},window.openerDivAc=function(e){return hideEditor(e)},BeFunky.contestDismissed=function(){return"1"},window.bfnJUploadFromComputer=function(e){var n=document.createElement("input");n.type="file",n.id="bfn_fk_image_computer_input",n.setStyles({display:"none"}),n.setAttribute("accept","".concat("bfd"==e?".bfd":"image/*")),document.body.appendChild(n);var t=document.createElement("button");t.id="bfn_fk_image_computer_input_btn",t.setStyles({display:"none"}),document.body.appendChild(t);var o=function(e){n.click()};n.addEventListener("click",function n(t){var r=function(){var t=null;try{t=document.getElementById("bfn_fk_image_computer_input").files[0]}catch(e){}if(null!=t){var r=new FileReader;r.onload=function(n){var o=null;try{if(o=n.target.result,"bfd"==e){o=o.replace("data:;base64,","");try{o=decodeURIComponent(escape(window.atob(o)))}catch(e){}}else o=(o=(o=(o=o.replace("image/jpeg;","")).replace("image/png;","")).replace("data:base64,","")).replace("data:;base64,","");var a=null;try{a=(a=t.name).substring(0,a.lastIndexOf("."))}catch(e){}try{null!=a?document.getElementById(BeFunky.Params.swfId).bfnJUploadFromComputerCallback(o,e,a):document.getElementById(BeFunky.Params.swfId).bfnJUploadFromComputerCallback(o,e)}catch(e){}}catch(e){try{document.getElementById(BeFunky.Params.swfId).bfnJUploadFromComputerCallback(null,"cancel")}catch(e){}}o=null,r=null},r.readAsDataURL(t)}else try{document.getElementById(BeFunky.Params.swfId).bfnJUploadFromComputerCallback(null,"cancel")}catch(e){}document.body.onfocus=null,document.getElementById("bfn_fk_image_computer_input").value="",document.getElementById("bfn_fk_image_computer_input").removeEventListener("click",n),document.getElementById("bfn_fk_image_computer_input_btn").removeEventListener("click",o),document.getElementById("bfn_fk_image_computer_input").parentNode.removeChild(document.getElementById("bfn_fk_image_computer_input")),document.getElementById("bfn_fk_image_computer_input_btn").parentNode.removeChild(document.getElementById("bfn_fk_image_computer_input_btn"))};document.body.onfocus=function(){setTimeout(r,100)}},!1),t.addEventListener("click",o,!1),t.click()},window.getModalBackgroundImage=function(){return Jr||(Jr=document.getElementById("modalBackgroundImg")),Jr},window.showBase64Image=function(e){var n=getModalBackgroundImage();n.setStyles({marginTop:0,width:"100%",height:"100%",display:"block"}),n.src="data:image/jpeg;base64,".concat(e)},window.hideModalBackgroundImage=function(){var e=getModalBackgroundImage();if(e&&"block"===e.style.display){if(e.setStyles({display:"none"}).src="",!$r)try{$r=document.getElementById(BeFunky.Params.swfId)}catch(e){}$r&&($r.width=setInitFlashWidth(),$r.height=setInitFlashHeight())}},window.flFunctionCall=function(e){switch(BeFunky.LoginPanelObj.closeNextFunction=openFlash,e){case"SIGN_IN":BeFunky.openLoginPanel("SIGNIN",openFlash);break;case"REGISTER":BeFunky.openLoginPanel("REGISTER",openFlash)}};var Kr=BeFunky.Params.IS_LC?3e4:216e5,Qr=0,Zr=function(){},ea=BeFunky.debounce(function(e){window.swIndicator&&window.swIndicator.update(e,ia,Qr>0)},0),na=BeFunky.debounce(function(e){["installing","waiting","active"].map(function(n){return e[n]}).filter(Boolean).forEach(function(n){n.version?ea(e):ua(n).then(function(){return ea(e)})})},50);window.addEventListener("appinstalled",function(){window.bf_eventTrack("EXTERNAL","PWA","Installed"),da()});var ta=window.matchMedia("(display-mode: standalone)");function oa(){for(var e,n=arguments.length,t=new Array(n),o=0;o<n;o++)t[o]=arguments[o];(e=BeFunky).logFeature.apply(e,["service_worker"].concat(t))}function ra(e,n){n.installing||n.waiting!==e||ua(e).then(function(t){if(n.installing||n.waiting!==e)oa("Aborted update to version ".concat(t),aa(n));else if(t!==BeFunky.Params.serviceWorkerVersion)oa("Ready to update to version ".concat(t," if it's the latest"),aa(n)),ia(n).then(function(){n.installing||n.waiting!==e||BeFunky.isInstalled()&&(oa("Showing reload toast for ".concat(t),aa(n)),Zr=BeFunky.showToast({message:"new_version_available",button:"refresh",onAccept:function(){n.waiting?sa(n.waiting,n):n.active===e?(oa("Reloading page after SW activated in different tab... "),ca()):BeFunky.throwError("Unexpected SW state")},onDismiss:function(){oa("Dismissed service worker update")}}))});else{oa("Activating version ".concat(t," since it matches page"),aa(n)),Zr();setTimeout(function(){sa(e,n,!1)},1e3)}})}function aa(e){return{installing:!!e.installing&&(e.installing.version||!0),waiting:!!e.waiting&&(e.waiting.version||!0),active:!!e.active&&(e.active.version||!0)}}function ia(e,n){var t="number"!=typeof n;return oa(t?"Checking for updated SW once":"Polling for updated SW every ".concat(n/1e3,"s")),o();function o(){return r(1),e.update().catch(function(n){BeFunky.logError("Unable to check for new SW",n,aa(e))}).then(function(){r(-1),t||setTimeout(function(){oa("Polling for new SW..."),requestIdleCallback(o)},n)})}function r(n){Qr+=n,ea(e)}}function sa(e,n){arguments.length>2&&void 0!==arguments[2]&&!arguments[2]?e.postMessage({type:"SKIP_WAITING"}):(BeFunky.showLoadScreen(),BeFunky.whenOnline().then(function(){e.postMessage({type:"SKIP_WAITING"});var t=!1;navigator.serviceWorker.addEventListener("controllerchange",function(){oa("New service worker activated",aa(n)),BeFunky.hideLoadScreen(),t||(t=!0,ca())}),setTimeout(function(){t||(t=!0,BeFunky.reportWarning("SKIP_WAITING timed out after 5s",aa(n)),ca())},5e3)}))}function ua(e){return e.version?Promise.resolve(e.version):function(e,n){return new Promise(function(t){var o=new MessageChannel;o.port1.onmessage=function(e){t(e.data)},e.postMessage(n,[o.port2])})}(e,{type:"GET_VERSION"}).then(function(n){return n.version||BeFunky.throwError("Unable to get service worker version",n),e.version=n.version,n.version})}function ca(){if(window.BFN&&BFN.ProjectManager&&!BFN.ProjectManager.isFullyAutoSaved()){var e="padding: 0 4px; border: 1px solid; border-radius: 3px; opacity: 0.8; margin: 0 2px;".concat(BeFunky.isMac?"":"letter-spacing: -0.5px;");BeFunky.acknowledge(["save_then_refresh",{shortcut:'<string style="'.concat(e,'">').concat((n="R",[BeFunky.isMac?"":"Ctrl"].concat(w(n.split(""))).join(BeFunky.isMac?"":"".concat("","+").concat(""))),"</string>")}])}else oa("Reloading page..."),window.location.reload();var n}function la(){window.Sentry&&Sentry.configureScope(function(e){e.setTag("sw",BeFunky.usingServiceWorker())})}function da(){window.Sentry&&Sentry.configureScope(function(e){e.setTag("installed",!!BeFunky.isInstalled()&&"pwa")}),BeFunky.isInstalled()&&BeFunky.onDocumentReady(function(){!function(){[document.querySelector(".site-nav__item--logo"),document.querySelector(".site-footer__logo")].filter(Boolean).forEach(function(e){e.href=BeFunky.Params.pwaStartUrl});var e=document.querySelector(".site-footer__link[data-lang=visionn]");e&&e.setStyles({display:"none"})}()})}ta.addEventListener?ta.addEventListener("change",da):ta.addListener(da),da(),"serviceWorker"in navigator&&(navigator.serviceWorker.addEventListener("controllerchange",la),la(),window._onLoad(function(){var e=window.location.search.includes("service_worker=true"),n=window.location.search.includes("service_worker=false"),t=BeFunky.isInstalled(),o=window.location.hostname.startsWith("staticdev"),r=BeFunky.randomIntForUser()<=50;if(e||t||o||r||BeFunky.usingServiceWorker())return n?(r&&BeFunky.setLocal("random-1-100","99"),navigator.serviceWorker.getRegistrations().then(function(e){Promise.all(e.map(function(e){return e.unregister()})).then(function(){oa("Successfully unregistered ".concat(e.length," service worker(s)")),window.location.href=window.location.href.replace(/([?&])service_worker=false&?/,"$1")})})):void BeFunky.waitUntil({condition:function(){return BeFunky.webGLDetectionComplete},onSuccess:function(){window.webgl_is_supported&&navigator.serviceWorker.register("".concat(BeFunky.Params.siteUrl,"service-worker.js")).then(function(e){oa("Registration",aa(e)),window.swReg=e,e.addEventListener("updatefound",function(){!function(e,n){e.addEventListener("statechange",function t(o){"installed"===o.target.state&&(e.removeEventListener("statechange",t),ra(e,n))})}(e.installing,e),e.installing.addEventListener("statechange",function(){return na(e)})}),e.waiting&&(ra(e.waiting,e),e.waiting.addEventListener("statechange",function(){return na(e)})),e.active&&!BeFunky.usingServiceWorker()&&(oa("Asking to be claimed after hard refresh"),e.active.postMessage({type:"CLAIM_CLIENTS"})),setTimeout(function(){return ia(e,Kr)},Kr),na(e)}).catch(function(e){BeFunky.throwError("Unable to register service worker",e)})},onTimeout:function(){BeFunky.throwError("Unable to register service worker b/c WebGl detection timed out")},interval:200,maxAttempts:50})}),window.addEventListener("beforeinstallprompt",function(e){e.preventDefault(),BeFunky.beforeInstallPromptEvent=e}));var ga=function(){function e(){r(this,e),this.init()}return i(e,[{key:"init",value:function(){this.initDefaultValues()}},{key:"initDefaultValues",value:function(){this.modal=null}},{key:"openProjectModal",value:function(){this.modal=this.modal||BeFunky.createProjectManagerModal(),this.modal.open()}},{key:"openUserSavedProject",value:function(e,n){var t=this,o=BeFunky.getModal("project_manager"),r=o&&o.isVisible;return BFN.SavedProjectService.fetchBFD(e.fileurl).then(function(o){r&&BeFunky.closeModal("project_manager");var a=e.filename?e.filename.replace(/\.bfd$/i,""):void 0;return BFN.ProjectManager.openProject(o,{filename:a,source:"befunky",thumbnail:n||t.getThumbURL(e,308)})}).catch(function(e){return r&&t.openProjectModal(),Promise.reject(e)})}},{key:"getThumbURL",value:function(e,n){if(!e.thumburl)return BeFunky.throwError("User-saved project missing thumburl",e),"";var t,o={auto:"webp",width:(t=n*(BeFunky.isRetina()?1.5:1),50*Math.ceil(t/50))};return BeFunky.addParamsToURL(e.thumburl,o)}}]),e}();BeFunky.SavedProjectManager=new ga;var pa={37:"left",39:"right",38:"up",40:"down"},fa=[];function ha(e){if(!BeFunky.isLoadScreenActive()){var n=pa[e.keyCode];if(n){var t=document.activeElement;if(t){var o=fa.find(function(e){return(0,e.condition)(t)});o&&(o.callback(t,n,e)||(e.stopImmediatePropagation(),e.preventDefault()))}}}}BeFunky.addArrowKeyHandler=function(e){"function"==typeof e.callback&&"function"==typeof e.condition?fa.includes(e)||fa.push(e):BeFunky.throwError("invalid arrow key handler",e)},BeFunky.removeArrowKeyHandler=function(e){"function"==typeof e.callback&&"function"==typeof e.condition?fa.includes(e)&&fa.splice(fa.indexOf(e),1):BeFunky.throwError("invalid arrow key handler",e)},document.addEventListener("keydown",ha),document.addEventListener("keyup",ha);var ma=function(){function e(){r(this,e),this.imagesPerPage=50,this.resetImageData()}return i(e,[{key:"resetImageData",value:function(){this.imageData={totalImages:null,fetchedImages:[],startPhotos:0,startLayers:0}}},{key:"getPhotosAndLayers",value:function(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1?arguments[1]:void 0;if(!BeFunky.isLoggedIn())return t({error:"not_logged_in"});var o=this.imageData,r=o.totalImages,a=o.fetchedImages,i=n*this.imagesPerPage>a.length&&r>a.length;if(null==r||i)return this.getImagesFromAPI({startPhotos:this.imageData.startPhotos,startLayers:this.imageData.startLayers},function(o){var r=o.error,i=o.data,s=o.totalImages,u=o.startPhotos,c=o.startLayers;if(r)return t({error:r});e.imageData={totalImages:s,fetchedImages:a.concat(i),startPhotos:u,startLayers:c},e.getPhotosAndLayers(n,t)});var s=(n-1)*this.imagesPerPage,u=s+this.imagesPerPage;return t({data:a.slice(s,u),totalPages:Math.ceil(r/this.imagesPerPage)})}},{key:"getImagesFromAPI",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.startPhotos,t=void 0===n?0:n,o=e.startLayers,r=void 0===o?0:o,a=arguments.length>1?arguments[1]:void 0,i={start_images:t,start_layers:r,end:100};BeFunky.requestAPI("photo/library-images",i).then(function(e){var n=e.data,t=e.total,o=e.start_images,r=e.start_layers;if(!Array.isArray(n)||"number"!=typeof t||"number"!=typeof o||"number"!=typeof r)throw"invalid_response";if(0===n.length)throw"no_results";var i=n.map(function(e){var n="befunky_layers"===e.type?"befunky_layer":"befunky_photo",t=e.url.endsWith(".png");return{id:"".concat(n,"_").concat(e.id),date:e.dateCreated,imageURL:e.url,isTransparent:t,thumbURL:e.thumb_url,thumbWidth:200,thumbHeight:200,title:e.title}});return a({data:i,totalImages:t,startPhotos:o,startLayers:r})}).catch(function(e){return a({error:e})})}}]),e}();BeFunky.ImagesService=new ma;var ya=function(){function e(){r(this,e),this.facebookAppID="120991377944644",this.scopes="email,public_profile,user_photos",this.fields="id,name,email,gender,birthday",this.hasInitialized=!1,this.onInitResolvers=[],this.hasBeenAuthorized=!1}return i(e,[{key:"loadSDK",value:function(){var e=this;if(this.hasInitialized)return Promise.resolve();var n=new Promise(function(n,t){e.onInitResolvers.push({resolve:n,reject:t})});return document.getElementById("facebook-jssdk")||BeFunky.onDocumentReady(function(){var n=document.createElement("div");n.id="fb-root",document.body.appendChild(n),window.fbAsyncInit=function(){FB.init({appId:e.facebookAppID,cookie:!0,version:"v9.0"}),e.hasInitialized=!0,e.onInitResolvers.forEach(function(e){return(0,e.resolve)()})},function(e,n,t){var o=this;if(!e.getElementById(t)){var r=e.createElement(n),a=e.getElementsByTagName(n)[0];r.id=t,r.src="https://connect.facebook.net/en_US/sdk.js",r.onerror=function(){BeFunky.logError("Failed to load Facebook SDK".concat(BeFunky.isFirefox?" b/c Firefox Private browsing":"")),o.onInitResolvers.forEach(function(e){return(0,e.reject)("sdk_did_not_load")}),o.onInitResolvers=[],r.parentNode.removeChild(r)},a.parentNode.insertBefore(r,a)}}.call(e,document,"script","facebook-jssdk")}),n}},{key:"getAccessToken",value:function(e){var n=this,t=this.scopes;if(e&&!t.split(",").includes(e))throw new Error("Unsupported scope: ".concat(e));return this.loadSDK().then(function(){return new Promise(function(e,n){if("https:"!==window.location.protocol)return BeFunky.logError("FB.getLoginStatus not called b/c this is a non-SSL page"),n("unknown");FB.getLoginStatus(function(n){var t=n.status,r=n.authResponse;if("connected"===t)return e({accessToken:r.accessToken});e(o())},!0)})}).then(function(t){return n.hasBeenAuthorized=!0,e&&!Array.isArray(t.grantedScopes)?new Promise(function(e,n){FB.api("/me/permissions",function(t){if(Array.isArray(t.data)){var o=t.data.filter(function(e){var n=e.status;return"granted"===n}).map(function(e){var n=e.permission;return n}).join(",");return console.log("Granted scopes:",o),e(o)}var r;try{r=JSON.stringify(t)}catch(e){}BeFunky.throwError("Unable to get granted scopes from FB API",r||t),n("invalid_response")})}).then(function(e){return{accessToken:t.accessToken,grantedScopes:e}}):t}).then(function(n){return e&&!r(n.grantedScopes)?new Promise(function(n,t){var a="facebook_access_".concat(e);BeFunky.LanguageManager.isTranslated(a)||(a="Please allow BeFunky to access your Facebook ".concat(e.replace(/_/g," "),".")),BeFunky.confirm(a,{onConfirm:function(){o(!0).then(function(o){if(r(o.grantedScopes))return n(o);t("".concat(e,"_scope_declined"))}).catch(t)},onCancel:function(){t("".concat(e,"_scope_declined"))},confirmText:"continue"})}):n});function o(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n={scope:t,return_scopes:!0};e&&(n.auth_type="rerequest");var o=!1,r=function(){o=!0};return new Promise(function(e,t){window.addEventListener("blur",r),i();var a=setTimeout(function(){o||BeFunky.acknowledge(["browser_block_social_login",{provider:"Facebook"}],{onAcknowledge:i,buttonText:"try_again"})},200);function i(){FB.login(function(n){var o=n.status,i=n.authResponse;if(window.removeEventListener("blur",r),clearTimeout(a),"connected"===o){var s=i.accessToken,u=i.grantedScopes;return e({accessToken:s,grantedScopes:u})}return t(o)},n)}})}function r(n){return n.split(",").includes(e)}}},{key:"getAccessTokenForFlash",value:function(e){this.getAccessToken(e).then(function(e){var n=e.accessToken;document.getElementById(BeFunky.Params.swfId).getAccessTokenForFlash(n)},function(e){BeFunky.logError("Unable to get Facebook access token for Flash",e),document.getElementById(BeFunky.Params.swfId).getAccessTokenForFlash(null)})}},{key:"getUserData",value:function(){var e=this;return this.getAccessToken("email").then(function(n){var t=n.accessToken;return new Promise(function(n,o){FB.api("/me",{fields:e.fields},function(e){if(e.error)return o(e.error);e.access_token=t,n(e)})})})}},{key:"loginWithFacebook",value:function(){return this.getUserData().then(function(e){return e.email&&e.email.length?BeFunky.handleSocialLogin("facebook",e):(BeFunky.confirm("facebook_email_login_failed",{onConfirm:function(){BeFunky.openLoginPanel("REGISTER",BeFunky.LoginPanelObj.isLoggedInNextFunction)},onCancel:function(){window.open("https://www.facebook.com/","_blank")},confirmText:"register_with_email",cancelText:"go_to_facebook"}),Promise.reject("missing_email"))})}},{key:"getPhotoAlbums",value:function(){return this.getAccessToken("user_photos").then(function(t){var o=t.accessToken;return new Promise(function(t,r){var a=["fields=albums.fields(name,photos.fields(picture,images).limit(100))","access_token=".concat(o)],i="https://graph.facebook.com/v3.2/me?".concat(a.join("&"));BeFunky.request(i,{headers:{"Content-Type":"application/x-www-form-urlencoded"}},function(o){var a=o.response,i=o.error;if(i)return r(i);if(!a||!a.albums||!Array.isArray(a.albums.data))return r("invalid_response");var s=a.albums.data.filter(function(e){var n=e.photos;return n&&n.data&&n.data.length});if(!s.length)return r("no_results");var u=s.map(function(e){var t=e.id,o=e.name,r=e.photos,a={id:t,name:o,nextPageURL:r.paging.next};return a.images=r.data.map(n).filter(Boolean),a});t(Promise.all(u.map(e)))})})},function(e){return BeFunky.logError("Unable to get Facebook access token:",e),Promise.reject("invalid_access_token")});function e(t){return t.nextPageURL?new Promise(function(o){BeFunky.request(t.nextPageURL,{},function(r){var a=r.response,i=r.error;return!i&&a&&Array.isArray(a.data)?(t.images=[].concat(w(t.images),w(a.data.map(n).filter(Boolean))),t.nextPageURL=a.paging.next,o(e(t))):(BeFunky.throwError("Unable to get next page of Facebook album results",{error:i,response:a}),o(t))})}):t}function n(e){if(e&&e.images&&e.images.length){var n=e.images.slice().sort(function(e,n){return e.width>n.width?1:-1}),t=n[n.length-1],o=n.find(function(e){return e.height>=275})||t;return{id:"facebook_".concat(e.id),imageURL:t.source,imageWidth:t.width,imageHeight:t.height,thumbURL:o.source,thumbWidth:o.width,thumbHeight:o.height}}}}}]),e}();BeFunky.FacebookAuth=new ya;var va=function(){function e(){r(this,e),this.init()}return i(e,[{key:"init",value:function(){this.initDefaultValues()}},{key:"initDefaultValues",value:function(){}},{key:"isValid",value:function(e,n){var t={autosave:function(e){return["yes","no","ask"].includes(e)},language:function(e){return BeFunky.LanguageManager.appLanguages.includes(e)},artsy_fav:function(e){return Array.isArray(e)&&e.every(function(e){return"string"==typeof e})},effects_fav:function(e){return Array.isArray(e)&&e.every(function(e){return"string"==typeof e})},texture_fav:function(e){return Array.isArray(e)&&e.every(function(e){return"string"==typeof e})},batch_processing_fav:function(e){return Array.isArray(e)&&e.every(function(e){return"string"==typeof e})},fonts_fav:function(e){return Array.isArray(e)&&e.every(function(e){return"string"==typeof e})},fonts_added:function(e){return Array.isArray(e)&&e.every(function(e){return e.type&&e.name&&(e.weights||e.weight&&e.fileName)})},watermarks:function(e){return Array.isArray(e)&&e.every(function(e){return e&&"object"===o(e)})},use_case:function(e){return"string"==typeof e},snapping:function(e){return["yes","no"].includes(e)},display_distances:function(e){return["yes","no"].includes(e)},guides:function(e){return["yes","no"].includes(e)},dismissed_messages:function(e){return Array.isArray(e)&&e.every(function(e){return"string"==typeof e})},trialing:function(e){return["trialing","plus","free",""].includes(e)}};return t[e]?Boolean(t[e](n)):null}},{key:"validateSettings",value:function(e){var n=this,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r={},a=t?"fetched from API":"specified by client";return e&&"object"===o(e)?(Object.entries(e).forEach(function(t){var o=k(t,2),i=o[0],s=o[1],u=n.isValid(i,s);null!==u?u?r[i]=e[i]:BeFunky.throwError("Invalid settings ".concat(a,". id = ").concat(i,", value = ").concat(s," (").concat(BeFunky.getType(s),")")):BeFunky.logError('Unrecognized Setting "'.concat(i,'" ').concat(a))}),r):(BeFunky.throwError("Invalid settings ".concat(a,". settings type = ").concat(BeFunky.getType(e))),r)}},{key:"getUserSettings",value:function(e){var n=this,t=function(t){var o;if(""===t?(BeFunky.logError("No settings fetched from API"),o={}):o=n.validateSettings(t,!0),"flash"!==e)e({settings:o});else try{var r=JSON.stringify({data:t});document.getElementById(BeFunky.Params.swfId).flash_getUserSettingsHandler(r)}catch(e){console.log("Flash calling error get-user-options: ",e)}};window.initialUserStatus.then(function(){window.latestUserData.options?t(window.latestUserData.options):BeFunky.requestAPI("auth/get-user-options").then(function(e){if("object"!==o(e.data))throw"invalid_response";t(e.data)}).catch(function(n){if("flash"!==e)e({error:n});else try{document.getElementById(BeFunky.Params.swfId).flash_getUserSettingsHandler("error")}catch(e){console.log("Flash calling error get-user-options: ",e)}})})}},{key:"updateSetting",value:function(e,n){var t=this;return new Promise(function(o,r){if(window.BFN&&BFN.SettingsManager)return BFN.SettingsManager.updateSetting(e,n),o();t.updateUserSettings(s({},e,n),function(e){var n=e.error;n?r(n):o()})})}},{key:"updateUserSettings",value:function(e,n){var t=this.validateSettings(e,!1);if(!Object.keys(t).length)return n({error:"No valid settings provided"});var o=JSON.stringify({data:t}),r=btoa(encodeURIComponent(o));BeFunky.requestAPI("auth/update-user-options",{data:r}).then(function(e){if("success"!==e.data)throw"invalid_response";if("flash"!==n){if(BeFunky.isLoggedIn())try{Object.keys(t).includes("use_case")&&void 0!==t.use_case&&t.use_case.length>0&&void 0!==window.bfn_mp&&0!==window.bfn_mp.identifier&&"undefined"!=typeof mixpanel&&mixpanel.people.set({"Use Case":t.use_case})}catch(e){}window.latestUserData.options&&Object.assign(window.latestUserData.options,t),n({success:!0})}else try{document.getElementById(BeFunky.Params.swfId).flash_updateUserSettingsHandler("success")}catch(e){console.log("Flash calling error get-user-options: ",e)}}).catch(function(e){if("flash"!==n)n({error:e});else try{document.getElementById(BeFunky.Params.swfId).flash_updateUserSettingsHandler("error")}catch(e){console.log("Flash calling error get-user-options: ",e)}})}}]),e}();BeFunky.SettingsService=new va;var _a=function(){function e(){r(this,e),this.init()}return i(e,[{key:"init",value:function(){this.resetProjectData()}},{key:"resetProjectData",value:function(){this.projectData={allProjectsFetched:!1,totalProjects:null,fetchedProjects:[]}}},{key:"getFirst100Projects",value:function(){var e=this,n=this.projectData,t=n.allProjectsFetched,o=n.fetchedProjects;return t||o.length>=100?Promise.resolve(o.slice(0,100)):BeFunky.requestAPI("photo/projects/get",{start:0,end:100}).then(function(n){var t=n.data,o=parseInt(n.total);return Array.isArray(t)?o&&t.length?(o<=100?(e.projectData.allProjectsFetched=!0,e.projectData.fetchedProjects=t,e.projectData.totalProjects=o):e.projectData.fetchedProjects.length||(e.projectData.allProjectsFetched=!1,e.projectData.fetchedProjects=t,e.projectData.totalProjects=o),t):Promise.reject("no_results"):Promise.reject("invalid_response")})}},{key:"getAllProjects",value:function(){var e=this,n=this.projectData,t=n.allProjectsFetched,o=n.fetchedProjects;return t?Promise.resolve(o):BeFunky.requestAPI("photo/projects/get",{all:1}).then(function(n){var t=n.data,o=parseInt(n.total);return Array.isArray(t)?o&&t.length?(e.projectData.fetchedProjects=t,e.projectData.allProjectsFetched=!0,e.projectData.totalProjects=o,t):Promise.reject("no_results"):Promise.reject("invalid_response")})}},{key:"searchProjects",value:function(e){var n={all:1,keyword:e};return BeFunky.requestAPI("photo/projects/get",n).then(function(e){var n=e.data,t=parseInt(e.total);return Array.isArray(n)?t&&n.length?n:Promise.reject("no_results"):Promise.reject("invalid_response")})}},{key:"deleteBfdFile",value:function(e,n){var t=this;if(!BeFunky.isLoggedIn())return n({error:"not_logged_in"});var o={template:e};BeFunky.requestAPI("photo/projects/delete",o).then(function(o){if("success"!==o.data)throw"invalid_response";var r=t.projectData.fetchedProjects.findIndex(function(n){return n.id===e});-1!==r&&(t.projectData.fetchedProjects.splice(r,1),t.projectData.totalProjects&&t.projectData.totalProjects--),n({data:"success"})}).catch(function(e){n({error:e})})}}]),e}();function ka(){var e=_(["<li>","</li>"]);return ka=function(){return e},e}function wa(){var e=_(["\n        <p>","</p>\n        <ul>\n            ","\n        </ul>\n        <p>","</p>\n    "]);return wa=function(){return e},e}function ba(){var e=_(['<div class="image-gallery image-library__gallery"></div>']);return ba=function(){return e},e}function Fa(){var e=_(['\n        <div class="image-library__right-panel">\n            ',"\n        </div>\n        "]);return Fa=function(){return e},e}function Ba(){var e=_(['<span class="loading-spinner"></span>']);return Ba=function(){return e},e}function Ea(){var e=_(["\n            <button @click=",' class="','">\n                <string>',"</string>\n                ","\n            </button>"]);return Ea=function(){return e},e}function La(){var e=_(['\n        <div class="image-library__albums">\n            ',"\n        </div>"]);return La=function(){return e},e}function Ia(){var e=_(["\n        <button @click="," class=",">\n            <string>","</string>\n            ","\n        </button>\n        ","\n        "]);return Ia=function(){return e},e}function Sa(){var e=_(['<div class="image-library__left-panel">',"</div>"]);return Sa=function(){return e},e}function Pa(){var e=_(['<div class="panel-header"></div>']);return Pa=function(){return e},e}function Ca(){var e=_(["\n            ",'\n            <div class="modal__body image-library__body">\n                ',"\n                ","\n            </div>\n        "]);return Ca=function(){return e},e}function xa(){var e=_(['<div id="image_library" class=',"></div>"]);return xa=function(){return e},e}BeFunky.SavedProjectFetcher=new _a,window._onLoad(function(){if(navigator.cookieEnabled){var e=window.getCookie("new_country");e&&(BeFunky.requestAPI("auth/update-country",{iso:e}).then(function(e){"success"!==e.data&&BeFunky.logError("Unable to update user country",e),window.setCookie("new_country","",-1)}).catch(function(e){BeFunky.logError("Unable to update user country",e)}),"US"===e&&(BeFunky.isNewUserInUSA=!0),BeFunky.getFreeTrialEnabled()||"US"===e&&["/features/collage-maker/","/features/crop-photo/","/features/background-remover/"].includes(BeFunky.initialRoute.split(/[?#]/)[0])&&BeFunky.Params.canUseWebapp&&(Xt(),bf_eventTrack("ONBOARDING_7DAY_TRIAL","TRIAL OFFERED",function(e){return e.split(/[?#]/)[0].split("/").filter(Boolean).pop()}(BeFunky.initialRoute))))}}),BeFunky.openThankYouPanel=function(e){BeFunky.openNebulaDialog({heading:"thank_you_heading",body:["thank_you_body",{collection_of_tutorials:BeFunky.toLinkHTML("".concat(BeFunky.Params.blogUrl,"tutorials/"),!0)}],buttons:[{href:"".concat(BeFunky.Params.blogUrl,"welcome-befunky-plus/"),text:"learn_more",type:["dark-blue"],focusInitially:!0}],imageUrl:"".concat(BeFunky.Params.globalImagesPath,"site/modals/card-confetti.jpg"),modalOptions:{addCloseButton:!0,onClose:e}})},BeFunky.openWelcomePanel=function(){var e,n=BeFunky.lit,t=n.html,o=n.modalLang,r=(e={default:["pricing_modal_background_heading","pricing_modal_cutout_heading","pricing_modal_batch_heading","welcome_features_cartoons"],collage:["welcome_collage_1","welcome_collage_2","welcome_features_graphics"],designer:["welcome_designer_1","welcome_designer_2","welcome_features_graphics"]},window.BFN&&BFN.AppModel&&BFN.AppModel.viewingCollage?e.collage:window.BFN&&BFN.AppModel&&BFN.AppModel.viewingDesigner?e.designer:e.default);BeFunky.openNebulaDialog({heading:"welcome_heading",body:function(){return t(wa(),o("welcome_features"),r.map(function(e){return t(ka(),o(e))}),o("welcome_upgrade"))},buttons:[{text:"learn_more",type:["dark-blue"],focusInitially:!0,onClick:function(){return BeFunky.openUpgradePanel(void 0,!0)}}],imageUrl:"".concat(BeFunky.Params.globalImagesPath,"site/modals/confetti.jpg"),modalOptions:{addCloseButton:!0}})};var Ta=BeFunky.lit,Aa=Ta.html,Ra=Ta.setupState,Ma=Ta.render,Ua=(Ta.lang,Ta.elem),Da=Ta.icon;BeFunky.imageLibraryModal=function(e){var n,t=e.imageSelectionHandler,o=e.isSelected,r=e.transformImageObject,a=void 0===r?function(e){return e}:r,i=e.extendItem,u=e.onClose,c=e.initialMode,l=Ua(xa(),"modal image-library ".concat(U(c))),d=1600,g=1300,p={mode:c,currentSection:"befunky",albums:{befunky:[],facebook:[],google:[]}},f=BeFunky.debounce(function(){Ma(function(){n&&l.removeClass(U(n[0])).addClass(U(n[1]));return Aa(Ca(),b,(e=[{section:"befunky",name:"BeFunky"},{section:"facebook",name:"Facebook",albums:y.albums.facebook},{section:"google",name:"Google Photos",albums:y.albums.google}],Aa(Sa(),e.map(B))),Aa(Fa(),L(y.currentSection).gallery));var e}(),l)},"raf"),h=Ra(p,function(e){if(n=e.mode,e.currentSection&&C(e.currentSection[0]),e.albums){var t=Boolean(e.currentSection);if(!t){var o=k(e.albums.map(function(e){return e[y.currentSection].find(function(e){return e.isSelected})}),2),r=o[0],a=o[1];!a||r&&r.id===a.id||(t=!0)}E(t)}f()}),m=k(h,2),y=m[0],v=m[1];BeFunky.LanguageManager.addLanguageUpdateListener(f);var _,b=(_=Ua(Pa()),BeFunky.panelHeader(_,{name:"image_library",closeEnabled:!0,modifier:"modal"}),_),F=function(){var e=[{section:"befunky",gallery:n({imagesPerRow:7,emptyState:{text:"login_load_images",icon:"images-icon",buttonText:"sign_in",buttonAction:T}})},{section:"facebook",gallery:n({imagesPerRow:6,emptyState:{text:"connect_facebook_load_albums",icon:"images-icon",buttonText:"connect_facebook",buttonAction:A}})},{section:"google",gallery:n({imagesPerRow:6,emptyState:{text:"connect_google_load_albums",icon:"images-icon",buttonText:"connect_google_photos",buttonAction:R}})}];return e.forEach(function(e){Object.assign(e,BeFunky.setupInfiniteScroll(function(){return e.gallery},{threshold:400}))}),e;function n(e){var n=e.imagesPerRow,r=e.emptyState,a=Ua(ba());return BeFunky.imageGallery(a,{imagesPerRow:n,maxWidth:g,imageSelectionHandler:t,isSelected:o,extendItem:i}),a.emptyState=r,a}}();return Object.assign(l,{open:function(e){BeFunky.openModal(l,{onOpen:function(){e&&e!==y.currentSection?v({currentSection:e}):C()},onClose:function(){"function"==typeof u&&u()},onWindowResize:M,size:"xxl"})},close:function(){BeFunky.closeModal(l)},selectGalleryItem:function(e){var n=document.getElementById("image_gallery_item--".concat(e));n&&(n.selected=!0)},deselectGalleryItem:function(e){var n=document.getElementById("image_gallery_item--".concat(e));n&&(n.selected=!1)},getGallery:L,setState:v}),l;function B(e){var n=e.section,t=e.name,o=e.albums;return Aa(Ia(),function(){v({currentSection:n})},"button button--list button--large button--arrow image-library__tab ".concat(n===y.currentSection?"image-library__tab--selected":""),t,Da("global-arrow-down-icon"),y.currentSection===n&&o?function(e,n){return Aa(La(),n.map(function(n){var t="button button--list image-library__album ".concat(n.isSelected?"image-library__album--selected":"");return Aa(Ea(),function(){return function(e,n){if(n.isSelected)return;var t=x(e);D(e,y.albums[e].map(function(e){return e===n?Object.assign({},e,{isSelected:!0}):e===t?Object.assign({},e,{isSelected:!1}):e}))}(e,n)},t,n.name,n.isLoading?Aa(Ba()):"")}))}(n,o):"")}function E(e){var n=y.currentSection,t=y.albums[n]||[];if(t.length){var o=t.find(function(e){return e.isSelected});if(o){var r=o.page,a=o.images,i=o.staggerImageLoading,s=o.scrollPosition,u=o.isLoading,c=o.message,l=o.emptyState,d=o.loadNextPageOfImages,g=L(n),p=g.gallery,f=g.listenForScroll,h="google"===n?30:50;if(a.length||(p.emptyState=l),p.message=c,p.isLoading=u,p.staggerLoading=i,!u||e){p.images=a.slice(0,r*h);var m=0;e&&(p.scrollTop=s,s&&requestAnimationFrame(function e(){m++;if(m>2)return;o.isSelected&&0!==s&&0===p.scrollTop&&(p.getBoundingClientRect().height?(console.log("Fixed scroll position"),p.scrollTop=s):requestAnimationFrame(e))})),r*h<a.length?(o.staggerImageLoading=!0,f(function(){return!o.isSelected},function(){o.page++,E(!1)})):!d||u||c||l||d(o)}}}}function L(e){return F.find(function(n){return n.section===e})}function I(){D("befunky",[{id:"DEFAULT",name:"",page:1,images:[],staggerImageLoading:!0,scrollPosition:0,isSelected:!0,isLoading:!1,message:"",emptyState:"",nextAPIPage:1,loadNextPageOfImages:function e(n){var t=n.nextAPIPage,o=n.id;O("befunky",o,{isLoading:!0,message:"",images:1===t?[]:n.images});BeFunky.ImagesService.getPhotosAndLayers(t,function(r){var i=r.data,s=r.totalPages,u=r.error;if(u)return 1===t&&"no_results"===u?O("befunky",o,{isLoading:!1,emptyState:{text:"no_befunky_photos",icon:"images-icon"}}):(BeFunky.logError("Unable to fetch BeFunky images",u),O("befunky",o,{isLoading:!1,message:{isError:!0,text:BeFunky.failureReason(u),buttonText:"try_again",buttonAction:function(){return e(n)}}}));var c=t<s;return O("befunky",o,{isLoading:!1,staggerImageLoading:!0,images:[].concat(w(n.images),w(i.map(a))),nextAPIPage:c?t+1:void 0,loadNextPageOfImages:c?e:void 0})})}}])}function S(){var e=L("facebook").gallery;e.images=[],e.isLoading=!0,e.message="",BeFunky.FacebookAuth.getPhotoAlbums().then(function(n){e.isLoading=!1,D("facebook",n.map(function(e,n){return{id:e.id,name:e.name,page:1,images:e.images.map(a),staggerImageLoading:!0,scrollPosition:0,isSelected:0===n,isLoading:!1,message:"",emptyState:""}}))},function(n){e.isLoading=!1,BeFunky.logError("Unable to fetch Facebook albums",n),e.message={isError:!0,text:BeFunky.failureReason(n),buttonText:"try_again",buttonAction:function(){return S()}}})}function P(){var e=L("google").gallery;e.images=[],e.message="",e.isLoading=!0;var n=Date.now();function t(e){O("google",e.id,{isLoading:!0,message:""});var n="all_photos"===e.id?BeFunky.GooglePhotosManager.getAllMedia(e.nextPageToken):BeFunky.GooglePhotosManager.getAlbumMedia(e.id,e.nextPageToken),o=Date.now();return n.then(function(n){var r=n.mediaItems,i=n.nextPageToken;console.log("Got ".concat(r.length," images from API in ").concat((Date.now()-o)/1e3,"s"),{nextPageToken:i});var s=BeFunky.GooglePhotosManager.mediaItemsToImageObjects(r).map(a);if(!s.length)throw"no_results";O("google",e.id,{isLoading:!1,staggerImageLoading:!0,images:[].concat(w(e.images),w(s)),nextPageToken:i,loadNextPageOfImages:i?t:void 0})}).catch(function(n){O("google",e.id,{isLoading:!1,message:{isError:!0,text:BeFunky.failureReason(n),buttonText:"try_again",buttonAction:function(){return t(e)}}})})}BeFunky.GooglePhotosManager.getAlbums().then(function(o){e.isLoading=!1,console.log("Got ".concat(o.length," albums from API in ").concat((Date.now()-n)/1e3,"s"));var r=function(e,n,o){return{id:e,name:n,page:1,images:[],staggerImageLoading:!0,scrollPosition:0,isSelected:o,isLoading:!1,message:"",emptyState:"",nextPageToken:void 0,loadNextPageOfImages:t}},a=o.filter(function(e){return e.title});D("google",[r("all_photos","All Photos",!1)].concat(w(a.map(function(e,n){return r(e.album_id,e.title,0===n)}))))},function(n){e.isLoading=!1,"cancelled_by_user"!==n&&(BeFunky.logError("Unable to fetch Google albums",n),e.message={isError:!0,text:BeFunky.failureReason(n),buttonText:"try_again",buttonAction:function(){return P()}})})}function C(e){var n=L(y.currentSection).gallery;e&&x(e),console.log("Entered ".concat(y.currentSection," tab")),{befunky:function(){if(BeFunky.isLoggedIn())return y.albums.befunky.length?null===BeFunky.ImagesService.imageData.totalImages?I():E(!0):void I()},facebook:function(){if(BeFunky.FacebookAuth.hasBeenAuthorized)return y.albums.facebook.length?E(!0):void(n.isLoading||S())},google:function(){if(y.albums.google.length)return E(!0)}}[y.currentSection]()}function x(e){var n=y.albums[e].find(function(e){return e.isSelected});if(n){var t=L(e).gallery;return n.scrollPosition=t.scrollTop,n.staggerImageLoading=!1,n}}function T(){BeFunky.isLoggedIn()?I():BeFunky.openLoginPanel("SIGNIN",T)}function A(){S()}function R(){BeFunky.GooglePhotosManager.mightBeAuthorized?P():BeFunky.GooglePhotosManager.login(!1).then(P,function(e){"cancelled_by_user"!==e&&BeFunky.throwError("Unable to authorize with Google Photos",e)})}function M(e){var n=e.availableWidth,t=g+(n-d);F.forEach(function(e){var n=e.gallery,o=e.recalculateScrollPosition;n.currentWidth=t,o()})}function U(e){var n=e.replace(/[^0-9a-z-]/gi,"-").replace(/-{2,}/g,"-").replace(/^-|-$/g,"").toLowerCase();return"image-library--mode-".concat(n)}function D(e,n){var t=Object.assign({},y.albums,s({},e,n));v({albums:t})}function O(e,n,t){D(e,y.albums[e].map(function(e){return e.id!==n?e:Object.assign({},e,t)}))}};var Oa=function(e,n){var t=Na(e);if(!t.firstElementChild){var o=document.createElement("div").addClass("form-errors__container");t.appendChild(o);var r=document.createElement("button").setClass("button button--icon button--tiny form-errors__close-button");r.innerHTML=BeFunky.getSvgHtml("global-cancel-icon",{classes:"icon icon-size-medium"}),r.addEventListener("click",function(){t.innerHTML=""}),t.appendChild(r)}var a=document.createElement("div");Array.isArray(n)?a.setLang.apply(a,w(n)):a.setLang(n),t.firstElementChild.appendChild(a)},ja=function(e){Na(e).innerHTML=""};function Na(e){return e instanceof HTMLElement?e.querySelector(".form-errors"):document.querySelector("".concat(e," .form-errors"))}BeFunky.LoginPanelObj={panelType:"SIGNIN",isLoggedInNextFunction:!1,closeNextFunction:!1};var Ha=BeFunky.getLocal("skip_captcha_token"),qa=!Ha;function Va(){var e={"Content-Type":"application/x-www-form-urlencoded","X-CSRF-Token":getCsToken(),"X-User-Email":window.latestUserData.email||""};return Ha&&(e["X-BeFunky-Skip-Captcha"]=Ha),e}function Wa(){var e=_(['<h2 class="h4">',"\n        </h2>"]);return Wa=function(){return e},e}function Ga(){var e=_(['\n        <div class="teaser-modal__video">\n            <video autoplay loop muted>\n                <source src=',' type="video/mp4">\n            </video>\n        </div>']);return Ga=function(){return e},e}function za(){var e=_(['<div class="teaser-modal__fade-in-image" style=',">"]);return za=function(){return e},e}function Xa(){var e=_(['\n            <div class="teaser-modal__image">\n                <div style="','">\n                ',"\n                </div>\n            </div>"]);return Xa=function(){return e},e}function Ja(){var e=_(['<div class="teaser-modal__fade-in-image" style=',">"]);return Ja=function(){return e},e}function $a(){var e=_(['\n            <div class="teaser-modal__image" style=',">\n                ","\n            </div>"]);return $a=function(){return e},e}function Ya(){var e=_(['\n            <p class="teaser-modal__sign-in">\n                <string>',"</string>\n                <a @click=",' href="#">',"</a>\n            </p>"]);return Ya=function(){return e},e}function Ka(){var e=_(["<a href=",' class="teaser-modal__learn-link button button--lg button--link" rel="noopener" target="_blank">',"</a>"]);return Ka=function(){return e},e}function Qa(){var e=_(["\n        ",'\n        <div class="teaser-modal__col-right">\n            ','\n            <p id="teaser_modal_body">','</p>\n            <div class="teaser-modal__buttons">\n                <button class='," @click=",">","</button>\n                ","\n            </div>\n            ","\n        </div>\n        "]);return Qa=function(){return e},e}function Za(){var e=_(['<div id="teaser_modal" class=',">"]);return Za=function(){return e},e}qa||console.log("Captcha disabled for testing"),BeFunky.registerComeFromUpgrade=!1,BeFunky.openLoginPanel=function(e,n,t){switch(BeFunky.LoginPanelObj.panelType=e,BeFunky.LoginPanelObj.isLoggedInNextFunction=n,e){case"SIGNIN":BeFunky.befunkyPopupContainerOpen("#sign_in_modal",{addCaptcha:qa}),BeFunky.FacebookAuth.loadSDK().catch(function(e){"sdk_did_not_load"===e&&BeFunky.isFirefox&&(document.getElementById("sign_in_modal_facebook").disabled=!0)});break;case"REGISTER":BeFunky.befunkyPopupContainerOpen("#register_modal",{addCaptcha:qa}),BeFunky.FacebookAuth.loadSDK().catch(function(e){"sdk_did_not_load"===e&&BeFunky.isFirefox&&(document.getElementById("register_modal_facebook").disabled=!0)});break;case"FORGETPASS":BeFunky.befunkyPopupContainerOpen("#reset_password_modal",{addCaptcha:qa})}},BeFunky.signinSubmit=function(){var e=document.getElementById("sign_in_form"),n=document.getElementById("sign_in_form_email"),t=document.getElementById("sign_in_form_password"),o=!1;ja(e),e.querySelectorAll(".form-field__input").removeClass("form-field__input--invalid");var r=n.value=n.value.trim();!1===window.isEmailAddress(r)&&(n.addClass("form-field__input--invalid"),o=!0),t.value.length<=2&&(t.addClass("form-field__input--invalid"),o=!0);var a="";if(qa&&""===(a=BeFunky.getCaptchaResponse())&&(BeFunky.executeCaptcha(BeFunky.signinSubmit),o=!0),!o){var i={userEmail:r,userPassBa:btoa(encodeURIComponent(t.value)),captcha_response:a};BeFunky.requestAPI("auth/login",i,{showLoadScreen:!0,headers:Va()}).then(function(e){BeFunky.onLoginSuccess(e.data)}).catch(function(e){if("already_logged_in"===e)return BeFunky.handleAlreadyLoggedInError(r).then(BeFunky.onLoginSuccess);throw e}).catch(function(n){if("different_user_logged_out"===n)return BeFunky.logError("Attempting sign in again now that existing user has been signed out"),BeFunky.signinSubmit();"string"==typeof n?BeFunky.logError("Unable to sign in user:",n):BeFunky.throwError(n,"Unable to sign in user"),qa&&BeFunky.renderOrResetCaptcha(e.querySelector(".captcha"));var t={invalid_token:"error_invalid_csrf_token",invalid_captcha:"error_captcha",request_failed:"error_request_failed",different_user_logged_in:["error_please_refresh",{contact_support:'<a href="https://support.befunky.com/hc/en-us/requests/new" target="_blank">'.concat(BeFunky.LanguageManager.getString("contact_support"),"</a>")}],invalid_email:"error_email_password"};Oa(e,t[n]||"error_invalid_response")})}},BeFunky.registerSubmit=function(){var e=document.getElementById("register_form"),n=document.getElementById("register_form_email"),t=document.getElementById("register_form_confirm_email"),o=document.getElementById("register_form_password"),r=!1;ja(e),e.querySelectorAll(".form-field__input").removeClass("form-field__input--invalid");var a=n.value=n.value.trim(),i=t.value=t.value.trim();!1===window.isEmailAddress(a)&&(n.addClass("form-field__input--invalid"),r=!0),i!==a&&(t.addClass("form-field__input--invalid"),r=!0),o.value.length<6&&(o.addClass("form-field__input--invalid"),r=!0);var s="";if(qa&&""===(s=BeFunky.getCaptchaResponse())&&(BeFunky.executeCaptcha(BeFunky.registerSubmit),r=!0),!r){var u={_email_:a,_email_again:i,_pass_ba_:btoa(encodeURIComponent(o.value)),captcha_response:s,em_effects:0,em_articles:1};BeFunky.requestAPI("auth/register",u,{showLoadScreen:!0,headers:Va()}).then(function(e){BeFunky.onLoginSuccess(e.data)}).catch(function(n){"string"==typeof n?BeFunky.logError("Unable to register user:",n):BeFunky.throwError(n,"Unable to register user"),qa&&BeFunky.renderOrResetCaptcha(e.querySelector(".captcha"));var t={invalid_token:"error_invalid_csrf_token",invalid_captcha:"error_captcha",request_failed:"error_request_failed",already_logged_in:["error_please_refresh",{contact_support:'<a href="https://support.befunky.com/hc/en-us/requests/new" target="_blank">'.concat(BeFunky.LanguageManager.getString("contact_support"),"</a>")}],invalid_email:"error_email_already_in_use"};Oa(e,t[n]||"error_invalid_response")})}},BeFunky.forgetPassSubmit=function(){var e=document.getElementById("reset_password_form"),n=document.getElementById("reset_password_form_email"),t=!1;ja(e),e.querySelectorAll(".form-field__input").removeClass("form-field__input--invalid");var o=n.value=n.value.trim();!1===window.isEmailAddress(o)&&(n.addClass("form-field__input--invalid"),t=!0);var r="";if(qa&&""===(r=BeFunky.getCaptchaResponse())&&(BeFunky.executeCaptcha(BeFunky.forgetPassSubmit),t=!0),!t){var a={_email_:o,captcha_response:r};BeFunky.requestAPI("auth/forget-pass",a,{showLoadScreen:!0,headers:Va()}).then(function(e){if("success"!==e.data)throw"invalid_response";BeFunky.acknowledge(["reset_password_email_sent",{email:"<strong>".concat(o,"</strong>")}],{onAcknowledge:function(){BeFunky.befunkyPopupContainerClose()},imageUrl:"".concat(BeFunky.Params.globalImagesPath,"site/illustrations/paper-plane.svg")})}).catch(function(n){BeFunky.logError("Unable to reset password:",n),"already_logged_in"===n&&BeFunky.throwError(n,"Unable to reset password"),qa&&BeFunky.renderOrResetCaptcha(e.querySelector(".captcha"));var t={invalid_token:"error_invalid_csrf_token",invalid_captcha:"error_captcha",request_failed:"error_request_failed",already_logged_in:["error_please_refresh",{contact_support:'<a href="https://support.befunky.com/hc/en-us/requests/new" target="_blank">'.concat(BeFunky.LanguageManager.getString("contact_support"),"</a>")}],operation_failed:"error_email_not_registered"};Oa(e,t[n]||"error_invalid_response")})}},BeFunky.ISNOT_FLASH_LOGGEDIN=!1,BeFunky.onLoginSuccess=function(e){if(window.updateUserStatus(e),BeFunky.isPlus()){void 0!==BeFunky.Params.pymntscspg&&null!=BeFunky.Params.pymntscspg&&(BeFunky.Params.pymntscspg=BeFunky.Params.pymntscspg.replace("?openThanks=1",""),window.location.href=BeFunky.Params.pymntscspg);try{window.flashFreeTop=0,window.flashFreeRight=0,window.isflashFreeRight=!1,window.reResizeFlashHeight()}catch(e){}}var n=BeFunky.LoginPanelObj.isLoggedInNextFunction;if("function"==typeof n){n(),BeFunky.LoginPanelObj.isLoggedInNextFunction=!1;var t=BeFunky.getModal();t&&["sign_in_modal","register_modal"].includes(t.modalID)&&BeFunky.closeModal(t.modalID)}else BeFunky.User.isNewUser?(BeFunky.befunkyPopupContainerClose(),BeFunky.openWelcomePanel()):(BeFunky.befunkyPopupContainerClose(),1===BeFunky.sessionRoutes.length&&BeFunky.Params.isHomepage&&window.location.href!==BeFunky.Params.pwaStartUrl&&BeFunky.Params.canUseWebapp&&BeFunky.isUseHTML5&&!window.onbeforeunload&&window.location.reload())},BeFunky.onDocumentReady(function(){try{!function(){function e(){BeFunky.loginWithGoogle()}function n(){BeFunky.showLoadScreen(),BeFunky.FacebookAuth.loginWithFacebook().catch(function(e){BeFunky.logError("Facebook login failed",e)}).then(function(){BeFunky.hideLoadScreen()})}document.getElementById("sign_in_modal_google").addEventListener("click",e),document.getElementById("sign_in_modal_facebook").addEventListener("click",n),document.getElementById("sign_in_form").addEventListener("submit",function(e){e.preventDefault(),BeFunky.signinSubmit()}),document.getElementById("sign_in_modal_create_account").addEventListener("click",function(e){e.preventDefault(),BeFunky.openLoginPanel("REGISTER",BeFunky.LoginPanelObj.isLoggedInNextFunction)}),document.getElementById("sign_in_modal_forgot_password").addEventListener("click",function(e){e.preventDefault(),BeFunky.openLoginPanel("FORGETPASS",BeFunky.LoginPanelObj.isLoggedInNextFunction)}),document.getElementById("register_modal_google").addEventListener("click",e),document.getElementById("register_modal_facebook").addEventListener("click",n),document.getElementById("register_form").addEventListener("submit",function(e){e.preventDefault(),BeFunky.registerSubmit()}),document.getElementById("register_modal_has_account").addEventListener("click",function(e){e.preventDefault(),BeFunky.openLoginPanel("SIGNIN",BeFunky.LoginPanelObj.isLoggedInNextFunction)}),document.getElementById("reset_password_form").addEventListener("submit",function(e){e.preventDefault(),BeFunky.forgetPassSubmit()}),document.getElementById("reset_password_modal_sign_in").addEventListener("click",function(e){e.preventDefault(),BeFunky.openLoginPanel("SIGNIN",BeFunky.LoginPanelObj.isLoggedInNextFunction)})}()}catch(e){window.location.href.includes("/index-ui.html")||BeFunky.throwError(e,"Unable to initialize sign-in, register & reset-password modals")}}),BeFunky.handleAlreadyLoggedInError=function(e){return BeFunky.logError('Handling "already_logged_in" API error'),BeFunky.setLocal("already_logged_in_error_time",Date.now()),BeFunky.requestAPI("auth/status",{},{showLoadScreen:!0}).catch(function(e){throw BeFunky.throwError("/status/ failed after already_logged_in sign-in error",e),e}).then(function(n){if(!n.data.email)throw BeFunky.logError("User data missing email: ",JSON.stringify(n.data)),"invalid_response";return e===n.data.email?n.data:(BeFunky.logError('Logging out existing user "'.concat(n.data.email,'" so that new user "').concat(e,'" can sign in')),BeFunky.callSignOutAPI().then(function(){return Promise.reject("different_user_logged_out")},function(){return Promise.reject("different_user_logged_in")}))})};var ei=BeFunky.lit,ni=ei.html,ti=ei.setupState,oi=ei.render,ri=ei.modalLang,ai=ei.elem;function ii(e,n){var t=n.onUpgrade,o=n.onSignIn,r=e.video?"modal teaser-modal teaser-modal--video":"modal teaser-modal teaser-modal--image",a=ai(Za(),r),i=!1,s={headingText:"",featureName:"",images:[],showSecondImage:!1,video:"",text:"",learnMoreLink:"",isLoggedIn:!1,imageAspectRatio:void 0},u=BeFunky.debounce(function(){return oi((e="button button--dark-blue ".concat(l.learnMoreLink?"button--lg":"button--xl"," teaser-modal__button"),ni(Qa(),l.video?ni(Ga(),l.video):function(){if(!l.imageAspectRatio)return ni($a(),"background-image: url(".concat(l.images[0],");"),l.images[1]?ni(Ja(),"background-image: url(".concat(l.images[1],"); opacity: ").concat(l.showSecondImage?1:0,";")):"");var e="position: absolute; ".concat(o(l.images[0]),";"),n=l.imageAspectRatio>1?100/l.imageAspectRatio:100*l.imageAspectRatio,t=l.imageAspectRatio>1?"width: 100%; height: ".concat(n,"%; left: 0; top: ").concat((100-n)/2,"%; ").concat(e):"height: 100%; width: ".concat(n,"%; top: 0; left: ").concat((100-n)/2,"%; ").concat(e);return ni(Xa(),t,l.images[1]?ni(za(),"".concat(o(l.images[1])," opacity: ").concat(l.showSecondImage?1:0,";")):"");function o(e){return"background: url(".concat(e,") no-repeat center, url('").concat(BeFunky.Params.globalImagesPath,"app/checker_pattern.jpg') repeat; background-size: cover, auto;")}}(),ni(Wa(),l.headingText?ri(l.headingText):ri(["teaser_modal_heading",{this_feature:function(){return BeFunky.LanguageManager.getString(l.featureName)}}])),ri(l.text),e,g,ri(BeFunky.getFreeTrialEnabled()?"start_trial":"upgrade_now"),l.learnMoreLink?ni(Ka(),l.learnMoreLink,ri("learn_more")):"",l.isLoggedIn?"":ni(Ya(),ri("teaser_modal_have_an_account"),p,ri("sign_in")))),a);var e},"raf"),c=k(ti(Object.assign({},s,e),u),2),l=c[0],d=c[1];return BeFunky.LanguageManager.addLanguageUpdateListener(u),2===l.images.length&&function(){function e(){requestAnimationFrame(function(){i||(d({showSecondImage:!l.showSecondImage}),setTimeout(e,4e3))})}Promise.all(l.images.map(f)).then(function(){i||setTimeout(e,1500)})}(),a.teardown=function(){i=!0,BeFunky.LanguageManager.removeLanguageUpdateListener(u)},a;function g(){t()}function p(e){e.preventDefault(),o()}function f(e){return new Promise(function(n,t){var o=new Image;o.onload=n,o.onerror=t,o.src=e})}}void 0===window.enableTeasers&&(window.enableTeasers=!0);var si,ui={_default:{featureName:"this_feature",images:["global.jpg"]},paywall:{headingText:"teaser_paywall_heading",text:"teaser_paywall_body",images:["global.jpg"]},artsy:{featureName:"Artsy",text:"teaser_artsy",images:["artsy-before.jpg","artsy-after.jpg"]},background:{featureName:"background",text:"teaser_background",images:["background-before.jpg","background-after.jpg"]},batch_processing:{featureName:"batch_processing",text:"teaser_batch_processing",images:["batch-processing.jpg"]},clarity:{featureName:"clarity",text:"teaser_clarity",images:["clarity-before.jpg","clarity-after.jpg"]},clone:{featureName:"clone",text:"teaser_clone",images:["clone-before.jpg","clone-after.jpg"]},collage_wizard:{featureName:"collage_wizard",text:"teaser_collage_wizard",images:["collage-wizard.jpg"]},cutout:{featureName:"cutout",text:"teaser_cutout",images:["cutout-before.jpg","cutout-after.jpg"]},designer_templates:{skipTeaser:!0},edit_layer:{featureName:"this_feature",text:"teaser_edit_layer_body",video:"edit-layer-teaser.mp4",learnMoreLink:"https://support.befunky.com/hc/en-us/articles/360004850012"},enhance_dlx:{featureName:"Enhance DLX",text:"teaser_enhance_dlx",images:["enhance-DLX-before.jpg","enhance-DLX-after.jpg"]},fill_light:{featureName:"fill_light",text:"teaser_fill_light",images:["fill-light-before.jpg","fill-light-after.jpg"]},font_management:{featureName:"this_feature",text:"teaser_font_management",video:"fonts-teaser-modal-v2.mp4",learnMoreLink:"https://support.befunky.com/hc/en-us/articles/360001571631-How-Do-I-Add-My-Fonts-To-BeFunky-"},funky_focus:{featureName:"funky_focus",text:"teaser_funky_focus",images:["funky-focus-before.jpg","funky-focus-after.jpg"]},glow:{featureName:"glow",text:"teaser_glow",images:["glow-before.jpg","glow-after.jpg"]},lens_flares:{featureName:"lens_flare",text:"teaser_lens_flares",images:["lens-flare-before.jpg","lens-flare-after.jpg"]},photo_effects:{featureName:"photo_effects",text:"teaser_photo_effects",images:["photo-effects.jpg"]},replace_color:{featureName:"replace_color",text:"teaser_replace_color",images:["replace-color-before.jpg","replace-color-after.jpg"]},reshape:{featureName:"reshape",text:"teaser_reshape",images:["reshape-before.jpg","reshape-after.jpg"]},save_editor:{headingText:"teaser_save_editor_heading",text:"teaser_save_editor",images:["global.jpg"]},save_collage:{headingText:"teaser_save_collage_heading",text:"teaser_save_collage",images:["collage-wizard.jpg"]},save_designer:{headingText:"pricing_modal_templates_heading",text:"teaser_save_designer",images:["designer-templates.jpg"]},top_nav_bar:{skipTeaser:!0},touchup:{featureName:"touch_up_tools_titlecase",text:"teaser_touchup",images:["touch-up-before.jpg","touch-up-after.jpg"]},vibrance:{featureName:"vibrance",text:"teaser_vibrance",images:["vibrance-before.jpg","vibrance-after.jpg"]},vignette:{featureName:"vignette",text:"teaser_vignette",images:["vignette-before.jpg","vignette-after.jpg"]}};function ci(){var e=_(['\n        <div class="announcement__images">\n            <img class="announcement__image" src=','>\n            <img class="announcement__image" src=',' style="','">\n        </div>']);return ci=function(){return e},e}function li(){var e=_(['\n        <div class="announcement__video">\n             <video autoplay loop muted>\n                <source src=',' type="video/mp4">\n            </video>\n        </div>']);return li=function(){return e},e}function di(){var e=_(['<figure class="announcement__figure"></figure>']);return di=function(){return e},e}BeFunky.createAndOpenTeaser=function(e,n){ui[e]=n,BeFunky.openTeaserModal(e)},BeFunky.openTeaserModal=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"_default";if(ui.hasOwnProperty(e)||(BeFunky.logWarning('Invalid teaser type "'.concat(e,'" specified')),e="_default"),si="batch_processing"===e?"batch":function(){try{return BFN.AppModel.sectionID}catch(e){BeFunky.logError("Unable to get current app section",e)}return""}(),window.enableTeasers&&!ui[e].skipTeaser){var n=ui[e],t=n.headingText,o=n.featureName,r=n.text,a=n.learnMoreLink,i=n.imageAspectRatio,s=ui[e],u=s.images,c=void 0===u?[]:u,l=s.video,d=ii({headingText:t,featureName:o,images:c=c.map(function(e){return e.startsWith("data:")?e:"".concat(BeFunky.Params.globalImagesPath,"teasers/").concat(e)}),video:l=!!l&&"".concat(BeFunky.Params.globalImagesPath,"teasers/").concat(l),learnMoreLink:a,imageAspectRatio:i,text:r||"teaser_default",isLoggedIn:BeFunky.isLoggedIn()},{onUpgrade:function(){return BeFunky.openUpgradePanel(si,!0)},onSignIn:function(){BeFunky.openLoginPanel("SIGNIN",function(){BeFunky.openPaymentPanel()})}});document.body.appendChild(d);var g=ui[e].hasOwnProperty("video")?[1032]:"large";BeFunky.befunkyPopupContainerOpen("#teaser_modal",{size:g,destroyOnClose:!0,onClose:function(){return d.teardown()}})}else BeFunky.openUpgradePanel(si,!0)};var gi=BeFunky.lit,pi=gi.html,fi=gi.setupState,hi=gi.render,mi=gi.elem;function yi(e){var n=mi(di()),t=!1,o=BeFunky.debounce(function(){return hi(a.video?pi(li(),a.video):a.images?(e=a.images[a.imageIndex],t=a.images[s()],pi(ci(),e.url,t.url,"opacity: ".concat(a.isAnimatingNextImage?1:0,"; left: 0; transition: ").concat(a.isAnimatingNextImage&&t.fadeIn?"opacity 1s ease-in-out":"none"))):"",n);var e,t},"raf"),r=k(fi(Object.assign({},{video:"",images:null,imageIndex:0,isAnimatingNextImage:!1},e),o),2),a=r[0],i=r[1];return a.images&&function e(){var n=a.images[a.imageIndex].duration;setTimeout(function(){if(!t){var e=a.images[s()];e.fadeIn?(i({isAnimatingNextImage:!0}),requestAnimationFrame(function(){setTimeout(o,1e3)})):o()}},1e3*n);function o(){t||(i({isAnimatingNextImage:!1,imageIndex:s()}),e())}}(),n.teardown=function(){t=!0},n;function s(){return a.imageIndex<a.images.length-1?a.imageIndex+1:0}}var vi={edit_layer:{headingText:"edit_layer_announcement_header",bodyText:["edit_layer_announcement_body",{done_editing_image:function(){return BeFunky.LanguageManager.getString("done_editing_image","modal")}}],learnMoreLink:"https://support.befunky.com/hc/en-us/articles/360004850012",video:"edit-layer-announcement-final.mp4"},font_management:{headingText:"font_announcement_title",bodyText:"font_announcement_body",learnMoreLink:"https://support.befunky.com/hc/en-us/articles/360001571631-How-Do-I-Add-My-Fonts-To-BeFunky-",video:"fonts-announcement-modal-v2.mp4"},background_remover:{headingText:"background_remover_announcement_header",bodyText:"background_remover_announcement_body",learnMoreLink:"".concat(BeFunky.Params.siteUrl,"learn/automatic-background-remover/"),video:"background-remover-announcement.mp4"},ai_portrait_enhancer:{headingText:"portrait_enhancer_announcement_clue_header",bodyText:"portrait_enhancer_announcement_body",learnMoreLink:"".concat(BeFunky.Params.siteUrl,"learn/ai-portrait-enhancer/"),images:[{filename:"portrait-enhancer-5before.jpg",duration:1.5,fadeIn:!1},{filename:"portrait-enhancer-5after.jpg",duration:3,fadeIn:!0},{filename:"portrait-enhancer-3before.jpg",duration:1.5,fadeIn:!1},{filename:"portrait-enhancer-3after.jpg",duration:3,fadeIn:!0}]},ai_image_enhancer:{headingText:"image_enhancer_announcement_headline",bodyText:"image_enhancer_announcement_body",learnMoreLink:"".concat(BeFunky.Params.siteUrl,"learn/ai-image-enhancer/"),images:[{filename:"ai-tools-image-enhancer.jpg",duration:3,fadeIn:!0},{filename:"ai-tools-portrait.jpg",duration:3,fadeIn:!0}]},pwa:{headingText:"pwa_announcement_headline",bodyText:"pwa_announcement_body",learnMoreLink:"https://support.befunky.com/hc/en-us/articles/360051162372",video:"pwa-announcement-modal.mp4",confirmText:"install_now",cancelText:"ask_later"}};function _i(){var e=_(['\n        <div class="centered-modal__bg centered-modal__bg--orange"></div>\n        <payment-form class="centered-modal__content" .mode='," .email="," .initialPromoCode="," .onPaymentSubmit=","></payment-form>\n    "]);return _i=function(){return e},e}BeFunky.openAnnouncementModal=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=n.onConfirm,o=void 0===t?function(){}:t,r=n.onCancel,a=void 0===r?function(){}:r,i=vi[e],s=i.headingText,u=i.bodyText,l=i.learnMoreLink,d=i.confirmText,g=i.cancelText,p=vi[e],f=p.video,h=p.images,m=yi({video:f=f?"".concat(BeFunky.Params.globalImagesPath,"teasers/").concat(f):"",images:h=h?h.map(function(e){return c(c({},e),{},{url:"".concat(BeFunky.Params.globalImagesPath,"teasers/").concat(e.filename)})}):null}),y=!1,v=!1,_=d&&g?[{text:g,type:"medium-grey",onClick:function(){v=!0}},{text:d,type:["dark-blue","ellipsis"],onClick:function(){y=!0}}]:[{text:"ok_got_it",type:["dark-blue","ellipsis"]}];BeFunky.openNebulaDialog({className:"announcement",heading:[s,{"new!":function(){return'<span class="announcement__new-text">'.concat(BeFunky.LanguageManager.getString("new!"),"</span>")}}],body:u,figure:m,buttons:[{text:"learn_more",type:"link",href:l,style:_.length>1?"margin: 0 auto 0 0":""}].concat(_),modalOptions:{size:"medium-nebula",addCloseButton:!1,addSiteClass:!0,closeOnClickOutside:!0,onClose:function(){m.teardown(),y?o():a(v)}}})},BeFunky.showAnnouncementOnce=function(e,n){if(!vi[e])return BeFunky.throwError("Invalid announcement type",e),Promise.resolve(!1);var t="".concat(e,"_announcement");return BFN.SettingsManager.getSetting("dismissed_messages").then(function(o){return!o.includes(t)&&(BeFunky.openAnnouncementModal(e,n),BFN.SettingsManager.updateSetting("dismissed_messages",[].concat(w(o),[t])),!0)})},BeFunky.openUpgradePanel=function(e,n){if(n||(BeFunky.LoginPanelObj.closeNextFunction=openFlash),!BeFunky.isPlus()){Ci();var t={batch:"pricing_modal_card_batch_processing",collage:"pricing_modal_card_collage_wizard",designer:"pricing_modal_card_designer"},o=t[e]?document.getElementById(t[e]):null;o&&o.addClass("pricing-modal__card--first"),document.getElementById("pricing_modal").toggleClass("pricing-modal--flash",!BeFunky.isUseHTML5),BeFunky.befunkyPopupContainerOpen("#pricing_modal",{}),Gt()}},BeFunky.openUpgradeToYearlyPanel=function(){BeFunky.isPlus()&&BeFunky.promptUserToUpgradeToYearly(qt().month.id,window.openFlash)},BeFunky.promptUserToUpgradeToYearly=function(e,n){var t=qt(),o=t.month,r=t.year;if(o.id!==e)return BeFunky.throwError("Mismatched monthly plans",o.id,e),void(n&&n());var a=Object.assign({},r,{unit_amount:.9*r.unit_amount}),i=o.unit_amount,s=12*i-r.unit_amount,u=BeFunky.LanguageManager.language.modal;if(s<0)return BeFunky.throwError("Upgrade to yearly provides no savings",{centsSaved:s,currentMonthlyCents:i,newYearlyCents:r.unit_amount}),void(n&&n());var c=s/i,l=c>=1.75&&c<=2.75?"upgrade_yearly_modal_body_2_months":"upgrade_yearly_modal_body";console.log({monthsOfSavings:c,currentMonthlyCents:i});var d={currency:o.currency,unit_amount:s};BeFunky.confirm([l,{amount_saved:Wt(d,u),regular_annual_price:Wt(r,u),discounted_annual_price:Wt(a,u)}],{heading:"upgrade_yearly_modal_heading",confirmText:["upgrade_yearly_modal_confirm",{amount:Wt(a,u)}],cancelText:"upgrade_yearly_modal_cancel",imageUrl:"".concat(BeFunky.Params.globalImagesPath,"site/modals/piggy-bank.jpg"),onConfirm:function(){BeFunky.upgradeToYearlyPayNow(r)},onCancel:n})},BeFunky.upgradeToYearlyClose=function(){return BeFunky.befunkyPopupContainerClose(),window.bf_eventTrack("PROMOTION","UPGRADE_YEARLY_APP","NOT_NOW"),!1};var ki=function(){};BeFunky.upgradeToYearlyPayNow=function(e){if("object"!==o(window.stripe))return Eo(function(){BeFunky.upgradeToYearlyPayNow(e)});window.bf_eventTrack("PROMOTION","UPGRADE_YEARLY_APP","PAY_NOW");var n=function(){window.bf_eventTrack("PROMOTION","UPGRADE_YEARLY_APP","UPGRADE_SUCCESS"),BeFunky.hideLoadScreen(),ki(),BeFunky.showNotification({message:"upgrade_yearly_success",type:"success"}),BeFunky.updateMyAccountPageAfterUpgrade&&BeFunky.updateMyAccountPageAfterUpgrade()};BeFunky.showLoadScreen({isCancellable:!1}),BeFunky.requestAPI("transaction/upgrade-to-yearly",{price:e.id}).then(function(e){if("success"!==e.data&&e.data.code&&e.data.cim)return t=e.data.cim,void window.stripe.confirmCardPayment(t).then(function(e){var t={confirmed:e.error?"2":"1"};e.error&&BeFunky.logError("3D secure failed with error",e.error),BeFunky.requestAPI("transaction/upgrade-to-yearly",t,{}).then(function(t){if("success"!==t.data)throw"invalid_response";if(!e.error)return n();ki();var o=e.error.message||"error_processing_payment";ki=BeFunky.showNotification({message:o,type:"error_processing_payment"===o?"warning":"error"})}).catch(function(e){BeFunky.throwError("Upgrade to yearly after 3d secure failed",e)}).then(function(){BeFunky.hideLoadScreen()})});var t;if("success"!==e.data)throw"invalid_response";n()}).catch(function(e){if("already_yearly"===e||"already_exist"===e)return n();BeFunky.hideLoadScreen(),window.bf_eventTrack("PROMOTION","UPGRADE_YEARLY_APP","UPGRADE_FAILURE"),BeFunky.logError("Unable to process payment upgrade to Yearly",e),BeFunky.Params.sendDebugErrors&&"request_failed"!==e&&BeFunky.throwError("Upgrade to yearly error ".concat(e.code||e)),ki();var t=e.code?Fi(e.code).translationID:BeFunky.failureReason(e);ki=BeFunky.showNotification({message:t,type:"error_processing_payment"===t?"warning":"error"})})},BeFunky.openPaymentPanel=function(e,n){["charge","free_trial","update","update_from_payflow"].includes(n)||(n=BeFunky.getFreeTrialEnabled()?"free_trial":"charge"),["month","year"].includes(e)||(e=jt());var t=["update","update_from_payflow"].includes(n);if(!BeFunky.isPlus()||t){if(jt()!==e&&Nt(e),!BeFunky.isLoggedIn())return BeFunky.registerComeFromUpgrade=!0,void BeFunky.openLoginPanel("REGISTER",function(){"free_trial"!==n||BeFunky.getFreeTrialEnabled()||(n="charge"),BeFunky.openPaymentPanel(e,n)});var o=BeFunky.lit,r=o.render,a=o.html,i=document.getElementById("payment_modal"),s=BeFunky.User.email||BeFunky.User.FlashVarsObject.email||"",u=(zt()||{}).code;r(a(_i(),n,s,u,bi),i),BeFunky.befunkyPopupContainerOpen("#payment_modal")}else{var c=BeFunky.getModal(),l=c?c.modalElement.id:void 0;["sign_in_modal","register_modal"].includes(l)&&BeFunky.closeModal(l)}};var wi=!1;function bi(e){var n=e.cardHolderName,t=e.stripeElement,r=e.email,a=e.mode,i=e.recurring,s=e.displayError,u=e.clearInputs,c=e.paymentRequestPaymentMethod,l=e.paymentRequestCompleteFunction,d=e.promoCode;function g(e){var t=e.error,s=e.paymentMethod;if(t)p(t.code,t.message);else if(s&&s.id){var c="0";try{c="undefined"!=typeof growsumo&&growsumo.data.partner_key&&growsumo.data.partner_key.length>0?growsumo.data.partner_key:"0"}catch(e){}if("0"!==c)try{growsumo.data.email=r,growsumo.data.customer_key=r,growsumo.createSignup()}catch(e){}var g=function(e){var n=qt();if(n)return n[e]}(i);if(g){var f,h=(parseInt(g.unit_amount)/100).toFixed(2),m="update_from_payflow"===a?"update-payflow-customer":"update"===a?"update-customer":"create-customer",y="year"===i?"yearly":"monthly";if("charge"===a||"free_trial"===a||"update"===a)f={stripeEmail:r,stripeToken:s.id,holdername:n||"",isGrowsumo:c,handlerType:"subscription_purchase",price:g.id,promo_code:d||"",country:Rt(),start_free_trial:"free_trial"===a?1:0,trial_from:BeFunky.isPaywallEnabled()?"save":""};else{if("update_from_payflow"!==a)return BeFunky.throwError("Invalid payment mode: ".concat(a));f={stripeEmail:r,stripeToken:s.id,nextBillingDate:"monthly"===y?BeFunky.Params.nextBillingDateMonthly:BeFunky.Params.nextBillingDateAnnual,period:y}}!0===BeFunky.Params.return_fail_from_customer&&(f.return_fail_from_customer=1);var v=function e(n){if(wi=!1,n&&n.error)return"string"==typeof n.error?p(n.error,BeFunky.failureReason(n.error)):"user_is_plus"===n.error.code?(BeFunky.throwError("Already-plus user filled out payment form"),p(n.error.code,"You are already a BeFunky Plus user")):p(n.error.code,n.error.message,n);if(n&&n.data&&n.data.action_needed&&n.data.cuid){var t=n.data.cuid;f={handlerType:"subscription_purchase_reaction",cuid:t};var r=n.data.action_needed;n.data.action_needed=null,n.data.cuid=null;var i=function(o){o.error?(f={handlerType:"subscription_purchase_reaction_error",cuid:t},BeFunky.requestAPI("transaction/".concat(m),f).then(function(){},function(){}),p("handle_card_error",o.error.message,n)):(l&&"function"==typeof l&&(l("success"),l=null),BeFunky.requestAPI("transaction/".concat(m),f).then(function(){e(n)},function(n){e({error:n})}))};return"update"===a?window.stripe.confirmCardSetup(r).then(i):window.stripe.confirmCardPayment(r).then(i)}l&&"function"==typeof l&&l("success");var s=Boolean(n&&n.data&&n.data.trial_started);try{s||bf_eventTrack("CONVERSION",y.toUpperCase(),"CREDITCARD"),BeFunky.User.FlashVarsObject.subscr_date&&"charge"===a&&bf_eventTrack("RESUBSCRIBE",y.toUpperCase(),"CREDITCARD")}catch(e){BeFunky.throwError("Unable to track payment conversion",e)}var c={pl:"1",subscr_usr:1};if("update"!==a&&(n&&n.data&&n.data.plan_type?c.plan_type=n.data.plan_type:y?c.plan_type="yearly"===y?1:0:BeFunky.throwError("Unable to get plan_type"),n&&n.data&&n.data.subscr_amount?c.subscr_amount=n.data.subscr_amount:y?c.subscr_amount=h:BeFunky.throwError("Unable to get subscr_amount"),n&&n.data&&n.data.subscr_date?c.subscr_date=n.data.subscr_date:window.bfn_mp?c.subscr_date=window.bfn_mp.getISODate():BeFunky.throwError("Unable to get subscr_date"),n&&n.data&&n.data.payment_type&&(c.payment_type=n.data.payment_type),s)){c.subscription_status="trialing";var d=n.data.trial_started;c.trial_source=d;var g="chromeos_perk_two_trial"===d?"TRIAL_CONVERSION":d.toUpperCase();bf_eventTrack(g,y.toUpperCase(),"TRIAL STARTED"),BeFunky.SettingsService.updateSetting("trialing","trialing")}if(window.updateUserStatus(Object.assign({},window.latestUserData,c)),"update"!==a&&(!1===(window.isMixPanelInit&&"function"==typeof mixpanel.identify)&&(console.log("Mixpanel load: ".concat(window.isMixPanelInit)),console.log("Mixpanel identify: ".concat(o(mixpanel.identify))),console.log("Mixpanel upl: ".concat(BeFunky.User.FlashVarsObject.pl)),console.log("Mixpanel subscr: ".concat(BeFunky.User.FlashVarsObject.subscr_usr)),console.log("Mixpanel plantype: ".concat(BeFunky.User.FlashVarsObject.plan_type)),BeFunky.throwError("Mixpanel could not track purchase")),void 0!==window.bfn_mp&&void 0!==window.mixpanel)){var v=!1;if(void 0!==navigator.doNotTrack&&!0===BeFunky.ConvertToBool(navigator.doNotTrack)?v=!0:void 0!==navigator.msDoNotTrack&&!0===BeFunky.ConvertToBool(navigator.msDoNotTrack)?v=!0:void 0!==window.doNotTrack&&!0===BeFunky.ConvertToBool(window.doNotTrack)&&(v=!0),!0===v){console.log("Mixpanel do not track enabled");try{window.bfn_mp.trackingEnabled=!1;var _=window.bfn_mp.track("subscription_started");_||(console.log("bfn_mp.identifier = ",window.bfn_mp.identifier),console.log("Mixpanel upl: ".concat(BeFunky.User.FlashVarsObject.pl)),console.log("Mixpanel subscr: ".concat(BeFunky.User.FlashVarsObject.subscr_usr)),console.log("Mixpanel plantype: ".concat(BeFunky.User.FlashVarsObject.plan_type)));var k={data:{people:null!==_[0]?_[0]:"",super:null!==_[1]?_[1]:"",property:null!==_[2]?_[2]:""}};k=void 0!==window.base64_encode?window.base64_encode(JSON.stringify(k)):btoa(JSON.stringify(k)),BeFunky.requestAPI("auth/has-opted-out-tracking",{event:"subscription_started",data:k})}catch(e){BeFunky.throwError("Mixpanel has_opted_out_tracking block error: ",e)}}else try{window.bfn_mp.track("subscription_started")}catch(e){}}if(BeFunky.isUseHTML5)try{BFN.BfnService.getUserData()}catch(e){}else try{document.getElementById(BeFunky.Params.swfId).userValueObj(BeFunky.User.FlashVarsObject)}catch(e){}try{window.flashFreeTop=0,window.flashFreeRight=0,window.isflashFreeRight=!1,window.reResizeFlashHeight()}catch(e){}if(BeFunky.hideLoadScreen(),"charge"===a||"free_trial"===a){BeFunky.preventModalDispose=!0,BeFunky.closeModal("payment_modal"),BeFunky.preventModalDispose=!1;try{BeFunky.openThankYouPanel(BeFunky.LoginPanelObj.closeNextFunction||void 0)}catch(e){(BeFunky.isInternetExplorer?BeFunky.logError:BeFunky.throwError)("Unable to open thank-you panel",e),"function"==typeof BeFunky.LoginPanelObj.closeNextFunction&&BeFunky.LoginPanelObj.closeNextFunction()}}else BeFunky.closeModal("payment_modal");u&&u(),BeFunky.updateMyAccountPageAfterUpgrade&&BeFunky.updateMyAccountPageAfterUpgrade()};if(BeFunky.Params.IS_LC)return v({error:"local_dev"});BeFunky.requestAPI("transaction/".concat(m),f).then(function(e){v(e)},function(e){v({error:e})})}else p(void 0,"Missing price")}else p(void 0,"Missing Stripe payment method")}function p(e,n,t){BeFunky.hideLoadScreen(),wi=!1;var o=JSON.stringify({code:e,message:n});if(t&&t.error&&t.error.status){var r=t.error.status;o=JSON.stringify({code:e,message:n,status:r})}BeFunky.logError("A payment error occurred",o);var a=Fi(e),i=a.field,u=a.translationID;a.reportError&&(c?BeFunky.throwError("Payment wallet error ".concat(e)):BeFunky.throwError("Payment error ".concat(e))),l&&"function"==typeof l&&l("fail"),s&&s(i,u)}wi?BeFunky.logError("Already processing payment"):(BeFunky.showLoadScreen({isCancellable:!1}),wi=!0,c?g({error:null,paymentMethod:c}):window.stripe.createPaymentMethod({type:"card",card:t,billing_details:{name:n}}).then(g).catch(function(e){BeFunky.logError("An unexpected payment-related error occurred",e),BeFunky.throwError(e),p(void 0,"Unknown error")}))}function Fi(e){switch(e){case"invalid_number":case"incorrect_number":case"incomplete_number":return{field:"number",translationID:"error_invalid_number",reportError:!1};case"expired_card":case"invalid_expiry_year_past":return{field:"form",translationID:"error_expired_card",reportError:!1};case"incomplete_expiry":return{field:"expiry",translationID:"error_incomplete_expiry",reportError:!1};case"invalid_expiry_year":return{field:"expiry",translationID:"error_invalid_expiry_year",reportError:!1};case"invalid_expiry_month":return{field:"expiry",translationID:"error_invalid_expiry_month",reportError:!1};case"incomplete_cvc":case"invalid_cvc":case"incorrect_cvc":return{field:"cvc",translationID:"error_invalid_cvc",reportError:!1};case"invalid_promo_code":case"used_before":return{field:"promo",translationID:"error_invalid_promo_code",reportError:!1};case"user_is_plus":return{field:"form",translationID:"error_already_upgraded",reportError:!0};case"subscribed_before":return{field:"form",translationID:["error_please_refresh",{contact_support:BeFunky.toLinkHTML("SUPPORT",!0)}],reportError:!0};case"authentication_required":case"approve_with_id":case"call_issuer":case"card_not_supported":case"card_velocity_exceeded":case"currency_not_supported":case"do_not_honor":case"do_not_try_again":case"duplicate_transaction":case"fraudulent":case"generic_decline":case"incorrect_pin":case"incorrect_zip":case"insufficient_funds":case"invalid_account":case"invalid_amount":case"invalid_pin":case"issuer_not_available":case"lost_card":case"merchant_blacklist":case"new_account_information_available":case"no_action_taken":case"not_permitted":case"offline_pin_required":case"online_or_offline_pin_required":case"pickup_card":case"pin_try_exceeded":case"reenter_transaction":case"restricted_card":case"revocation_of_all_authorizations":case"revocation_of_authorization":case"security_violation":case"service_not_allowed":case"stolen_card":case"stop_payment_order":case"testmode_decline":case"transaction_not_allowed":case"try_again_later":case"withdrawal_count_limit_exceeded":case"card_declined":return{field:"form",translationID:"error_card_declined",reportError:!0};default:return{field:"form",translationID:"error_processing_payment",reportError:!0}}}var Bi,Ei,Li,Ii,Si,Pi,Ci=BeFunky.once(function(){var e=document.getElementById("pricing_modal"),n=document.getElementById("pricing_modal_upgrade");n.addEventListener("click",function(){BeFunky.openPaymentPanel(jt())}),BeFunky.onFreeTrialEnabledChange(function(t){n.setLang(t?"start_trial":"upgrade_now"),e.querySelector(".centered-modal__heading").setLang(t?"pricing_modal_trial_heading":"pricing_modal_heading"),e.querySelector(".centered-modal__sub-heading").setLang(t?"pricing_modal_trial_subheading":"pricing_modal_subline1")});["batch_processing_video","collage_wizard_video","lens_flare_video"].forEach(function(e){document.getElementById(e).addEventListener("click",function(n){n.preventDefault(),BeFunky.openVimeoModal(e)})}),[{id:"pricing_modal_cutout_body",links:{cutout_tool:"".concat(BeFunky.Params.blogUrl,"cutout-tool-2/"),clone_tool:"".concat(BeFunky.Params.blogUrl,"clone/")}},{id:"pricing_modal_effects_body",links:{photo_effects:"".concat(BeFunky.Params.blogUrl,"photo-effects/")}},{id:"pricing_modal_artsy_body",links:{artsy_effects:"".concat(BeFunky.Params.blogUrl,"artsy-effects/")}},{id:"pricing_modal_batch_body",links:{batch_processing:"".concat(BeFunky.Params.blogUrl,"batch-processing-photos/")}},{id:"pricing_modal_enhance_body",links:{fill_light:"".concat(BeFunky.Params.blogUrl,"fill-light/"),vibrance:"".concat(BeFunky.Params.blogUrl,"vibrance-tool/"),clarity:"".concat(BeFunky.Params.blogUrl,"clarity-tool/"),"Enhance DLX":"".concat(BeFunky.Params.blogUrl,"photo-enhancer/")}},{id:"pricing_modal_templates_body",links:{templates_link:"".concat(BeFunky.Params.blogUrl,"graphic-design-templates/")}},{id:"pricing_modal_background_body",links:{background:"".concat(BeFunky.Params.blogUrl,"transparent-background/"),cutout:"".concat(BeFunky.Params.blogUrl,"cutout-tool-2/"),replace_color:"".concat(BeFunky.Params.blogUrl,"replace-color-tool/")}},{id:"pricing_modal_touchup_body",links:{touch_up_tools:"".concat(BeFunky.Params.blogUrl,"retouch-photos/")}},{id:"pricing_modal_flares_body",links:{lens_flares:"".concat(BeFunky.Params.blogUrl,"lens-flare-effects/"),glow:"".concat(BeFunky.Params.blogUrl,"glow-tool/")}},{id:"pricing_modal_focus_body",links:{vignette:"".concat(BeFunky.Params.blogUrl,"vignette/"),funky_focus:"".concat(BeFunky.Params.blogUrl,"funky-focus/")}},{id:"pricing_modal_reshape_body",links:{reshape_tool:"".concat(BeFunky.Params.blogUrl,"reshape-tool/")}}].forEach(function(n){var t=n.id,o=n.links,r={};Object.entries(o).forEach(function(e){var n=k(e,2),t=n[0],o=n[1];r[t]=BeFunky.toLinkHTML(o,!0)});var a=e.querySelector('[data-lang="'.concat(t,'"]'));if(!a)return BeFunky.logError("Unable to find pricing modal element with translation ID =",t);BeFunky.LanguageManager.registerElement(a,r,"modal")}),e.onModalClose=function(){var n=e.querySelector(".pricing-modal__card--first");n&&n.removeClass("pricing-modal__card--first")}}),xi="user_photo_modal",Ti={},Ai=null,Ri=null,Mi=!1,Ui=[];function Di(e,n,t){if(e){var o=document.querySelector(".user-photo__image-box");o.innerHTML="",Ti.hasOwnProperty(e.imageURL)?o.appendChild(Ti[e.imageURL]):o.appendChild(Oi(e)),Li.textContent=e.title;var r=Li.innerHTML.replace(/#(\w+)/gi,'<a href="'.concat(BeFunky.Params.siteUrl,'explore/photos/$1/">#$1</a>'));if(Li.innerHTML=r||"Untitled",Ii.innerHTML='by <a href="'.concat(BeFunky.Params.siteUrl,"gallery/").concat(e.nick,'/">').concat(e.nick,"</a>"),n){var a=n.indexOf(e);Ai=n[a-1],Ri=n[a+1];var i=k(BeFunky.getModal(xi).arrowButtons,2),s=i[0],u=i[1];s.disabled=!Ai,u.disabled=!Ri,requestIdleCallback(function(){Ai&&Oi(Ai),Ri&&Oi(Ri)})}}else Ei.src="",Li.innerHTML="",Ii.innerHTML="",Object.keys(Ti).forEach(function(e){delete Ti[e]});if(Si.toggleClass("user-photo__report-abuse--hidden",!t),e){Pi=e.id.replace("befunky_photo_","");var c=Ui.includes(Pi);Si.disabled=c,Si.setLang(c?"abuse_reported":"report_abuse","site")}}function Oi(e){var n=new Image;return n.src=e.imageURL,n.setClass("image-box__image explore-modal__image"),e.isTransparent&&n.addClass("image-box__image--is-transparent"),n.id="explore-image",Ti[n.src]=n,n}function ji(e){return"explore/gallery/".concat(e.id.split("_").pop(),"/")}function Ni(e){if(!BeFunky.isLoggedIn())return BeFunky.openLoginPanel("SIGNIN",function(){BeFunky.befunkyPopupContainerClose(),Ni(e)});if(!(null!=BeFunky.User.isMailVerified?BeFunky.User.isMailVerified:BeFunky.Params.isMailVerified))return BeFunky.confirm("please_verify_email",{onConfirm:BeFunky.sendVerificationEmail,confirmText:"send_verification_email",imageUrl:"".concat(BeFunky.Params.globalImagesPath,"site/illustrations/paper-plane.svg")});var n=document.createElement("div");n.appendChild(document.createElement("p").setLang("report_abuse_prompt_1","site")),n.appendChild(document.createElement("p").setLang("report_abuse_prompt_2","site")),BeFunky.confirm(n,{heading:"report_abuse",confirmText:"report",imageUrl:"".concat(BeFunky.Params.globalImagesPath,"site/illustrations/flag.svg"),onConfirm:function(){var n={mode:"reportAbuse",img_key:e};BeFunky.sessionRoutes[BeFunky.sessionRoutes.length-1].startsWith("/a/")&&(n.is_anonymous=1),BeFunky.requestAPI("photo/report-abuse",n,{showLoadScreen:!0}).then(function(){Ui.push(e)}).catch(function(n){BeFunky.throwError("Unable to Report Abuse on image",n,e)}).then(function(){BeFunky.acknowledge("report_abuse_thank_you",{heading:"report_abuse_sorry"})})}})}BeFunky.onDocumentReady(function(){(Bi=document.getElementById(xi))&&(Ei=Bi.querySelector(".user-photo__image"),Li=Bi.querySelector(".user-photo__title"),Ii=Bi.querySelector(".user-photo__author"),(Si=Bi.querySelector(".user-photo__report-abuse")).addEventListener("click",function(){if(!Pi){var e=document.getElementById("user_photo_modal");e&&(Pi=e.getAttribute("data-single-image-id"))}if(!Pi)return BeFunky.throwError("reportAbuseImageID not found");var n=BeFunky.getModal(xi);n&&n.isVisible&&BeFunky.closeModal(xi),Ni(Pi)}))}),BeFunky.reportAbuse=Ni,BeFunky.openUserPhotoModal=function(e,n,t,o){if(!Bi)return BeFunky.throwError("User Photo Modal not available");BeFunky.openModal(Bi,{onOpen:function(){Mi=!0,Di(e,n,o),BeFunky.pushRoute(ji(e))},onClose:function(){Mi=!1,Di(),BeFunky.pushRoute(t)},addSiteClass:!0,addCloseButton:!0,size:"large",onArrowClick:function(e){var t="left"===e?Ai:Ri;t&&(Di(t,n,o),BeFunky.pushRoute(ji(t)))}})},BeFunky.closeUserPhotoModal=function(){Mi&&BeFunky.closeModal(xi)};var Hi={batch_processing_video:"https://player.vimeo.com/video/293033309",collage_wizard_video:"https://player.vimeo.com/video/159379542",lens_flare_video:"https://player.vimeo.com/video/168091282?byline=0"};function qi(){var e=_(["\n            <input\n                @change=","\n                @keyup=",'\n                type="text"\n                class="input project-manager__rename-input focus-initially"\n                maxlength="100"\n                required\n                value=',"\n            >"]);return qi=function(){return e},e}function Vi(){var e=_(["\n        <div @click=",' class="project-manager__edit-button project-manager__edit-button--thumbnail-view">\n            <div class="project-manager__edit-ellipsis">\n                <div></div>\n                <div></div>\n                <div></div>\n            </div>\n        </div>\n        ']);return Vi=function(){return e},e}function Wi(){var e=_(['<image-gallery\n            class="gallery project-manager__thumbnail-gallery"\n            .images=',"\n            .isLoading=","\n            .message=","\n            .emptyState=","\n            .rowHeight=","\n            .currentWidth=","\n            .addItemClass=","\n            .onSelectItem=","\n            .extendItemTemplate=","\n            .getItemTooltip=","\n        ></image-gallery>"]);return Wi=function(){return e},e}function Gi(){var e=_(['<button class="','" .disabled=',' @click="','">',"</button>"]);return Gi=function(){return e},e}function zi(){var e=_(['\n            <div class="project-manager__option-buttons">\n                <div class="panel-header">\n                    <h3 class="panel-header__text panel-header__text--modal-section panel-header__text--wide">','</h3>\n                </div>\n                <div class="project-manager__view-options">\n                    ',"\n                </div>\n            </div>\n            "]);return zi=function(){return e},e}function Xi(){var e=_(['\n                 <div class="project-manager__active-filter">\n                    <span>','</span>\n                    <button class="button button--circle button--outline button--white button--icon button--tiny" @click=',' data-bfntooltip="cancel">\n                        ',"\n                    </button>\n                </div>"]);return Xi=function(){return e},e}function Ji(){var e=_(['\n                <div class="project-manager__active-filter">\n                    <span>','</span>\n                    <button class="button button--circle button--outline button--white button--icon button--tiny" @click=',' data-bfntooltip="cancel">\n                        ',"\n                    </button>\n                </div>"]);return Ji=function(){return e},e}function $i(){var e=_(['\n             <div class="project-manager__active-filters">\n                ',"\n                ","\n            </div>\n        "]);return $i=function(){return e},e}function Yi(){var e=_(['\n            <button class="button button--circle button--outline button--white button--icon button--tiny project-manager__clear-results" @click=',' data-bfntooltip="cancel">\n                ',"\n            </button>\n        "]);return Yi=function(){return e},e}function Ki(){var e=_(['\n            <div class="project-manager__results-header">\n                <h3 class="project-manager__results-heading">',"</h3>\n                ","\n                ","\n            </div>\n        "]);return Ki=function(){return e},e}function Qi(){var e=_(['\n        <div class="project-manager__project-row" @click="','" style=','>\n            <div class="project-manager__name">\n                <div class="project-manager__project-thumbnail" style="background-image: url(',')"></div>\n                    <span>','</span>\n                </div>\n                <span class="project-manager__date-created">','</span>\n                <span class="project-manager__date-modified">','</span>\n\n                <div class="project-manager__edit-button project-manager__edit-button--list-view">\n                    <div class="project-manager__edit-ellipsis">\n                        <div></div>\n                        <div></div>\n                        <div></div>\n                    </div>\n                </div>\n            </div>\n        <div>']);return Qi=function(){return e},e}function Zi(){var e=_(['\n        <div class="panel-header project-manager__column-header-row" style=','>\n            <span class="project-manager__column-header-title project-manager__heading-name">','</span>\n            <span class="project-manager__column-header-title project-manager__heading-created">','</span>\n            <span class="project-manager__column-header-title project-manager__heading-modified">',"</span>\n        </div>\n        ","\n        "]);return Zi=function(){return e},e}function es(){var e=_(['\n        <div class="project-manager__right-panel">\n            ','\n            <div class="modal__right-panel-scroller">\n                ',"\n            </div>\n        </div>\n        "]);return es=function(){return e},e}function ns(){var e=_(['<div class="panel-header"></div>']);return ns=function(){return e},e}function ts(){var e=_(["\n        ",'\n        <div class="modal__body project-manager__body">\n            <div class="project-manager__left-panel">\n               <form role="search" class="search-box project-manager__search-box">\n                    <input type="search" .disabled=',' id="project_manager_search" placeholder=',' class="input project-manager__search-input search-box__input" required>\n                    <button type="reset" class="button button--icon button--large button--transparent search-box__clear">\n                        ','\n                    </button>\n                    <button type="submit" .disabled=',' class="button button--icon button--large button--blue search-box__submit" @click=',">\n                        ",'\n                    </button>\n                </form>\n                <div class="project-manager__left-panel-buttons">\n                    ',"\n                </div>\n            </div>\n            ","\n        </div>\n        ","\n        "]);return ts=function(){return e},e}function os(){var e=_(['<div id="context_menu_project_manager"></div>']);return os=function(){return e},e}function rs(){var e=_(['<div id="project_manager" class="modal project-manager bfn"></div>']);return rs=function(){return e},e}BeFunky.openVimeoModal=function(e){var n=Hi[e];if(!n)return BeFunky.throwError("Invalid video ID",{videoID:e});var t=document.getElementById("vimeo_modal");t.innerHTML=function(e){return'\n    <div style="padding: 56.25% 0 0 0; position: relative;">\n        <iframe src="'.concat(e,'" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%;" allow="autoplay; fullscreen"></iframe>\n    </div>\n    <script src="https://player.vimeo.com/api/player.js"><\/script>\n')}(n),BeFunky.openModal(t,{onClose:function(){t.innerHTML=""},size:"large"})};var as=BeFunky.lit,is=as.html,ss=as.setupState,us=as.render,cs=as.modalLang,ls=as.elem,ds=as.icon;BeFunky.createProjectManagerModal=function(){var e,n=ls(rs()),t=1600,o=t-288-48,r={isLoggedIn:!1,searchTerm:"",previousSearch:null,galleryWidth:o,allProjects:[],sortMode:"MODIFIED",orientationMode:"ALL_ORIENTATION",projectTypeMode:"ALL_PROJECTS",viewMode:"THUMBNAIL",isLoading:!1,message:null},a=BeFunky.once(function(){e=document.getElementById("project_manager_search")}),i=BeFunky.debounce(function(){var e;us(is(ts(),g,!c.isLoggedIn,cs("search_all_projects",!0),ds("global-cancel-icon","icon icon-size-small"),!c.isLoggedIn,v,ds("global-search-icon","icon icon-global-search-icon"),p.map(function(e){return is(zi(),cs(e.heading),e.buttons.filter(function(e){return!e.visibilityFilter||e.visibilityFilter()}).map(function(e){var n=e.isSelected===c[e.mode]?"button button--list project-manager__option project-manager__option--selected":"button button--list project-manager__option";return is(Gi(),n,!c.isLoggedIn,e.handler,cs(e.text))}))}),c.isLoggedIn?is(es(),(e=c.searchTerm?["search_results_for",{query:"<strong>".concat(BeFunky.escapeHTML(c.searchTerm),"</strong>")}]:"all_projects",is(Ki(),cs(e),c.searchTerm?is(Yi(),_,ds("global-cancel-icon","icon icon-size-tiny")):"",function(){if("ALL_PROJECTS"!==c.projectTypeMode||"ALL_ORIENTATION"!==c.orientationMode){var e={ALL_ORIENTATION:"all_orientations",HORIZONTAL:"horizontal",VERTICAL:"vertical",SQUARE:"square",ALL_PROJECTS:"all_projects",EDITOR:"photo_editor",COLLAGE:"collage_maker",DESIGNER:"graphic_designer"};return is($i(),"ALL_ORIENTATION"!==c.orientationMode?is(Ji(),cs(e[c.orientationMode]),b("ALL_ORIENTATION"),ds("global-cancel-icon","icon icon-size-tiny")):"","ALL_PROJECTS"!==c.projectTypeMode?is(Xi(),cs(e[c.projectTypeMode]),b("ALL_PROJECTS"),ds("global-cancel-icon","icon icon-size-tiny")):"")}}())),c.isLoading?m():c.allProjects.length?"THUMBNAIL"===c.viewMode?m():is(Zi(),"width: ".concat(c.galleryWidth,"px"),cs("name"),cs("date_created"),cs("last_modified"),R().map(function(e){return is(Qi(),function(n){return F(n,e.id)},"width: ".concat(c.galleryWidth,"px"),e.listViewThumbURL,e.filename,U(e.creationDate),U(e.modifiedDate))})):m()):m(),f),n),a()},"raf"),u=k(ss(r,i),2),c=u[0],l=u[1];BeFunky.LanguageManager.addLanguageUpdateListener(i),window.onUserStatusChange(function(){l({isLoggedIn:BeFunky.isLoggedIn()}),c.isLoggedIn&&T()});var d,g=(d=ls(ns()),BeFunky.panelHeader(d,{name:"project_manager",closeEnabled:!0,modifier:"modal"}),d),p=[{heading:"view",buttons:[{text:"thumbnails",handler:B("THUMBNAIL"),isSelected:"THUMBNAIL",mode:"viewMode"},{text:"list_items",handler:B("LIST"),isSelected:"LIST",mode:"viewMode"}]},{heading:"sort_by",buttons:[{text:"relevancy",handler:L,isSelected:"RELEVANT",mode:"sortMode",visibilityFilter:function(){return Boolean(c.searchTerm)}},{text:"modified_date",handler:I,isSelected:"MODIFIED",mode:"sortMode"},{text:"creation_date",handler:S,isSelected:"CREATED",mode:"sortMode"},{text:"name",handler:P,isSelected:"NAME",mode:"sortMode"}]},{heading:"orientation",buttons:[{text:"all_orientations",handler:C("ALL_ORIENTATION"),isSelected:"ALL_ORIENTATION",mode:"orientationMode"},{text:"horizontal",handler:C("HORIZONTAL"),isSelected:"HORIZONTAL",mode:"orientationMode"},{text:"vertical",handler:C("VERTICAL"),isSelected:"VERTICAL",mode:"orientationMode"},{text:"square",handler:C("SQUARE"),isSelected:"SQUARE",mode:"orientationMode"}]},{heading:"project_type",buttons:[{text:"all_types",handler:x("ALL_PROJECTS"),isSelected:"ALL_PROJECTS",mode:"projectTypeMode"},{text:"photo_editor",handler:x("EDITOR"),isSelected:"EDITOR",mode:"projectTypeMode"},{text:"collage_maker",handler:x("COLLAGE"),isSelected:"COLLAGE",mode:"projectTypeMode"},{text:"graphic_designer",handler:x("DESIGNER"),isSelected:"DESIGNER",mode:"projectTypeMode"}]}],f=ls(os());BeFunky.contextMenu(f,{open:{onClick:function(){return E(h)}},rename:{onClick:function(){return function(e){var n=A(e),t=ls(qi(),r,r,n);BeFunky.confirm(t,{heading:"rename_project",confirmText:"rename",cancelText:"cancel",size:"extra-small",onConfirm:function(){var t={project:e,filename:n};BeFunky.requestAPI("photo/projects/update",t,{showLoadScreen:!0}).then(function(t){if("success"!==t.data)throw"invalid_response";!function(e,n){var t=w(c.allProjects),o=t.findIndex(function(n){return n.id===e});t[o].filename=n,l({allProjects:t})}(e,n)}).catch(function(e){BeFunky.logError(e),UIMessages.display(BeFunky.failureReason(e))})}});var o=t.parentElement.nextElementSibling.querySelector("button:nth-child(2)");function r(e){var r=t.value.replace(/^[.\s]+/,"");t.value=r,n=r.trim();var a,i=(a=n,c.allProjects.some(function(e){return e.filename===a}));t.toggleClass("project-manager__rename-input--border-red",i),o.disabled=i||!r,"Enter"!==e.key&&"Enter"!==e.code||o.disabled||o.click()}o.disabled=!0}(h)}},delete:{onClick:function(){return e=h,void BeFunky.confirm("confirm_designer_project_delete_befunky",{onConfirm:function(){BeFunky.showLoadScreen({isCancellable:!1}),BeFunky.SavedProjectFetcher.deleteBfdFile(e,function(n){var t=n.error;if(n.data,BeFunky.hideLoadScreen(),t)return BeFunky.logError(t),void UIMessages.display(BeFunky.failureReason(t));!function(e){var n=c.allProjects.filter(function(n){var t=n.id;return t!==e});l({allProjects:n}),n.length?l({allProjects:n}):(l({allProjects:n,searchTerm:""}),C("ALL_ORIENTATION")(),x("ALL_PROJECTS")(),BeFunky.SavedProjectFetcher.projectData.allProjectsFetched=!1)}(e),window.BFN&&BFN.DesignerTemplateManager&&BFN.DesignerTemplateManager.recentProjectsComponent&&BFN.DesignerTemplateManager.recentProjectsComponent.fetchProjects();var o=document.querySelector("dashboard-projects");o&&o.fetchProjects()})},confirmText:"yes",cancelText:"no",focusConfirmButton:!1});var e}}},{hoverOffEventTarget:document});var h=null;return Object.assign(n,{open:function(){BeFunky.openModal(n,{onOpen:function(){var e=BeFunky.isLoggedIn();l({isLoggedIn:e}),c.isLoggedIn?T():l({isLoading:!1})},onClose:function(){l({previousSearch:null})},onWindowResize:function(e){var n=e.availableWidth;l({galleryWidth:o+(n-t)})},size:"xxl"})}}),n;function m(){var e=R().map(function(e){return e.imageObject});return is(Wi(),e,c.isLoading,c.message,e.length?null:function(){if(!c.isLoggedIn)return{icon:"no-project-icon",text:"login_load_projects",buttonAction:M,buttonText:"sign_in"};if(!c.searchTerm&&!c.allProjects.length)return{icon:"no-project-icon",text:"no_saved_projects",linkText:"learn_more",linkHref:"https://support.befunky.com/hc/en-us/articles/360003279091-How-Do-I-Save-My-Project-So-I-Can-Edit-It-Later-"};if(c.searchTerm&&!c.allProjects.length)return{icon:"no-results-icon",text:["no_results_for",{query:'"<strong>'.concat(BeFunky.escapeHTML(c.searchTerm),'</strong>"')}]};return{icon:"no-results-icon",text:"no_results"}}(),215,c.galleryWidth,function(){return"gallery__item--has-content"},function(e){return E(e.id)},y,function(e){return A(e)})}function y(e){return is(Vi(),function(n){return function(e,n){e.stopPropagation(),F(e,n.id)}(n,e)})}function v(n){n&&n.preventDefault(),T(e.value)}function _(){T()}function b(e){return function(){l(s({},{ALL_ORIENTATION:"orientationMode",ALL_PROJECTS:"projectTypeMode"}[e],e))}}function F(e,n){h=n,f.handleTargetClick(e)}function B(e){return function(){l({viewMode:e})}}function E(e){var n=c.allProjects.find(function(n){return n.id===e});if(window.isFlashOpenned){var t=n.imageObject.lastRenderedThumb||{},o=t.renderedWidth,r=void 0===o?0:o,a=t.url,i=r>=308?a:void 0;BeFunky.SavedProjectManager.openUserSavedProject(n,i).catch(function(e){"cancelled_by_user"!==e&&BeFunky.logError("Failed to open user-saved project",e)})}else{var s=n.project_type;if(!["editor","collage","designer"].includes(s))return BeFunky.throwError("Invalid project_type",s);BeFunky.projectToOpenInSection[s]={userSavedProjectData:n};BeFunky.pushRoute({editor:"/create/",collage:"/create/collage/",designer:"/create/designer/"}[s])}}function L(){l({sortMode:"RELEVANT"})}function I(){l({sortMode:"MODIFIED"})}function S(){l({sortMode:"CREATED"})}function P(){l({sortMode:"NAME"})}function C(e){return function(){l({orientationMode:e})}}function x(e){return function(){l({projectTypeMode:e})}}function T(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=n.trim();(e&&(e.value=t),t!==c.previousSearch)&&(l({isLoading:!0,allProjects:[],searchTerm:t,sortMode:t?"RELEVANT":"MODIFIED",previousSearch:t,message:null}),C("ALL_ORIENTATION")(),x("ALL_PROJECTS")(),(n?BeFunky.SavedProjectFetcher.searchProjects(n):BeFunky.SavedProjectFetcher.getAllProjects()).then(function(e){var n=function(e){var n=40*(BeFunky.isRetina()?2:1);return e.map(function(e){return e.id=e.templateid,e.creationDate=new Date(e.date),e.modifiedDate=new Date(e.modified),e.listViewThumbURL=BeFunky.addParamsToURL(e.thumburl,{width:n,height:n,fit:"crop",auto:"webp"}),e.imageObject=function(e){return{id:e.id,getImageURL:function(n){return BeFunky.SavedProjectManager.getThumbURL(e,n)},thumbWidth:e.width,thumbHeight:e.height,isTransparent:/\.png(\?|$)/.test(e.thumburl)}}(e),e})}(e);l({allProjects:n,isLoading:!1})}).catch(function(e){l({isLoading:!1,allProjects:[]}),"no_results"!==e&&(BeFunky.logError(e),l({previousSearch:null,message:{isError:!0,text:BeFunky.failureReason(e),buttonText:"try_again",buttonAction:function(){return T(t)}}}))}))}function A(e){return c.allProjects.find(function(n){return n.id===e}).filename}function R(){var e=c.allProjects.filter(function(){var e=c.orientationMode;if("HORIZONTAL"===e)return function(e){return e.width>e.height};if("VERTICAL"===e)return function(e){return e.width<e.height};if("SQUARE"===e)return function(e){return e.width===e.height};return function(){return!0}}()).filter(function(){var e=c.projectTypeMode;if("ALL_PROJECTS"===e)return function(){return!0};if("EDITOR"===e)return function(e){return"editor"===e.project_type};if("COLLAGE"===e)return function(e){return"collage"===e.project_type};if("DESIGNER"===e)return function(e){return"designer"===e.project_type}}()),n=function(){var e=c.sortMode;if("MODIFIED"===e)return function(e,n){var t=e.modifiedDate,o=n.modifiedDate;return o-t};if("CREATED"===e)return function(e,n){var t=e.creationDate,o=n.creationDate;return o-t};if("NAME"===e)return function(e,n){var t=e.filename.toUpperCase(),o=n.filename.toUpperCase();return t<o?-1:t>o?1:0}}();return"function"==typeof n&&e.sort(n),e}function M(){BeFunky.openLoginPanel("SIGNIN")}function U(e){var n=new Date(e.getTime()),t=n.getTimezoneOffset()/60*-1;n.setHours(n.getHours()+t);var o=BeFunky.LanguageManager.language.modal,r=n.toLocaleString(o,{year:"numeric",month:"numeric",day:"numeric",hour12:!0,hour:"2-digit",minute:"2-digit"});return"en"===o&&(r=r.replace(/-/g,"/").replace(","," at")),r}};var gs=!1;if("undefined"!=typeof window){var ps={get passive(){gs=!0}};window.addEventListener("testPassive",null,ps),window.removeEventListener("testPassive",null,ps)}var fs,hs,ms,ys,vs,_s="undefined"!=typeof window&&window.navigator&&window.navigator.platform&&(/iP(ad|hone|od)/.test(window.navigator.platform)||"MacIntel"===window.navigator.platform&&window.navigator.maxTouchPoints>1),ks=[],ws=!1,bs=-1,Fs=function(e){return ks.some(function(n){return!(!n.options.allowTouchMove||!n.options.allowTouchMove(e))})},Bs=function(e){var n=e||window.event;return!!Fs(n.target)||(n.touches.length>1||(n.preventDefault&&n.preventDefault(),!1))},Es=function(e,n){if(_s){if(!e)return void console.error("disableBodyScroll unsuccessful - targetElement must be provided when calling disableBodyScroll on IOS devices.");if(e&&!ks.some(function(n){return n.targetElement===e})){var t={targetElement:e,options:n||{}};ks=[].concat(w(ks),[t]),e.ontouchstart=function(e){1===e.targetTouches.length&&(bs=e.targetTouches[0].clientY)},e.ontouchmove=function(n){1===n.targetTouches.length&&function(e,n){var t=e.targetTouches[0].clientY-bs;!Fs(e.target)&&(n&&0===n.scrollTop&&t>0?Bs(e):function(e){return!!e&&e.scrollHeight-e.scrollTop<=e.clientHeight}(n)&&t<0?Bs(e):e.stopPropagation())}(n,e)},ws||(document.addEventListener("touchmove",Bs,gs?{passive:!1}:void 0),ws=!0)}}else{!function(e){setTimeout(function(){if(void 0===hs){var n=!!e&&!0===e.reserveScrollBarGap,t=window.innerWidth-document.documentElement.clientWidth;n&&t>0&&(hs=document.body.style.paddingRight,document.body.style.paddingRight="".concat(t,"px"))}void 0===fs&&(fs=document.body.style.overflow,document.body.style.overflow="hidden")})}(n);var o={targetElement:e,options:n||{}};ks=[].concat(w(ks),[o])}},Ls=function(){_s?(ks.forEach(function(e){e.targetElement.ontouchstart=null,e.targetElement.ontouchmove=null}),ws&&(document.removeEventListener("touchmove",Bs,gs?{passive:!1}:void 0),ws=!1),ks=[],bs=-1):(setTimeout(function(){void 0!==hs&&(document.body.style.paddingRight=hs,hs=void 0),void 0!==fs&&(document.body.style.overflow=fs,fs=void 0)}),ks=[])},Is=function(){var e=document.createElement("div").setClass("modal-root modal-root--is-inactive");return e.id="modal_root",BeFunky.onDocumentReady(function(){e.parentElement||document.body.appendChild(e)}),e}(),Ss=[],Ps={"extra-small":[320],small:[400],"small-nebula":[464],medium:[720],"medium-nebula":[624],large:[960],"large-nebula":[944],"extra-large":[1280,800],xxl:[1600,1140]};function Cs(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=function(e){if(e instanceof HTMLElement){if(!e.id)throw new Error("Modal elements must have unique IDs");return{modalElement:e,modalID:e.id}}if("string"==typeof e){var n=document.getElementById(e);if(!n)throw new Error("Unable to get modal element with id = ".concat(e));return{modalElement:n,modalID:e}}throw new Error("Invalid modal element or id: ".concat(BeFunky.getType(e)))}(e),o=t.modalElement,r=t.modalID,a={closeOnClickOutside:!0,closeOnEscape:!0,destroyOnClose:!1,isCritical:!1,isDialog:!1,addSiteClass:!1,addCloseButton:!1,onOpen:void 0,onClose:void 0,onWindowResize:void 0,onArrowClick:void 0,size:void 0};"string"==typeof n.size&&(Object.keys(Ps).includes(n.size)?n.size=Ps[n.size]:(BeFunky.throwError("Invalid modal size: ".concat(n.size," - ").concat(BeFunky.getType(n.size))),n.size=void 0)),n=Object.assign({},a,n);var i,s,u,c=Ss.findIndex(function(e){return e.modalID===r}),l=-1!==c,d=l?Ss[c]:(i=function(e){var n=document.createElement("div").setClass("modal-root__outer"),t=document.createElement("div").setClass("modal-root__inner");return n.appendChild(t),t.appendChild(e),{outerContainer:n,innerContainer:t}}(o),s=i.innerContainer,u=i.outerContainer,{modalID:r,modalElement:o,isVisible:!0,innerContainer:s,outerContainer:u});if(Object.assign(d,n),l&&Ss.splice(c,1),d.isCritical)Ss.push(d);else{var g=Ss.findIndex(function(e){return e.isCritical});-1===g?Ss.push(d):Ss.splice(g,0,d)}d.lastOpened=Date.now(),function(e){var n="function"==typeof e.onArrowClick,t=Array.isArray(e.arrowButtons);if(n===t)return;n?function(e){var n=function(n){var t="".concat(window.isFlashOpenned?"grey":"white"),o=document.createElement("div").setClass("modal-root__arrow-container"),r=document.createElement("button").setClass("modal-root__arrow-button modal-root__arrow-button--".concat(n," button button--icon button--").concat(t));return r.setAttribute("aria-label",BeFunky.LanguageManager.getString("left"===n?"previous":"next","modal")),r.innerHTML=BeFunky.getSvgHtml("global-arrow-down-icon"),r.addEventListener("click",function(){return e.onArrowClick(n)}),o.appendChild(r),{container:o,button:r}},t=n("left"),o=t.button,r=t.container,a=n("right"),i=a.button,s=a.container;e.arrowButtons=[o,i];var u=e.outerContainer;u.insertBefore(r,e.innerContainer),u.appendChild(s)}(e):function(e){e.arrowButtons.map(function(e){return e.parentElement}).forEach(function(n){e.outerContainer.removeChild(n)}),delete e.arrowButtons}(e)}(d),function(e){var n=!0===e.addCloseButton,t=!!e.closeButton;if(n===t)return;n?function(e){var n=document.createElement("button").setClass("button button--icon modal-root__close-button");n.setAttribute("aria-label","Close"),n.innerHTML=BeFunky.getSvgHtml("global-cancel-icon"),n.addEventListener("click",function(){try{n.dispatchEvent(new Event("CLOSE"))}catch(e){BeFunky.logError("Unable to dispatch event on close button",e)}}),e.closeButton=n,e.innerContainer.appendChild(n)}(e):function(e){e.innerContainer.removeChild(e.closeButton)}(e)}(d),d.outerContainer.toggleClass("site",Boolean(d.addSiteClass)),l?(d.outerContainer.removeClass("modal-root__outer--is-hidden"),d.isVisible=!0):function(e){Is.appendChild(e)}(d.outerContainer);var p=Ss.filter(function(e){return e.isVisible});p.forEach(function(e,n){var t=e.outerContainer;t.setStyles({zIndex:n+1}),t.toggleClass("modal-root__outer--is-bottommost",0===n),t.toggleClass("modal-root__outer--is-topmost",n===p.length-1)}),ms=p[p.length-1],Ms([d]),ys=document.activeElement,Ts(),"function"==typeof d.onOpen&&d.onOpen(),requestAnimationFrame(function(){p[p.length-1]===d&&Rs(d.outerContainer)}),window.zE&&window.zE.hide&&window.zE.hide()}function xs(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],t="string"==typeof e?e:e.id;if(!t)throw new Error("Missing modal ID");var o=Ss.findIndex(function(e){return e.modalID===t});if(-1!==o){var r,a=Ss[o];a.outerContainer.addClass("modal-root__outer--is-hidden"),a.isVisible=!1,(ms=Ss.slice().reverse().find(function(e){return e.isVisible}))&&ms.outerContainer.addClass("modal-root__outer--is-topmost"),As(a.destroyOnClose)&&(Ss.splice(o,1),r=a.outerContainer,Is.removeChild(r)),ms?ms.modalElement.contains(ys)&&ys.offsetParent?ys.focus():Rs(ms.outerContainer):ys&&ys.offsetParent&&ys.focus(),Ts(),"function"==typeof a.onClose&&a.onClose()}else if(n)throw new Error("Specified modal ".concat(t," is not on screen"))}function Ts(){Is.toggleClass("modal-root--is-inactive",!ms).toggleClass("modal-root--is-dialog",ms&&ms.isDialog),ms?Es(Is):Ls()}function As(e){return"function"==typeof e&&(e=e()),!!e}function Rs(e){var n=e.querySelector(".focus-initially");if(n){var t=n.style.transition;n.setStyles({transition:"none"}),BeFunky.focus(n),n.setStyles({transition:t})}else e.setAttribute("tabindex","0"),e.focus(),e.addEventListener("blur",function n(){e.removeEventListener("blur",n),e.removeAttribute("tabindex")})}function Ms(e){requestAnimationFrame(function(){var n={availableWidth:window.innerWidth-32,availableHeight:window.innerHeight-32},t=n.availableWidth,o=n.availableHeight;e.filter(function(e){var n=e.isVisible,t=e.size,o=e.onWindowResize;return n&&(t||"function"==typeof o)}).reverse().forEach(function(e){var n=e.onWindowResize,r=e.size,a=e.modalElement;if(r){var i=k(r,2),s=i[0],u=i[1],c=Math.min(t,s),l=u?Math.min(o,u):o;return a.setStyles({width:"".concat(c,"px"),height:u?"".concat(l,"px"):""}),void("function"==typeof n&&n({availableWidth:c,availableHeight:l}))}"function"==typeof n&&n({availableWidth:t,availableHeight:o})})})}function Us(e){if(e instanceof HTMLElement&&["BUTTON","A"].includes(e.nodeName))return e;var n=document.createElement("button").setClass("dialog__button button");return Ds(e.text,n),"string"==typeof e.type?n.addClass("button--".concat(e.type)):Array.isArray(e.type)&&e.type.forEach(function(e){n.addClass("button--".concat(e))}),e.focusInitially&&n.addClass("focus-initially"),"function"==typeof e.onClick&&n.addEventListener("click",e.onClick),n}function Ds(e,n){return!!e&&("string"==typeof e?(n.setLang(e,void 0,"modal"),!0):e instanceof HTMLElement?(n.appendChild(e),!0):Array.isArray(e)&&"string"==typeof e[0]?(n.setLang(e[0],e[1],"modal"),!0):(BeFunky.logError("Invalid content passed to dialog",e),!1))}function Os(){var e=_(["<p>","</p>"]);return Os=function(){return e},e}function js(){var e=_(["<button @click="," class="," style=",">","</button>"]);return js=function(){return e},e}function Ns(){var e=_(["<a href=",' rel="noopener" target="_blank" class='," style=",">","</a>"]);return Ns=function(){return e},e}function Hs(){var e=_(['<div class="dialog__image" style=',"></div>"]);return Hs=function(){return e},e}function qs(){var e=_(['\n            <div class="dialog__illustration">\n                <div class="dialog__illustration-max-width">\n                    <div class="dialog__illustration-image" style=',">\n                </div>\n            </div>"]);return qs=function(){return e},e}function Vs(){var e=_(['<div class="dialog__heading h4">',"</div>"]);return Vs=function(){return e},e}function Ws(){var e=_(["\n        ",'\n        <div class="dialog__body">\n            ',"\n            ",'\n            <div class="dialog__footer">\n                ',"\n            </div>\n        </div>"]);return Ws=function(){return e},e}function Gs(){var e=_(["<div class=","></div>"]);return Gs=function(){return e},e}BeFunky.addArrowKeyHandler({condition:function(){return ms&&"function"==typeof ms.onArrowClick},callback:function(e,n,t){if("keyup"===t.type&&("left"===n||"right"===n)){var o="left"===n?0:1;ms.arrowButtons[o].disabled||ms.onArrowClick(n)}}}),document.addEventListener("keyup",function(e){if(27===e.which&&ms){var n=ms,t=n.modalID,o=n.closeOnEscape;e.stopImmediatePropagation(),As(o)&&(xs(t),BeFunky.reportUserAction("User closed ".concat(t," modal by pressing Escape")))}}),vs=!1,Is.addEventListener(BeFunky.pointerdown,function(e){vs=ms.outerContainer!==e.target}),Is.addEventListener("click",function(e){if(!vs&&ms){var n=ms,t=n.outerContainer,o=n.closeOnClickOutside,r=n.modalID;e.target===t&&(Date.now()-ms.lastOpened<500||As(o)&&(xs(r),BeFunky.reportUserAction("User closed ".concat(r," modal by clicking outside"))))}}),Is.addEventListener("CLOSE",function(e){var n=e.target.closest(".modal-root__inner"),t=n.firstElementChild;n===ms.innerContainer?xs(t):BeFunky.throwError("CLOSE fired unexpectedly in non-topmost modal",t.id,ms.modalElement.id)},!0),window.addEventListener("resize",BeFunky.debounce(function(){return Ms(Ss.slice())},100)),BeFunky.openModal=Cs,BeFunky.closeModal=xs,BeFunky.toggleModal=function(e,n,t){e?Cs(n,t):xs(n)},BeFunky.getModal=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,n="string"==typeof e?Ss.find(function(n){return n.modalID===e}):ms;return n?Object.assign({},n):void 0},BeFunky.isModalOpen=function(){return!!ms},BeFunky.moveModalRoot=function(e){e!==Is.parentElement&&e.appendChild(Is)},BeFunky.getModalSizes=function(){return Ps},BeFunky.showDialog=function(e){var n=e.onClose,t=e.heading,o=e.body,r=e.buttons,a=void 0===r?[]:r,i=e.isCritical,s=void 0!==i&&i,u=e.disableClose,c=void 0!==u&&u,l=e.size,d=void 0===l?"small":l,g=e.imageUrl,p=e.isDialog,f=void 0===p||p,h=e.addCloseButton,m=void 0!==h&&h,y=e.addSiteClass,v=e.closeOnClickOutside,_=void 0!==v&&v,k=document.createElement("div").addClass("dialog"),w=document.createDocumentFragment();if(g&&g.includes(".svg")&&(g=""),g){d="large",k.addClass("dialog--card");var b=document.createElement("div").addClass("dialog__image").setStyles({backgroundImage:"url('".concat(g,"')")});w.appendChild(b)}void 0===y&&(y=!!g);var F=document.createElement("div").setClass("dialog__body-container"),B=document.createElement("h4").setClass("dialog__heading"),E=document.createElement("div").addClass("dialog__body"),L=document.createElement("div").addClass("dialog__footer");if(Ds(t,B)&&F.appendChild(B),!Ds(o,E))throw new Error("dialog body required");F.appendChild(E),F.appendChild(L),a.map(Us).forEach(function(e){L.appendChild(e),e.addEventListener("click",C)}),w.appendChild(F);var I=F.textContent.replace(/\s+/g," ");console.log("Opening dialog:",I.length>35?"".concat(I.slice(0,35),"..."):I),k.id="dialog_".concat(BeFunky.hash(I+s+c+d+g));var S=document.getElementById(k.id);S?(S.innerHTML="",S.appendChild(w)):k.appendChild(w);var P={onClose:n,destroyOnClose:!0,isCritical:s,size:d,isDialog:f,closeOnClickOutside:_,addCloseButton:m,addSiteClass:y};return c&&(Object.assign(P,{onClose:function(){BeFunky.throwError("User closed dialog which should never be closed",{content:k.textContent})},closeOnEscape:!1}),k.addClass("dialog--disable-close")),BeFunky.openModal(k,P),C;function C(){BeFunky.closeModal(k.id,!1)}};var zs=BeFunky.lit,Xs=zs.elem,Js=zs.html,$s=zs.modalLang,Ys=zs.isTemplateResult,Ks=zs.render;function Qs(){var e=_(['\n        <div class="toast">\n            ','\n            <button class="button button--blue toast__button" @click=',">",'</button>\n            <button class="button button--icon button--small toast__button" @click=',">","</button>\n        </div>\n    "]);return Qs=function(){return e},e}BeFunky.openNebulaDialog=function(e){var n=e.heading,t=e.body,o=e.buttons,r=void 0===o?[]:o,a=e.imageUrl,i=e.figure,s=e.className,u=void 0===s?"":s,c=e.modalOptions,l=(c=void 0===c?{}:c).size,d=c.isDialog,g=void 0===d||d,p=c.addCloseButton,f=void 0!==p&&p,h=c.addSiteClass,m=void 0===h||h,y=c.closeOnClickOutside,v=void 0!==y&&y,_=c.isCritical,k=void 0!==_&&_,w=c.disableClose,b=void 0!==w&&w,F=c.onClose,B=void 0===F?function(){}:F,E=Boolean(i||a);l=l||(E?"medium-nebula":"small-nebula"),E&&"small"===l&&BeFunky.reportWarning("Small dialog used with image",t);var L=["dialog",E?"dialog--has-figure":"",a&&a.includes(".svg")?"dialog--has-illustration":"",u].filter(Boolean).join(" "),I=Xs(Gs(),L);C(),BeFunky.LanguageManager.addLanguageUpdateListener(C);var S=I.textContent.replace(/\s+/g," ");console.log("Opening dialog:",S.length>35?"".concat(S.slice(0,35),"..."):S),I.id="dialog_".concat(BeFunky.hash(S)),document.getElementById(I.id)&&BeFunky.throwError("Duplicate dialog already open",S);var P={onClose:function(){B(),BeFunky.LanguageManager.removeLanguageUpdateListener(C)},destroyOnClose:!0,isCritical:k,size:l,isDialog:g,closeOnClickOutside:v,addCloseButton:f,addSiteClass:m};return b&&(Object.assign(P,{onClose:function(){BeFunky.throwError("User closed dialog which should never be closed",{content:I.textContent}),BeFunky.LanguageManager.removeLanguageUpdateListener(C)},closeOnEscape:!1}),I.addClass("dialog--disable-close")),BeFunky.openModal(I,P),x;function C(){Ks(Js(Ws(),i||function(e,n){if(e){if(e.includes(".svg"))return Js(qs(),"background-image: url('".concat(e,"')"));var t=BeFunky.getModalSizes()[n];if(t&&t[0]){var o=t[0];e=BeFunky.addParamsToURL(e,{width:Math.round(o*(BeFunky.isRetina()?1.5:1))})}return Js(Hs(),"background-image: url('".concat(e,"')"))}return""}(a,l),n?Js(Vs(),$s(n)):"",function e(n){return n?"function"==typeof n?e(n()):"string"==typeof n||Array.isArray(n)&&"string"==typeof n[0]?Js(Os(),$s(n)):n instanceof HTMLElement||Ys(n)?n:(BeFunky.logError("Invalid content passed to dialog",n),""):""}(t),r.map(function(e){return function(e,n){var t,o=e.text,r=e.type,a=e.focusInitially,i=void 0!==a&&a,s=e.href,u=e.style,c=void 0===u?"":u,l=e.onClick,d=(t=["button","button--lg","dialog__button","string"==typeof r?"button--".concat(r):"",Array.isArray(r)?r.map(function(e){return"button--".concat(e)}):"",i?"focus-initially":""],t.reduce(function(e,n){return e.concat(n)},[])).filter(Boolean);if(s){if(l)throw new Error("onClick not supported by links");return Js(Ns(),s,d.join(" "),c,$s(o))}return Js(js(),function(e){"function"==typeof l&&l(e),n()},d.join(" "),c,$s(o))}(e,x)})),I)}function x(){BeFunky.closeModal(I.id,!1)}},BeFunky.acknowledge=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=n.onAcknowledge,o=n.buttonText,r=void 0===o?"ok_got_it":o,a=n.heading,i=n.isCritical,s=void 0!==i&&i,u=n.disableClose,c=void 0!==u&&u,l=n.size,d=n.focusButton,g=void 0===d||d,p=n.imageUrl,f=void 0===p?"":p;if(!(("string"==typeof e||Array.isArray(e))&&e.length||e instanceof HTMLElement))throw new Error("message required");return window.isFlashOpenned?BeFunky.showDialog({onClose:t,buttons:[{text:r,type:"blue",focusInitially:g}],heading:a,body:e,isCritical:s,disableClose:c,size:l}):BeFunky.openNebulaDialog({heading:a,body:e,imageUrl:f,buttons:[{text:r,type:"dark-blue",focusInitially:g}],modalOptions:{onClose:t,isCritical:s,disableClose:c,size:l}})},BeFunky.confirm=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=n.onConfirm,o=n.onCancel,r=void 0===o?function(){}:o,a=n.confirmText,i=void 0===a?"ok":a,s=n.cancelText,u=void 0===s?"cancel":s,c=n.heading,l=n.isCritical,d=void 0!==l&&l,g=n.size,p=n.imageUrl,f=void 0===p?void 0:p,h=n.focusConfirmButton,m=void 0===h||h;if(!(("string"==typeof e||Array.isArray(e))&&e.length||e instanceof HTMLElement||BeFunky.lit.isTemplateResult(e)||"function"==typeof e))throw new Error("message required");if("function"!=typeof t)throw new Error("onConfirm callback required");var y=!1,v=!1,_=function(){y?t():r(v)},k=[{text:u,type:window.isFlashOpenned?"grey":"medium-grey",onClick:function(){v=!0}},{text:i,type:[window.isFlashOpenned?"blue":"dark-blue","ellipsis"],onClick:function(){y=!0},focusInitially:m}];return window.isFlashOpenned?BeFunky.showDialog({onClose:_,buttons:k,heading:c,body:e,isCritical:d,size:g||"small",imageUrl:f}):BeFunky.openNebulaDialog({heading:c,body:e,buttons:k,imageUrl:f,modalOptions:{isCritical:d,size:g,imageUrl:f,onClose:_}})};var Zs,eu=BeFunky.lit,nu=eu.elem,tu=eu.icon,ou=eu.lang;function ru(e){e===Zs&&(Zs=void 0,e.addClass("toast--is-hidden"),setTimeout(function(){requestAnimationFrame(function(){e.parentElement.removeChild(e)})},75))}BeFunky.showToast=function(e){var n=e.message,t=e.button,o=e.onAccept,r=void 0===o?function(){}:o,a=e.onDismiss,i=void 0===a?function(){}:a;Zs&&ru(Zs);var s=nu(Qs(),ou(n),function(){ru(s),r()},ou(t),function(){ru(s),i()},tu("global-cancel-icon","icon"));function u(){requestAnimationFrame(function(){requestAnimationFrame(function(){s===Zs&&s.addClass("toast--is-active")})})}return Zs=s,document.body.appendChild(s),"visible"===document.visibilityState?u():document.addEventListener("visibilitychange",function e(){"visible"===document.visibilityState&&(document.removeEventListener("visibilitychange",e),u())}),function(){return ru(s)}};var au=[".navbar-dropdown",".popover",".modal-root__outer",".side-panel .tool-menu",".preset-menu","#alternateMenu",".dropdown__list",".preset-menu-item-basic-settings","#globalHistoryMenu",".canvas-footer",".site-nav__dropdown-content",".site-nav__popup-root",".focus-trap"].join(", "),iu=[".focus-avoid",".popover:not(.active)",".image-gallery__images",".image-manager__images",".tab__panel:not(.active)",".tab__button.active",".accordion__panel",".control-item-disabled",".autocomplete__item--selected:first-child"].join(", ");function su(e,n,t){var o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(e)return"function"==typeof e.delegateFocus?su(e.delegateFocus(n),n,t):void(e.focus&&e!==document.activeElement&&(t&&function(e){if(e.hasClass("button"))return void uu(e,function(){return e.addClass("button--focus")},function(){return e.removeClass("button--focus")});"A"===e.nodeName&&uu(e,function(){return e.addClass("link--focus")},function(){return e.removeClass("link--focus")});if("INPUT"!==e.nodeName)return;if("checkbox"===e.type){var n=e.parentElement;if(n&&n.hasClass("checkbox"))return void uu(e,function(){return n.addClass("checkbox--focus")},function(){return n.removeClass("checkbox--focus")});var t=e.nextElementSibling;return void(t&&t.hasClass("button--toggle")&&uu(e,function(){return t.addClass("button--focus")},function(){return t.removeClass("button--focus")}))}if("radio"===e.type){var o=e.parentElement;if(!o)return;o.hasClass("toggle-group__label")?uu(e,function(){return o.addClass("toggle-group__label--focus-within")},function(){return o.removeClass("toggle-group__label--focus-within")}):o.hasClass("radio-button")&&uu(e,function(){return o.addClass("radio-button--focus-within")},function(){return o.removeClass("radio-button--focus-within")})}}(e),e.focus(),o&&"input"===e.tagName.toLowerCase()&&e.select()))}function uu(e,n,t){n(),e.addEventListener("blur",function n(){e.removeEventListener("blur",n),t()})}function cu(e){var n={upgrade:function(){BeFunky.openUpgradePanel(null,!0)},register:function(){BeFunky.openLoginPanel("REGISTER")},sign_in:function(){BeFunky.openLoginPanel("SIGNIN")},sign_out:function(){BeFunky.signOut()},pay:function(){BeFunky.openPaymentPanel(jt())},get_started_header:function(){return lu("HEADER")},get_started:function(){return lu()}};return n[e]?n[e]():BeFunky.isCreateRoute(e)?(BeFunky.throwError('Unexpected deep link handled like button: "'.concat(e,'"')),BeFunky.pushRoute(e)):void BeFunky.throwError('Unhandled Prismic button action: "'.concat(e,'" (').concat(BeFunky.getType(e),")"))}function lu(e){if(!BeFunky.Params.canUseWebapp)return BeFunky.trackDeepLink("GET-STARTED",e),BeFunky.handleMobileUserAttemptToOpenApp("web_mobile_apps");var n=document.getElementById("get_started_modal");w(n.querySelectorAll("img")).forEach(function(e){return window.loadLazyImage(e)}),BeFunky.openModal(n,{size:"large",addCloseButton:!0})}function du(){var e=_(["\n        <div class="," style=",'>\n            <div class="loading-spinner"></div> <string>',"</string>\n        </div>"]);return du=function(){return e},e}function gu(){var e=_(["<p><a href=",' target="_blank" rel="noopener">',"</a></p>"]);return gu=function(){return e},e}function pu(){var e=_(["<button @click=",' class="button button--blue">',"</button>"]);return pu=function(){return e},e}function fu(){var e=_(["<p>","</p>"]);return fu=function(){return e},e}function hu(){var e=_(["<img src=",' class="gallery__empty-state-image" alt="no results"/>']);return hu=function(){return e},e}function mu(){var e=_(["\n        <div class=",">\n            ","\n            ","\n            ","\n            ","\n            ","\n        </div>"]);return mu=function(){return e},e}function yu(){var e=_(["<button @click="," class=",">","</button>"]);return yu=function(){return e},e}function vu(){var e=_(["<string>","</string>"]);return vu=function(){return e},e}function _u(){var e=_(["\n        <div class="," style=",">\n            ","\n            ","\n        </div>"]);return _u=function(){return e},e}function ku(){var e=_(['<div class="gallery__item gallery__item--bookend" style=',"></div>"]);return ku=function(){return e},e}function wu(){var e=_(['<div style="position: absolute; top: 31.8%; background: white; color: black; padding: 0 4px;">'," : "," : ","</div>"]);return wu=function(){return e},e}function bu(){var e=_(["\n        <div class="," style="," .imageRef="," .isSelected="," .renderedImageURL="," data-bfntooltip=",'>\n            <div class="gallery__placeholder" style=',">",'</div>\n            <div class="gallery__item-outline">',"</div>\n            ","\n            ","\n        </div>"]);return bu=function(){return e},e}function Fu(){var e=_(["<div style=","></div>"]);return Fu=function(){return e},e}function Bu(){var e=_(['<div class="gallery__row" style=',">","</div>"]);return Bu=function(){return e},e}function Eu(){var e=_(['<div class="gallery__items" @click='," style=",">","</div>"]);return Eu=function(){return e},e}function Lu(){var e=_(["\n            ","\n            ","\n            ","\n            ","\n        "]);return Lu=function(){return e},e}BeFunky.onDocumentReady(function(){var e=[document.getElementById("bfn-app"),document.getElementById("modal_root"),document.getElementById("site_root")].filter(Boolean);document.addEventListener("keydown",function(n){!function(n){if("Tab"!==n.key&&9!==n.keyCode)return;if(!e.some(function(e){return e.contains(n.target)}))return;if(n.preventDefault(),BeFunky.isPointerDown)return;BeFunky.handleNextFocus(n.target,n.shiftKey?-1:1)}(n)}),BeFunky.handleNextFocus=function(n,t){var o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];t=parseInt(t),isNaN(t)&&(t=1);var r=n.closestParent(function(n){return e.includes(n)||n.matches(au)});if(!(!r||e.includes(r)&&"site_root"!==r.id||r.matches(iu))){var a=Pt(r);w(r.querySelectorAll(iu)).forEach(function(e){a=a.filter(function(t){return!e.contains(t)||t===n})});var i=a.indexOf(n);if(0!==a.length&&(1!==a.length||r!==a[0]||0===t)){var s=(i+=t)<0||i>a.length-1;if(s&&"function"==typeof r.exitFocusTrap)return r.exitFocusTrap(t);s&&(i=i<0?a.length-1:0),su(a[i],t,o)}}}}),BeFunky.focus=function(e){su(e,1,!0,!1)},BeFunky.onDocumentReady(function(){if(window.prismicButtonActions.length){var e=window.prismicButtonActions[window.prismicButtonActions.length-1],n=e.action,t=e.time,o=Date.now()-t;o<2e3?(console.log('Handling Prismic button action "'.concat(n,'" that occurred ').concat(o,"ms before befunky.core.js loaded or document was ready:")),cu(n)):BeFunky.logError('Prismic button action "'.concat(n,'" ignored b/c it occurred ').concat(o,"ms before befunky.core.js loaded or document was ready"))}window.onClickPrismicButton=function(e){cu(e)}}),BeFunky.onDocumentReady(function(){var e,n,t,o;e=Array.from(document.querySelectorAll(".comparison")),n=BeFunky.isIOS||BeFunky.isAndroid,t=n?"touchmove":BeFunky.pointermove,o=window.innerHeight,e.forEach(function(e){var r,a=e.getBoundingClientRect(),i=e.querySelector(".comparison__image-before-container"),s=e.querySelector(".comparison__handle"),u=Date.now(),c=0,l=!1,d=!1,g=function(n){e.toggleClass("comparison--show-text",n)},p=BeFunky.debounce(function(e){var n=100*e/a.width;i.setStyles({width:"".concat(n,"%")})},300),f=function(e){var n="number"==typeof e.pageX?e.pageX:e.touches[0].pageX;e.preventDefault&&a.height<o/2&&e.preventDefault();var t=a.width,d=Math.max(0,Math.min(t,n-a.x)),g=d-a.width/2,f=Math.abs(d-c);c=d;var h=Date.now(),m=h-u;function y(){i.setStyles({width:"".concat(d,"px")}),s.setStyles({transform:"translateX(".concat(g,"px)")}),p(d)}u=h,f>50&&m>50?(l||(l=!0,cancelAnimationFrame(r),i.setStyles({transition:""}),s.setStyles({transition:""})),r=requestAnimationFrame(y)):(l&&(l=!1,cancelAnimationFrame(r),i.setStyles({transition:"none"}),s.setStyles({transition:"none"})),y())},h=function(n){d||(d=!0,f(n),g(!0),e.addEventListener(t,f))},m=function(n){d&&(d=!1,g(!1),e.removeEventListener(t,f),n.type===BeFunky.pointerout&&n.pageX&&(a.right<n.pageX||a.left>n.pageX)&&f(n))};n?(e.addEventListener("touchstart",h),e.addEventListener("touchend",m)):(e.addEventListener(BeFunky.pointerdown,h),e.addEventListener(BeFunky.pointerover,function(e){BeFunky&&BeFunky.isPointerDown&&h(e)}),e.addEventListener(BeFunky.pointerup,m),e.addEventListener(BeFunky.pointerout,m)),window.addEventListener("resize",BeFunky.debounce(function(){a=e.getBoundingClientRect(),o=window.innerHeight;var n=parseFloat(i.style.width)/100*a.width;isNaN(n)||f({pageX:a.x+n})},300))})});var Iu=BeFunky.lit,Su=Iu.html,Pu=Iu.lang,Cu=Iu.icon,xu=Iu.useEffect,Tu=Iu.useMemo,Au=Iu.defineCustomElement,Ru=Iu.ifDefined,Mu=function(){for(var e,n=arguments.length,t=new Array(n),o=0;o<n;o++)t[o]=arguments[o];return(e=BeFunky).logFeature.apply(e,["image_gallery"].concat(t))};function Uu(){var e=this;this.init=function(){this.initPublicAPI(),this.initSearchForm(),this.initGallery()},this.initPublicAPI=function(){var e=this;BeFunky.explorePage.isAvailable=!0,BeFunky.explorePage.search=function(n){e.searchInput.value=n,e.loadSearchResults(n,1)},BeFunky.explorePage.openImage=function(n){if(!n)return e.closeModal();var t=e.gallery.images.find(function(e){return e.id==="befunky_photo_".concat(n)});t?e.openModal(t):BeFunky.logError("Unable to open Explore image",{imageID:n})}},this.initSearchForm=function(){var e=this;this.searchForm=this.querySelector(".search-box"),this.searchInput=this.querySelector(".search-box__input"),this.clearButton=this.querySelector(".search-box__clear"),this.searchButton=this.querySelector(".search-box__submit"),this.previousSearchQuery=null,this.previousSearchPage=-1,this.clearButton.addEventListener("click",function(){return e.searchInput.focus()}),this.searchForm.addEventListener("submit",this.handleSearch)},this.initGallery=function(){var e=this;this.gallery=this.querySelector(".explore__gallery");this.gallery.rowHeight=200,this.gallery.currentWidth=this.getCurrentWidth(),this.gallery.singleRow=!1,this.gallery.onSelectItem=function(n){return e.openModal(n),!1},this.gallery.context="site",this.gallery.addClass("gallery--use-borders"),window.addEventListener("resize",BeFunky.debounce(function(){return e.handleGalleryResize()},300))},this.loadSearchResults=function(e){var n=this,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.previousSearchQuery===e&&t<=this.previousSearchPage||(this.previousSearchQuery=e,this.previousSearchPage=t,BeFunky.pushRoute(e?"explore/photos/".concat(encodeURIComponent(e),"/"):"explore/"),1===t&&(this.gallery.images=[]),this.gallery.message="",this.gallery.isLoading=!0,this.toggleInteractivity(!1),function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,t=arguments.length>2?arguments[2]:void 0,o={start:100*(n-1),end:100};e&&e.length>0&&(o.keyword=e);BeFunky.requestAPI("photo/explore/",o).then(function(e){if(!Array.isArray(e.data))throw"invalid_response";if(!e.data.length)return t({error:"no_results"});var n=e.data.map(function(e){return{id:"befunky_photo_".concat(e.id),thumbWidth:200,thumbHeight:200,thumbURL:e.thumb_url,imageURL:e.url,nick:e.nick,title:e.title,dateCreated:e.dateCreated,isTransparent:/\.png(\?|$)/.test(e.url)}});return t({images:n})})}(e,t,function(o){var r=o.error,a=o.images;if(e===n.previousSearchQuery){if(n.gallery.isLoading=!1,n.toggleInteractivity(!0),r)return BeFunky.logError("Unable to fetch images",r),void("no_results"===r?(n.gallery.message="",n.gallery.emptyState={imageUrl:"".concat(BeFunky.Params.globalImagesPath,"site/illustrations/magnifying-glass-frown.svg"),text:BeFunky.LanguageManager.getStringReplacements("no_results_for",{query:'"<strong>'.concat(e,'</strong>"')})}):(n.gallery.message={isError:!0,text:BeFunky.failureReason(r),buttonText:"try_again",buttonAction:function(){return n.loadSearchResults(e,t)}},n.gallery.emptyState="",n.previousSearchPage=n.previousSearchPage-1));if(n.gallery.images=[].concat(w(n.gallery.images),w(a)),n.gallery.message="",!(a.length<100)){n.gallery.message={buttonText:"load_more",buttonAction:function(){return n.loadSearchResults(e,t+1)}}}}}))},this.toggleInteractivity=function(e){this.searchButton.disabled=!e,this.clearButton.disabled=!e},this.openModal=function(n){var t=e.previousSearchQuery?"explore/photos/".concat(e.previousSearchQuery,"/"):"explore/";BeFunky.openUserPhotoModal(n,e.gallery.images,t,!0)},this.closeModal=function(){BeFunky.closeUserPhotoModal()},this.getCurrentWidth=function(){return Math.min(1232,window.innerWidth)-(window.innerWidth>=768?96:window.innerWidth>=361?64:32)},this.handleSearch=function(n){n&&n.preventDefault();var t=e.searchInput.value.replace(/[+"<>^%]/gi," ").replace(/ {2,}/g," ").trim();e.searchInput.value=t,e.loadSearchResults(t)},this.handleGalleryResize=function(){window.isFlashOpenned||(e.gallery.currentWidth=e.getCurrentWidth())},this.init()}function Du(){var e=this;this.init=function(){this.initPublicAPI(),this.setMetaData(),this.initGallery(),this.initResults()},this.setMetaData=function(){this.userNickName=window.location.href.match(/\/gallery\/([^\/]+)/)[1],document.querySelector(".user-gallery__username").textContent=this.userNickName},this.initPublicAPI=function(){var e=this;BeFunky.galleryPage.isAvailable=!0,BeFunky.galleryPage.openImage=function(n){if(!n)return e.closeModal();var t=e.gallery.images.find(function(e){return e.id==="befunky_photo_".concat(n)});t?e.openModal(t):BeFunky.logError("Unable to open Gallery image",{imageID:n})}},this.initGallery=function(){var e=this;this.gallery=this.querySelector(".user-gallery__gallery");this.gallery.rowHeight=200,this.gallery.currentWidth=this.getCurrentWidth(),this.gallery.singleRow=!1,this.gallery.onSelectItem=function(n){return e.openModal(n),!1},this.gallery.context="site",this.gallery.addClass("gallery--use-borders"),window.addEventListener("resize",BeFunky.debounce(function(){return e.handleGalleryResize()},300))},this.initResults=function(){this.loadResults(1)},this.loadResults=function(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;n<=this.previousSearchPage||(this.previousSearchPage=n,1===n&&(this.gallery.images=[]),this.gallery.message="",this.gallery.isLoading=!0,function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,t=arguments.length>2?arguments[2]:void 0,o={start:100*(n-1),end:100,user_nick:e};BeFunky.requestAPI("photo/gallery",o).then(function(e){if(!Array.isArray(e.data))throw"invalid_response";if(!e.data.length)return t({error:"no_results"});var n=e.data.map(function(e){return{id:"befunky_photo_".concat(e.id),thumbWidth:200,thumbHeight:200,thumbURL:e.thumb_url,imageURL:e.url,nick:e.nick,title:e.title,dateCreated:e.dateCreated}});return t({images:n})}).catch(function(e){"user_does_not_exist"!==e?t({error:e}):window.location.href="".concat(BeFunky.Params.siteUrl,"404/")})}(this.userNickName,n,function(t){var o=t.error,r=t.images;if(e.gallery.isLoading=!1,o)return BeFunky.logError("Unable to fetch images",o),void("no_results"===o?(e.gallery.message="",e.gallery.emptyState={imageUrl:"".concat(BeFunky.Params.globalImagesPath,"site/illustrations/picture-frames.svg"),text:"no_photos"}):(e.gallery.message={isError:!0,text:BeFunky.failureReason(o),buttonText:"try_again",buttonAction:function(){return e.loadResults(n)}},e.gallery.emptyState="",e.previousSearchPage=e.previousSearchPage-1));if(e.gallery.images=[].concat(w(e.gallery.images),w(r)),e.gallery.message="",!(r.length<100)){e.gallery.message={buttonText:"load_more",buttonAction:function(){return e.loadResults(n+1)}}}}))},this.openModal=function(n){BeFunky.openUserPhotoModal(n,e.gallery.images,"gallery/".concat(e.userNickName,"/"),!0)},this.closeModal=function(){BeFunky.closeUserPhotoModal()},this.getCurrentWidth=function(){return Math.min(1232,window.innerWidth)-(window.innerWidth>=768?96:window.innerWidth>=361?64:32)},this.handleGalleryResize=function(){window.isFlashOpenned||(e.gallery.currentWidth=e.getCurrentWidth())},this.init()}function Ou(){var e=_(["\n                <button class="," @mousedown="," @touchstart=",">\n                    ","\n                </button>"]);return Ou=function(){return e},e}function ju(){var e=_(["\n        <button class="," @click=",'>\n            <span class="my-photos__edit-ellipsis">\n                <span></span><span></span><span></span>\n            </span>\n        </button>\n        <div class="my-photos__edit-popup">\n            <div class="my-photos__edit-popup-content" tabindex="0" @click=',">\n            ","\n            </div>\n        </div>\n        "]);return ju=function(){return e},e}Au("image-gallery",function(e){var n=this,t=e.onSelectItem,o=e.selectedImageIDs,r=e.getItemTooltip,a=e.extendItemTemplate,i=e.addItemClass,s=e.rowHeight,u=void 0===s?300:s,c=e.imagePadding,l=void 0===c?0:c,d=e.gutterWidth,g=void 0===d?16:d,p=e.minItemWidth,f=void 0===p?40:p,h=e.isLoading,m=void 0!==h&&h,y=e.images,v=void 0===y?[]:y,_=e.emptyState,b=void 0===_?null:_,F=e.message,B=void 0===F?null:F,E=e.currentWidth,L=void 0===E?1e3:E,I=e.debug,S=void 0!==I&&I,P=e.context,C=void 0===P?"app":P,x=e.viewport,T=e.singleRow,A=void 0!==T&&T;xu(function(){return n.addClass("gallery")},[]),xu(function(){return n.setStyles({width:"".concat(L,"px")})},[L]);var R=Tu(function(){if(!v.length)return[];var e=v.map(function(e,n){var t,o,r,a=(o=(t=e).thumbWidth,r=t.thumbHeight,o/r||1);return{id:e.id,aspectRatio:a,flex:a,groupID:e.groupID,imageIndex:n,indexInRow:-1,thumbURL:e.thumbURL,getImageURL:e.getImageURL,isTransparent:e.isTransparent,imageRef:e}}),n=e.slice();if(S){var t=n.map(function(e){return e.groupID}).filter(Boolean).unique().reduce(function(e,n){var t;return e[n]="#".concat(O(t=80)).concat(O(t)).concat(O(t)),e},{});n.forEach(function(e){e.color=t[e.groupID]})}var o,r=[];o=h();for(var a=0;a<n.length;a++){var i=n[a];if(0!==o.items.length){o.error=o.error||b(o.aspectRatios);var s=b([].concat(w(o.aspectRatios),[i.aspectRatio]));if(o.error>=s)m(i),o.error=s;else{if(!window.disableSwap){var c=y(a);if("ADDED"===c&&a++,!(i=n[a]))break}if(A)break;o=h(),m(i)}}else m(i)}if(function(){var e=u,n=r[r.length-2];if(n){var t=function(e){return e.reduce(function(e,n){return e+n})/e.length};Math.abs(t(n.aspectRatios)-t(o.aspectRatios))<2&&(e=Math.round(k(n.aspectRatios)))}var a=k([].concat(w(o.aspectRatios),[0]));if(!(a<e)){var i=o.aspectRatios.reduce(function(e,n){return e+n},0),s=a*i/e-i;s<0||A&&s<1||m({isBookend:!0,aspectRatio:s})}}(),!A){var l=[];if(r.forEach(function(e){e.items.forEach(function(e,n){n!==e.indexInRow&&console.error("rows is incorrect",n,e.indexInRow),e.isBookend||l.push(e)})}),n.length!==e.length)console.error("items does not match originalItems length",n.length,e.length);else if(l.length!==n.length)console.error("rows does not match items length",l.length,n.length);else if(!l.isIdenticalTo(n)){console.error("rows does not match items");var d=l.findIndex(function(e,t){return e!==n[t]});console.error(d,l[d],n[d],l,n)}}var p=0;return r.forEach(function(e){e.height=k(e.aspectRatios)+g,e.rowTopOffset=p,p+=e.height;var n=j(e.aspectRatios);e.items.forEach(function(t,o){n<1&&(t.flex=t.aspectRatio/n),t.height=e.height-g,t.width=t.height*t.flex,t.isFirst=0===o,t.isLast=o===e.items.length-1})}),Mu(r),r;function h(){var e={items:[],aspectRatios:[],error:0};return r.push(e),e}function m(e){e.indexInRow=o.items.length,o.items.push(e),o.aspectRatios.push(e.aspectRatio)}function y(e){var t=n.slice(e,e+10),a=_(o.items),i=_(t);if(a.length&&i.length){var s=o,u=s.error,c=s.aspectRatios,l={improvement:0,inRow:null,afterRow:null};a.forEach(function(e){i.forEach(function(n){if(e.groupID===n.groupID&&e.aspectRatio!==n.aspectRatio){var t=c.slice();t.splice(e.indexInRow,1,n.aspectRatio);var o=u-b(t);o>1&&o>l.improvement&&(l.improvement=o,l.inRow=e,l.afterRow=n)}})});var d,g,p,f,h,y=o.items[o.items.length-1];if(y.groupID&&i.forEach(function(e){if(y.groupID===e.groupID){var n=[].concat(w(c),[e.aspectRatio]),t=u-b(n);t>1&&t>l.improvement&&(l.improvement=t,l.inRow=null,l.afterRow=e)}}),l.improvement){var v=l.inRow,k=l.afterRow;return v?(Mu("Swapping in row #".concat(r.length-1),v.imageIndex,"<->",k.imageIndex,l),k.indexInRow=v.indexInRow,o.items.splice(v.indexInRow,1,k),o.aspectRatios.splice(v.indexInRow,1,k.aspectRatio),o.error=b(o.aspectRatios),g=v,p=k,f=(d=n).indexOf(g),h=d.indexOf(p),d[f]=p,d[h]=g,"SWAPPED"):(Mu("Adding to row #".concat(r.length-1),k.imageIndex,l),m(k),n.splice(n.indexOf(k),1),n.splice(e,0,k),"ADDED")}for(var B=r.length-1;B>0&&F(B);)B--}}function _(e){return e.filter(function(e){return e.groupID}).filter(function(e,n,t){return!t.slice(0,n).find(function(n){return n.groupID===e.groupID&&n.aspectRatio===e.aspectRatio})})}function k(e){var n=e.length;if(!n)return 0;var t=L-g*(n-1),o=j(e);return t/o}function b(e,n){var t=e.length;if(!t)return 0;var o=u,r=L-g*(t-1),a=j(e),i=a/e.length,s=r/a;Math.min.apply(Math,w(e))>1.5&&(o/=Math.min((i+1)/2,2)),e.length>1&&Math.max.apply(Math,w(e))<1/1.5&&(o*=Math.min((1/i+1)/2,2));var c=Math.abs(o-s);return e.forEach(function(e,o){if(!n||o!==t-1){var i=r*e/a;i<f&&(c+=Math.pow(f-i,2))}}),c}function F(e){var n=r[e],t=r[e-1];if(1===t.items.length)return!1;var o=t.items[t.items.length-1],a=[].concat(w(n.aspectRatios),[o.aspectRatio]),i=t.aspectRatios.slice();i.splice(t.items.length-1,1);var s=b(a),u=b(i),c=n.error-s,l=t.error-u,d=c+l;return!(d<=10)&&(Mu("Moving last item from row #".concat(e," down to start of row #").concat(e),{improvement:d}),t.items.pop(),t.aspectRatios.pop(),t.error=u,n.items.unshift(o),n.aspectRatios.unshift(o.aspectRatio),n.error=s,n.items.forEach(function(e,n){e.indexInRow=n}),!0)}},[v,u,L,f,g]),M=j(R.map(function(e){return e.height}));return Mu("Render",this.className),Su(Lu(),v.length?Su(Eu(),D,"height: ".concat(M,"px"),R.map(U)):"",function(){if(!B)return"";var e=B.isError,n=B.text,t=B.buttonText,o=B.buttonAction,r=["gallery__message",e?"gallery__message--is-error":"",L<400?"gallery__message--narrow":""].filter(Boolean).join(" "),a=v.length?"margin-bottom: ".concat(g,"px"):"",i="app"===C||"modal"===C&&window.isFlashOpenned?"button--grey":"button--secondary",s="button ".concat(e?"button--small button--white":i);return Su(_u(),r,a,n?Su(vu(),Pu(n,C)):"",t&&o?Su(yu(),o,s,Pu(t,C)):"")}(),function(){if(!b||m||v.length)return"";var e=b.icon,n=b.text,t=b.buttonText,o=b.buttonAction,r=b.linkText,a=b.linkHref,i=b.imageUrl,s=8*Math.round(Math.max(40,Math.min(96,L/10))/8),u=["gallery__empty-state",L<400?"gallery__empty-state--narrow":""].filter(Boolean).join(" ");return Su(mu(),u,i?Su(hu(),i):"",e?Cu(e,"icon",{style:"width: ".concat(s,"px; height: ").concat(s,"px")}):"",n?Su(fu(),Pu(n,C)):"",t&&o?Su(pu(),o,Pu(t,C)):"",r&&a?Su(gu(),a,Pu(r,C)):"")}(),function(){if(!m)return"";var e=["gallery__loading",v.length?"gallery__loading--below-images":"",L<400?"gallery__loading--narrow":""].filter(Boolean).join(" "),n=v.length?"margin-bottom: ".concat(g,"px"):"";return Su(du(),e,n,Pu("loading",C))}());function U(e,n){return Su(Bu(),"height: ".concat(e.height,"px"),function(e){var n=e.rowTopOffset,t=e.height;if(!x)return!0;var o=k(x,2),r=o[0],a=o[1],i=n+t;return i+1e3>=r&&i-1e3<=a||n+1e3>=r&&n-1e3<=a||n-1e3<=r&&i+1e3>=a}(e)?e.items.map(function(e){return function(e,n){if(e.isBookend)return function(e){var n=e.aspectRatio,t="flex: ".concat(n,"; margin-bottom: ").concat(g,"px");return Su(ku(),t)}(e);var t=e.aspectRatio,s=e.flex,u=e.isTransparent,c=e.imageRef,d=e.isLast,p=Array.isArray(o),f=!!p&&o.includes(e.id),h=["gallery__item",f?"gallery__item--selected":"",p?"gallery__item--selectable":"",t>1?"gallery__item--wide":"gallery__item--narrow",i?i(e.imageRef):""].filter(Boolean).join(" "),m="flex: ".concat(s,"; margin: 0 ").concat(d?0:"".concat(g,"px")," ").concat(g,"px 0;");S&&e.color&&(m+="outline: 4px solid ".concat(e.color));var y=e.getImageURL?e.getImageURL(e.width,e.height):e.thumbURL;c.lastRenderedThumb={url:y,renderedWidth:e.width};var v="url('".concat(y,"') no-repeat center"),_="cover";u&&(v+=", url('".concat(BeFunky.Params.globalImagesPath,"app/checker_pattern.jpg') repeat"),_+=", auto");var k="padding-bottom: ".concat(100/t,"%;"),w="";if(l){var b="position: absolute; top: ".concat(l,"px; right: ").concat(l,"px; bottom: ").concat(l,"px; left: ").concat(l,"px; background: ").concat(v,"; background-size: ").concat(_);w=Su(Fu(),b)}else k+="background: ".concat(v,"; background-size: ").concat(_);return Su(bu(),h,m,c,f,y,Ru(r?r(e.id):void 0),k,w,p?Cu("global-apply-icon","icon icon-selected"):"",S?Su(wu(),n,e.imageIndex,t.toFixed(2)):"",a?a(c):"")}(e,n)}):"")}function D(e){var n=this,o=e.target.closestParent(function(e){return e===n||e.imageRef});o.imageRef&&t(o.imageRef,!o.isSelected,o.renderedImageURL)}function O(e){return(Math.floor(Math.random()*(256-e))+e).toString(16)}function j(e){return e.reduce(function(e,n){return e+n},0)}}),BeFunky.imageGallery=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=n.imagesPerRow,r=void 0===t?5:t,a=n.gutterWidth,i=void 0===a?12:a,s=n.minAspectRatio,u=void 0===s?.75:s,c=n.startNewRowCondition,l=n.maxWidth,d=n.imageSelectionHandler,g=n.isSelected,p=n.isGraphic,f=n.tooltipHandler,h=n.extendItem;return function(){this.innerHTML='\n        <div class="image-gallery__images" style="padding: '.concat(i/2,'px"></div>\n        <div class="image-gallery__message"></div>\n        <div class="image-gallery__empty-state"></div>\n    '),this.init=function(){this.initDefaultValues()},this.initDefaultValues=function(){this._message=void 0,this._emptyState="",this._images=[],this.imagesPerRow=this._imagesPerRow=r,this._currentWidth=void 0,this.imageIDRowIndexes=[],this.imagesContainer=this.querySelector(".image-gallery__images"),this.messageContainer=this.querySelector(".image-gallery__message"),this.emptyStateContainer=this.querySelector(".image-gallery__empty-state"),this.imagesContainer.addEventListener("click",this.handleItemClick),this.loadingElements=document.createElement("div").addClass("image-gallery__loading");var e=document.createElement("div").addClass("loading-spinner"),n=document.createElement("string");n.textContent="Loading...",this.loadingElements.appendChild(e),this.loadingElements.appendChild(n),this.loadingContainer=null,this.staggerLoading=!0},this.displayImages=function(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.staggerLoading,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this.images||!this.images.length)return this.imageIDRowIndexes=[],void(this.imagesContainer.innerHTML="");var o=t?0:this.getFirstOutdatedRowIndex();w(this.imagesContainer.children).filter(function(e,n){return n>=o}).forEach(function(n){return e.imagesContainer.removeChild(n)});var r=this.imageIDRowIndexes.findIndex(function(e){return e.rowIndex===o});-1===r&&(r=0);var a=this.images.slice(r);this.imageIDRowIndexes=this.imageIDRowIndexes.filter(function(e){return e.rowIndex<o});var s,l=document.createDocumentFragment(),m=[],y=o-1,v=function(){(s=document.createElement("div").addClass("image-gallery__row")).aspectRatioSum=0,s.imageAspectRatios=[],l.appendChild(s),m.push(s),y++};if("function"!=typeof c&&(c=function(e,n){return Math.abs(e-n)>Math.abs(e)}),v(),a.forEach(function(n){var t=e._imagesPerRow-s.aspectRatioSum,o=n.thumbWidth&&n.thumbHeight?Math.max(u,n.thumbWidth/n.thumbHeight):1;c(t,o,s.imageAspectRatios)&&v();var r=document.createElement("div").addClass("image-gallery__item").setStyles({margin:"".concat(i/2,"px")});BeFunky.imageGalleryItem(r,n,{imageSelectionHandler:d,isSelected:g,isGraphic:p,tooltipHandler:f,extendItem:h}),function(n,t,o){s.appendChild(n),s.aspectRatioSum+=t,s.imageAspectRatios.push(t),e.imageIDRowIndexes.push({id:o,rowIndex:y})}(r,o,n.id)}),m.length){var _=m[m.length-2],k=m[m.length-1],b=function(e){return e.reduce(function(e,n){return e+n})/e.length},F=_&&Math.abs(b(_.imageAspectRatios)-b(k.imageAspectRatios))<2,B=Math.abs((F?_.aspectRatioSum:this._imagesPerRow)-k.aspectRatioSum);if(B>.6){var E=B-function(){if(F)return 0;if(!k.imageAspectRatios.every(function(e){return e<1}))return 0;var e=k.aspectRatioSum/k.imageAspectRatios.length;return B*(1-e)}(),L=F?Math.max(1,_.imageAspectRatios.length-k.imageAspectRatios.length):B;k.appendChild(function(e,n){var t=document.createElement("div").addClass("image-gallery__item");return t.setStyles({flex:e,paddingLeft:"".concat(Math.round(n-1)*i,"px"),margin:"".concat(i/2,"px")}),t}(E,L)),k.placeholderWidth=E}}var I=0;m.forEach(function(t,o){var r=w(t.children),s=function(){if(e.currentWidth){var n=a.slice(I,I+r.length).map(function(e){var n=e.thumbWidth,t=e.thumbHeight;return n&&t?n/t:1});t.placeholderWidth&&n.push(t.placeholderWidth);var o=n.reduce(function(e,n){return e+n},0),s=e.currentWidth-(r.length+1)*i;r.forEach(function(e,t){if(e.loadImage){var r=Math.round(s*n[t]/o);e.loadImage(r)}})}else r.forEach(function(e){e.loadImage&&e.loadImage()});I+=r.length};n&&0!==o?setTimeout(s,30*o):s()}),this.imagesContainer.appendChild(l)},this.getFirstOutdatedRowIndex=function(){for(var e,n=0;n<this.images.length;n++){var t=this.images[n].id;if(!this.imageIDRowIndexes[n]){e=0===n?0:this.imageIDRowIndexes[n-1].rowIndex;break}if(t!==this.imageIDRowIndexes[n].id){e=this.imageIDRowIndexes[n].rowIndex;break}}return void 0===e&&(e=this.imageIDRowIndexes[this.images.length-1].rowIndex),e},this.handleItemClick=function(e){var n=e.target.parentElement;n&&n.hasClass&&n.hasClass("image-gallery__item")&&(n.selected=!n.selected)},Object.defineProperty(this,"emptyState",{set:function(e){if(this.emptyStateContainer.innerHTML="",e){if("object"!==o(e))throw"Image Gallery emptyState must be an object";if(this._emptyState=Object.assign({},e),e.icon&&(this.emptyStateContainer.innerHTML='\n                    <svg class="icon"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#'.concat(e.icon,'"></use></svg>')),e.text){var n=document.createElement("string").setLang(e.text);this.emptyStateContainer.appendChild(n)}if(e.buttonText&&e.buttonAction){var t=document.createElement("button").setClass("button button--blue").setLang(e.buttonText);t.addEventListener("click",e.buttonAction),this.emptyStateContainer.appendChild(t)}}else this._emptyState=void 0},get:function(){return this._emptyState}}),Object.defineProperty(this,"message",{set:function(e){if(this.messageContainer.innerHTML="",e){if("object"!==o(e))throw"Image Gallery message must be an object";this._message=Object.assign({},e);var n=!0===e.isError;if(this.messageContainer.toggleClass("image-gallery__message--is-error",n),e.text){var t=document.createElement("string").setLang(e.text);this.messageContainer.appendChild(t)}if(e.buttonText&&e.buttonAction){var r=document.createElement("button").setClass("button ".concat(n?"button--small button--white":window.isFlashOpenned?"button--grey":"button--secondary")).setLang(e.buttonText);r.addEventListener("click",e.buttonAction),this.messageContainer.appendChild(r)}}else this._message=void 0},get:function(){return this._message}}),Object.defineProperty(this,"isLoading",{set:function(e){if(this._isLoading!==e){if("boolean"!=typeof e)throw"isLoading must be a boolean";this._isLoading=e,e?(this.loadingContainer=this.images.length?this.messageContainer:this.emptyStateContainer,this.loadingContainer.innerHTML="",this.loadingContainer.removeClass("image-gallery__message--is-error"),this.loadingContainer.appendChild(this.loadingElements.cloneNode(!0))):this.loadingContainer===this.messageContainer?this.message=this._message:this.loadingContainer===this.emptyStateContainer&&(this.emptyState=this._emptyState)}},get:function(){return this._isLoading}}),Object.defineProperty(this,"images",{set:function(e){if(this._images!==e){if(!Array.isArray(e))throw"images must be an Array";this._images=e,this.displayImages()}},get:function(){return this._images}}),Object.defineProperty(this,"imagesPerRow",{set:function(e){if(this._imagesPerRow!==e){if("number"!=typeof e)throw"imagesPerRow must be a number";if(l&&this._currentWidth&&e!==r*this._currentWidth/l)throw"imagesPerRow must match currentWidth";this._imagesPerRow=e,this.displayImages(!1,!0)}},get:function(){return this._imagesPerRow}}),Object.defineProperty(this,"currentWidth",{set:function(e){if(this._currentWidth!==e){if("number"!=typeof e)throw"currentWidth must be a number";if(!l)throw"maxWidth required";if(e>l)throw console.log({maxWidth:l,currentWidth:e}),"currentWidth too large";this._currentWidth=e,this.imagesPerRow=r*e/l}},get:function(){return this._currentWidth}}),this.init()}.bind(e)()},BeFunky.imageGalleryItem=function(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=t.imageSelectionHandler,r=t.isSelected,a=void 0===r?function(){return!1}:r,i=t.isGraphic,s=void 0!==i&&i,u=t.tooltipHandler,c=t.extendItem;return function(){var t=this,r=n.id,i=n.isTransparent,l=void 0!==i&&i;this.id="image_gallery_item--".concat(r),this.init=function(){this.initDefaultValues(),this.initImagePlaceholder(),"function"==typeof c&&c(e,n)},this.initDefaultValues=function(){this._selected=a(n.id),this.selected=this._selected,this.toggleClass("image-gallery__item--selected",this._selected),this.imagePlaceholder=document.createElement("div");var e="function"==typeof u?u(n):void 0;e&&(this.dataset.bfntooltip=e)},this.initImagePlaceholder=function(){var e=n.thumbWidth,t=n.thumbHeight,o=e&&t?e/t:1;this.setStyles({flex:o}),this.addClass("image-gallery__item--".concat(o>=1?"wide":"narrow")),this.imagePlaceholder.addClass("image-gallery__placeholder").setStyles({paddingBottom:"".concat(100/o,"%")}),this.appendChild(this.imagePlaceholder);var r=document.createElement("div").addClass("image-gallery__item-outline");r.innerHTML='\n            <svg class="icon icon-selected">\n                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#global-apply-icon"></use>\n            </svg>',this.appendChild(r)},this.loadImage=function(e){var o=e&&n.getImageURL?n.getImageURL(e):n.thumbURL;if(n.lastRenderedThumb={url:o,renderedWidth:e},n.svgPlaceholder){if(!o)return void(t.imagePlaceholder.innerHTML='<svg class="icon">\n                    <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#'.concat(n.svgPlaceholder,'"></use>\n                </svg>'));t.imagePlaceholder.innerHTML=""}var r="",a="";s?(r="url('".concat(o,"') no-repeat center"),a="contain",t.graphicPlaceholder=document.createElement("div").addClass("image-gallery__graphic"),t.imagePlaceholder.appendChild(t.graphicPlaceholder)):(r="url('".concat(o,"') no-repeat center"),a="cover",l&&(r+=", url('".concat(BeFunky.Params.globalImagesPath,"app/checker_pattern.jpg') repeat"),a+=", auto"));var i=new Image;i.onload=function(){s?t.graphicPlaceholder.setStyles({background:r,backgroundSize:a}):t.imagePlaceholder.setStyles({background:r,backgroundSize:a})},i.onerror=function(){var e=BFN.getImageType(n.id);t.hasRetried?BeFunky.logError("Failed to load ".concat(e," thumbnail for a second time")):(t.hasRetried=!0,setTimeout(t.loadImage.bind(t),3e3))},i.src=o},Object.defineProperty(this,"selected",{set:function(e){e!==this._selected&&o(n,e)&&(this._selected=e,this.toggleClass("image-gallery__item--selected",e))},get:function(){return this._selected}}),this.init()}.bind(e)()},BeFunky.explorePage={search:function(){BeFunky.throwError("Explore page not available")},openImage:function(){BeFunky.throwError("Explore page not available")},isAvailable:!1},BeFunky.onDocumentReady(function(){var e=document.getElementById("explore");e&&Uu.call(e)}),BeFunky.galleryPage={openImage:function(){BeFunky.throwError("Gallery page not available")},isAvailable:!1},BeFunky.onDocumentReady(function(){var e=document.getElementById("user_gallery");e&&Du.call(e)});var Nu=window.deferredPromise(),Hu=BeFunky.lit,qu=Hu.html,Vu=Hu.siteLang;function Wu(){var e=this;this.init=function(){this.initDefaultValues(),this.initPublicAPI(),this.initMenuItems(),this.initGallery(),this.initSearchForm()},this.initDefaultValues=function(){this.supportsTouch="ontouchstart"in document.documentElement||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0},this.initPublicAPI=function(){var e=this;BeFunky.myPhotosPage.isAvailable=!0,BeFunky.myPhotosPage.openImage=function(n){if(!n)return e.closeModal();var t=e.gallery.images.find(function(e){return e.id==="befunky_photo_".concat(n)});t?e.openModal(t):BeFunky.logError("Unable to open Gallery image",{imageID:n})},BeFunky.myPhotosPage.selectFilter=function(n){e.closeModal(),n!==e.previousFilter&&e.loadResults("",n)}},this.initMenuItems=function(){var e=this;this.menuItemClickedTime=0,this.menuItems={editTitle:{domId:"edit_title_form",title:function(){return"title"},onClick:function(n,t){var o=function(e){var n=document.createElement("div").setClass("modal form-modal");return n.id="modal_form_".concat(e),n}("edit_title"),r=t.id.replace("befunky_photo_",""),a="".concat(r).concat(t.key),i=Mr(o,{title:"edit_title",fields:[{name:"title",label:"title",initialValue:t.title,maxLength:100,errorMessage:"photo_title_length",validate:function(e){return e.length>=1&&e.length<=100},sanitize:function(e){return e.replace(/[^a-zA-Z0-9_\s]/g,"")}}],button:"update_title",onSubmit:function(n){var t=n.title;!function(e,n,t,o){var r=t.match(/#(\w+)/gi);r=null!=r?r.join().replace(/#/g,""):"";var a={imgId:n,title:t,tags:r};BeFunky.requestAPI("photo/update-image-info",a,{showLoadScreen:!0}).then(function(e){if("success"!==e.data||"1"!==e.message)throw"invalid_response";o({updatedTitle:e.title})}).catch(function(e){o({error:e})})}(0,a,t,function(n){var t=n.error,a=n.updatedTitle;if(t)return BeFunky.logError("Unable to set title on photo",t),void u({submissionErrors:[BeFunky.failureReason(t)]});e.gallery.images.find(function(e){return e.id==="befunky_photo_".concat(r)}).title=a,BeFunky.closeModal(o)})}}),s=i.teardown,u=i.setFormState;!function(e,n){BeFunky.openModal(e,{addSiteClass:!0,addCloseButton:!0,size:"small-nebula",destroyOnClose:!0,onClose:n})}(o,s)}},openInApp:{title:function(){return"editor"},onClick:function(e,n){BeFunky.myPhotosPage.imageToEdit=n.imageURL,BeFunky.isUseHTML5||BeFunky.Params.isFlashPlayerCorrect?BeFunky.pushRoute("create"):BeFunky.pushRoute("create/?openurl=".concat(encodeURIComponent(n.imageURL)))}},publicPrivate:{title:function(e){return!0===e.isPublic?"set_to_private":"set_to_public"},onClick:function(n,t){n.target.parentElement.focus(),n.target.disabled=!0,function(e,n){var t=e.isPublic,o=e.key,r=e.id;if((null!=BeFunky.User.isMailVerified?BeFunky.User.isMailVerified:BeFunky.Params.isMailVerified)||t){var a=r.replace("befunky_photo_",""),i={imgId:a+o,isPublic:t?"0":"1"};BeFunky.requestAPI("photo/update-image-info/",i).then(function(o){if("success"!==o.data||"1"!==o.message)throw"invalid_response";var a=!t;e.isPublic=a,n({isPublic:a,id:r})}).catch(function(e){n({error:e})})}else BeFunky.confirm("photos_public_verify_email",{confirmText:"send_verification_email",onConfirm:BeFunky.sendVerificationEmail,imageUrl:"".concat(BeFunky.Params.globalImagesPath,"site/illustrations/paper-plane.svg")}),n({error:"email_not_verified"})}(t,function(t){var o=t.error,r=(t.isPublic,t.id);n.target.disabled=!1,o?BeFunky.logError("Unable to change photo status",o):"public"===e.previousFilter||"private"===e.previousFilter?(e.gallery.images=e.gallery.images.filter(function(e){return e.id!==r}),n.target.parentElement.blur()):e.reRenderGalleryPopup()})}},deleteImage:{title:function(){return"trash"},onClick:function(n,t){BeFunky.confirm("delete_this_photo",{onConfirm:function(){!function(e,n){var t=e.id,o=e.key,r={imgIds:"".concat(t.replace("befunky_photo_","")+o)};BeFunky.requestAPI("photo/delete-image/",r,{showLoadScreen:!0}).then(function(e){if("success"!==e.data||"1"!==e.message)throw"invalid_response";n({id:t})}).catch(function(e){return n({error:e})})}(t,function(n){var t=n.error,o=n.id;t?BeFunky.logError("Unable to delete photo",t):(e.gallery.images=e.gallery.images.filter(function(e){return e.id!==o}),document.activeElement.blur())})},focusConfirmButton:!1,imageUrl:"".concat(BeFunky.Params.globalImagesPath,"site/illustrations/shredder.svg")})}}}},this.initGallery=function(){var e=this;this.gallery=this.querySelector(".my-photos__gallery");this.gallery.rowHeight=200,this.gallery.currentWidth=this.getCurrentWidth(),this.gallery.singleRow=!1,this.gallery.onSelectItem=function(n){Date.now()-e.menuItemClickedTime>400&&e.openModal(n)},this.gallery.context="site",this.gallery.addItemClass=function(){return"gallery__item--has-content"},this.gallery.extendItemTemplate=function(n){return e.photoOptionsTemplate(n)},this.gallery.addClass("gallery--use-borders"),window.addEventListener("resize",BeFunky.debounce(function(){return e.handleGalleryResize()},300))},this.initSearchForm=function(){var e=this;this.searchForm=this.querySelector(".search-box"),this.searchInput=this.querySelector(".search-box__input"),this.clearButton=this.querySelector(".search-box__clear"),this.searchButton=this.querySelector(".search-box__submit"),this.validFilters=["all","public","private"],this.filterButtons=this.validFilters.reduce(function(n,t){var o=document.getElementById("my_photos_filter_".concat(t));return n[t]=o,o.addEventListener("click",function(){return e.loadResults("",t)}),n},{}),this.previousSearchQuery=null,this.previousFilter=null,this.previousSearchPage=-1,this.clearButton.addEventListener("click",function(){e.loadResults("",e.previousFilter),e.searchInput.focus()}),this.searchForm.addEventListener("submit",this.handleSearch)},this.reRenderGalleryPopup=function(){var e=this;this.gallery.extendItemTemplate=function(n){return e.photoOptionsTemplate(n)}},this.loadResults=function(e,n){var t=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(!(this.previousSearchQuery===e&&this.previousFilter===n&&o<=this.previousSearchPage))if(this.validFilters.includes(n)){this.searchInput.value=e;var r=this.filterButtons[n];Object.values(this.filterButtons).forEach(function(e){e.parentElement.toggleClass("active",e===r)}),console.log("Loading results...",{searchQuery:e,filter:n,page:o}),this.previousSearchQuery=e,this.previousFilter=n,this.previousSearchPage=o,BeFunky.pushRoute("all"===n?"myphotos/":"myphotos/".concat(n,"/")),1===o&&(this.gallery.images=[]),this.gallery.message="",this.gallery.isLoading=!0,this.toggleInteractivity(!1),function(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3?arguments[3]:void 0,r={start:100*(t-1),end:100};e?r.keyword=e:r.type=n;BeFunky.requestAPI("photo/me/",r).then(function(e){if(!Array.isArray(e.data))throw"invalid_response";if(!e.data.length)throw"no_results";var n=e.data.map(function(e){return{id:"befunky_photo_".concat(e.id),key:e.key,thumbWidth:200,thumbHeight:200,thumbURL:e.thumb_url,imageURL:e.url,isPublic:"1"===e.isPublic,nick:e.nick,title:e.title,dateCreated:e.dateCreated,isTransparent:/\.png(\?|$)/.test(e.url)}});return o({images:n})}).catch(function(e){o({error:e})})}(e,n,o,function(r){var a=r.error,i=r.images;if(e===t.previousSearchQuery&&n===t.previousFilter){if(t.gallery.isLoading=!1,t.toggleInteractivity(!0),a)return BeFunky.logError("Unable to fetch images",a),void("no_results"===a?(t.gallery.message="",t.gallery.emptyState=e?{text:["no_results_for",{query:'"<strong>'.concat(e,'</strong>"')}],imageUrl:"".concat(BeFunky.Params.globalImagesPath,"site/illustrations/magnifying-glass-frown.svg")}:{text:"no_befunky_photos",imageUrl:"".concat(BeFunky.Params.globalImagesPath,"site/illustrations/picture-frames.svg")}):(t.gallery.message={isError:!0,text:BeFunky.failureReason(a),buttonText:"try_again",buttonAction:function(){return t.loadResults(e,n,o)}},t.gallery.emptyState="",t.previousSearchPage=t.previousSearchPage-1));if(t.gallery.images=[].concat(w(t.gallery.images),w(i)),t.gallery.message="",!(i.length<100)){t.gallery.message={buttonText:"load_more",buttonAction:function(){return t.loadResults(e,n,o+1)}}}}})}else BeFunky.logError("Invalid MyPhotos filter",{filter:n})},this.photoOptionsTemplate=function(n){var t=["gallery__item-content","my-photos__edit-button",e.supportsTouch?"my-photos__edit-button--always-show":""].filter(Boolean).join(" "),o=function(t){return function(o){o.stopPropagation(),t(o,n),e.menuItemClickedTime=Date.now()}};return qu(ju(),t,function(e){e.stopPropagation(),e.currentTarget.focus()},function(e){return e.stopPropagation()},Object.keys(e.menuItems).map(function(t,r){return qu(Ou(),"button my-photos__edit-option my-photos__item-".concat(r+1),o(e.menuItems[t].onClick),o(e.menuItems[t].onClick),Vu(e.menuItems[t].title(n)))}))},this.toggleInteractivity=function(e){this.searchButton.disabled=!e,this.clearButton.disabled=!e,Object.values(this.filterButtons).forEach(function(n){n.disabled=!e})},this.openModal=function(n){var t="all"===e.previousFilter?"myphotos/":"myphotos/".concat(e.previousFilter,"/");BeFunky.openUserPhotoModal(n,e.gallery.images,t,!1)},this.closeModal=function(){BeFunky.closeUserPhotoModal()},this.getCurrentWidth=function(){return Math.min(1232,window.innerWidth)-(window.innerWidth>=768?96:window.innerWidth>=361?64:32)},this.handleSearch=function(n){n&&n.preventDefault();var t=e.searchInput.value.replace(/[+"<>^%]/gi," ").replace(/ {2,}/g," ").trim();e.searchInput.value=t,e.loadResults(t,"all")},this.handleGalleryResize=function(){window.isFlashOpenned||(e.gallery.currentWidth=e.getCurrentWidth())},this.init(),window.initialUserStatus.then(function(){BeFunky.isLoggedIn()?Nu.resolve(!0):window.location.href="".concat(BeFunky.Params.siteUrl,"sign-in/?next=").concat(encodeURIComponent(window.location.href))})}function Gu(){var e=_(['\n        <div class="modal user-photo site">\n            <figure>\n                <div class="image-box user-photo__image-box">\n                    <img src="','" class="image-box__image user-photo__image ','" alt="" />\n                </div>\n                <figcaption class="user-photo__footer">\n                    <div class="user-photo__caption">\n                        <h4 class="user-photo__title">','</h4>\n                        <p class="user-photo__author">by <a href="',"gallery/",'/">','</a></p>\n                    </div>\n                    <button class="user-photo__report-abuse button button--light" @click=',">","</button>\n                </figcaption>\n            </figure>\n        </div>\n        "]);return Gu=function(){return e},e}BeFunky.myPhotosPage={openImage:function(e){Nu.then(function(n){n?BeFunky.myPhotosPage.openImage(e):BeFunky.throwError("MyPhotos page not available")})},selectFilter:function(e){Nu.then(function(n){n?BeFunky.myPhotosPage.selectFilter(e):BeFunky.throwError("MyPhotos page not available")})},imageToEdit:"",isAvailable:!1},BeFunky.onDocumentReady(function(){var e=document.getElementById("my_photos");e?Wu.call(e):Nu.resolve(!1)});var zu=BeFunky.lit,Xu=zu.html,Ju=zu.render,$u=zu.siteLang;function Yu(){var e=_(["<strong>Billing Period:</strong> "," - ",""]);return Yu=function(){return e},e}function Ku(){var e=_(['\n            <div class="invoice">\n                ',"\n                ","\n                ",'\n\n                <img src="','site/logo-dark1.svg" alt="BeFunky" style="margin: 0 auto; width: 320px; display: block;">\n                <hr style="border-top: 1px solid #EDEDED; margin: 2rem 0">\n                <h2>Invoice</h2>\n                <p>\n                    <strong>Date:</strong> ',"<br>\n                    ","\n                </p>\n\n                <br>\n                <h6>Billed To</h6>\n                <p>\n                    ","<br>\n                    ","<br>\n                    **** **** **** ","\n                </p>\n\n                <br>\n                <h6>Invoice Number</h6>\n                <p>","</p>\n\n                <br>\n                <h6>Description</h6>\n                <p>\n                    Plan: BeFunky "," ","<br>\n                    Charge: ",'\n                </p>\n\n                <br>\n                <p style="text-align: right"><strong>Total Amount Paid:</strong> ',"</p>\n\n                ",'\n                <button onclick="window.print()" class="button button--blue print-button">Print</button>\n            </div>\n        ']);return Ku=function(){return e},e}function Qu(){var e=_(["<div>\n                            <p>","</p>\n                            <p>","</p>\n                        </div>"]);return Qu=function(){return e},e}function Zu(){var e=_(["\n            <div>\n                <p>","</p>\n                <p>","</p>\n                <p>","</p>\n            </div>\n        "]);return Zu=function(){return e},e}function ec(){var e=_(["<p>","</p>"]);return ec=function(){return e},e}function nc(){var e=_(["\n            <div>\n                <p>","</p>\n                ","\n            </div>\n        "]);return nc=function(){return e},e}function tc(){var e=_(["<p>","</p>"]);return tc=function(){return e},e}function oc(){var e=_(['\n                    <li class="statement-panel__list-item">\n                        <span class="title">','</span>\n                        <button class="button button--link" @click=',">","</button>\n                    </li>\n                "]);return oc=function(){return e},e}function rc(){var e=_(['\n                <ul class="statement-panel__invoice-list">\n                ',"\n                </ul>"]);return rc=function(){return e},e}function ac(){var e=_(['\n                <div id="invoices" class="form-modal statement-panel modal">\n                    <h3 data-lang="billing_history" class="h5">Your Billing History</h3>\n                    ',"\n                </div>\n            "]);return ac=function(){return e},e}function ic(){var e=_(["Card Number: "," <br><string>","</string> ",""]);return ic=function(){return e},e}function sc(){var e=_(["<button @click=",' class="button button--link my-account__button my-account__button--delete">',"</button>"]);return sc=function(){return e},e}function uc(){var e=_(["\n            <p>","</p>\n            <button @click=",' class="button button--link my-account__button">',"</button>\n            "]);return uc=function(){return e},e}function cc(){var e=_(["\n            <p>","</p>\n            <a href=",' class="button button--link my-account__button" target="_blank" rel="noopener">',"</a>\n            "]);return cc=function(){return e},e}function lc(){var e=_(['\n            <p className="my-account__delete-contact-support">',"</p>\n            <p>","</p>\n            ","\n        "]);return lc=function(){return e},e}function dc(){var e=_(["\n                    <button @click=",' class="button button--secondary button--large">',"</button>\n                    "]);return dc=function(){return e},e}function gc(){var e=_(['\n                    <div class="my-account__row">\n                        <span class="my-account__label">','</span>\n                        <span class="my-account__data">',"</span>\n                    </div>\n                "]);return gc=function(){return e},e}function pc(){var e=_(["\n                ",'\n                <div class="my-account__row my-account__row--credit-card">\n                    <span class="my-account__label">','</span>\n                    <div class="my-account__data">',"</div>\n                    <button @click=",' class="button button--link my-account__button">','</button>\n                </div>\n                <div class="my-account__row my-account__row--billing-history">\n                    <span class="my-account__label">',"</span>\n                    <button @click=",' class="button button--link my-account__button">','</button>\n                </div>\n                <div class="my-account__row my-account__row--cancel-subscription">\n                    ',"\n                </div>\n            "]);return pc=function(){return e},e}function fc(){var e=_(["<button @click=",' class="button button--dark-blue button--small">',"</button>"]);return fc=function(){return e},e}function hc(){var e=_(["<button @click=",' class="button button--dark-blue">',"</button>"]);return hc=function(){return e},e}function mc(){var e=_(['\n                <span class="my-account__label">','</span>\n                <span class="my-account__data">BeFunky '," ","</span>\n                ","\n                ","\n            "]);return mc=function(){return e},e}function yc(){var e=_(["\n                <span>\n                    <string>","</string>\n                    <br>\n                    <string>","</string>\n                </span>\n                <button @click=",' class="button button--link my-account__button">',"</button>\n            "]);return yc=function(){return e},e}function vc(){var e=_(["<button @click=",' class="button button--link my-account__button">',"</button>"]);return vc=function(){return e},e}function _c(){var e=_(['\n        <div class="','">\n\n            <h2 class="my-account__heading">','</h2>\n            <div class="my-account__row my-account__row--username">\n                <span class="my-account__label">','</span>\n                <span class="my-account__data">',"</span>\n                ",'\n            </div>\n            <div class="my-account__row my-account__row--email">\n                <span class="my-account__label">','</span>\n                <span class="my-account__data">',"</span>\n                <button @click=",' class="button button--link my-account__button">','</button>\n            </div>\n            <div class="my-account__row my-account__row--password">\n                <span class="my-account__label">','</span>\n                <span class="my-account__data"></span>\n                <button @click=',' class="button button--link my-account__button">','</button>\n            </div>\n        </div>\n\n        <div class="','">\n            <h2 class="my-account__heading">','</h2>\n            <div class="my-account__row subscription-row">\n            ',"\n            </div>\n\n            ",'\n            </div>\n\n            <div class="','">\n                <h2 class="my-account__heading">','</h2>\n                <div id="account_newsletter_subscription" class="my-account__row my-account__row--email-notifications">\n                    <span>',"</span>\n                    <button @click=",' class="button button--link my-account__button">','</button>\n                </div>\n            </div>\n\n            <div class="','">\n                ',"\n            </div>\n\n        </div>\n        "]);return _c=function(){return e},e}BeFunky.singleImagePage={openImage:function(){BeFunky.throwError("Single Image page not available")},isAvailable:!1},BeFunky.onDocumentReady(function(){document.getElementById("explore_single_image")&&function(e){var n,t=window.exploreSingleImageData,o=t.imageTitle,r=t.imageUser,a=t.imageSrc,i=t.imageId;function s(){BeFunky.reportAbuse(i)}Ju((n=/\.png(\?|$)/.test(a)?"image-box__image--is-transparent":"",Xu(Gu(),a,n,o,BeFunky.Params.siteUrl,r,r,s,$u("report_abuse"))),e),BeFunky.singleImagePage={openImage:function(){},isAvailable:!0}}(document.getElementById("explore_single_image_template_container"))});var kc=BeFunky.lit,wc=kc.html,bc=kc.setupState,Fc=kc.render,Bc=kc.siteLang,Ec=kc.elem;function Lc(e){var n,t,o=BeFunky.debounce(function(){return Fc(wc(_c(),"my-account__card ".concat(a.isLoading?"my-account__card--loading":""),Bc("my_profile"),Bc("username"),a.username,a.canChangeUsername?wc(vc(),u,Bc("change")):"",Bc("email"),a.email,c,Bc("change"),Bc("password"),l,Bc("change"),"my-account__card ".concat(a.isLoading?"my-account__card--loading":""),Bc("my_subscription"),a.hasCancelledSubscription?wc(yc(),Bc("cancelled_subscription"),Bc(["previous_plan",{next_billing_date:L(a.nextBillingDate)}]),p,Bc("resubscribe")):wc(mc(),Bc("plan"),a.packageName,a.billingCycle,a.canUpgrade?wc(hc(),d,Bc(Kt()?"start_trial":"upgrade")):"","Monthly"===a.billingCycle&&!a.isPayPalSubscriber&&a.monthlyPriceId?wc(fc(),g,Bc("switch_to_annual")):""),"Plus"===a.packageName?wc(pc(),a.hasCancelledSubscription?"":wc(gc(),Bc("next_billing_date"),L(a.nextBillingDate)),Bc("billing_method"),a.paymentInfo,f,Bc("change"),Bc("billing_history"),h,Bc("view"),a.hasCancelledSubscription?"":wc(dc(),y,Bc("cancel_my_subscription"))):"","my-account__card ".concat(a.isLoading?"my-account__card--loading":""),Bc("email_notifications"),Bc("email_notification_settings"),_,Bc("change"),"my-account__card my-account__card--delete-account ".concat(a.isLoading?"my-account__card--loading":""),wc(lc(),Bc(["delete_account_contact_support",{contact_support:BeFunky.toLinkHTML("SUPPORT",!0)}]),Bc("delete_account_info"),a.isPayPalSubscriber?wc(cc(),Bc("delete_account_paypal"),I(),Bc("open_paypal")):a.isEmailVerified?wc(sc(),F,Bc("delete_account")):wc(uc(),Bc("delete_account_verify_email"),b,Bc("send_verification_email")))),e)},"raf"),r=k(bc({email:"",username:"",hasCancelledSubscription:!1,isLoading:!0,isEmailVerified:!1,isPayPalSubscriber:!1,isSocialUser:!0,isEmailSubscriber:!0,canChangeUsername:!0,canUpgrade:!1,monthlyCouponCode:"",billingCycle:"",nextBillingDate:"",packageName:"",paymentInfo:"",monthlyPriceId:""},o),2),a=r[0],i=r[1];function s(e){return e.then(function(e){var n=e.data,t="paypal_subscr"===n.PaymentType,o="";n.nextbillingdate&&(o=new Date(n.nextbillingdate.replace(/-/g,"/")));i({hasCancelledSubscription:1===n.iscancelled,isPayPalSubscriber:t&&BeFunky.isPlus(),billingCycle:n.billingCycle||"",nextBillingDate:o,packageName:n.packageName,monthlyPriceId:"Monthly"!==n.billingCycle||["monthly","monthly_premium_2017"].includes(n.price_id)?"":n.price_id});var r,a,s=t?"PayPal Account: ".concat(n.SubscrEmai):wc(ic(),n.last4,Bc("expiration_date"),(r=n.exp_month,a=n.exp_year,"".concat(r<10?"0".concat(r):r," / ").concat(a)));i({paymentInfo:s}),window.location.href.includes("openThanks=1")&&BeFunky.openThankYouPanel();var u=n.can_apply_coupon&&n.can_apply_coupon!==n.coupon_applied&&"trialing"!==BeFunky.User.subscription_status?n.can_apply_coupon:"";u&&S().then(function(e){e.includes(u)||i({monthlyCouponCode:u})})}).catch(function(e){BeFunky.isPlus()?"user_not_plus"!==e&&("request_failed"!==e&&BeFunky.throwError("Unable to get customer data for Plus user",e),BeFunky.showNotification({message:["error_account_info",{contact_support:BeFunky.toLinkHTML("SUPPORT",!0)}],button:{text:"try_again",onClick:function(){return window.location.reload()}}})):i({packageName:"Free"})}).then(function(){i({canUpgrade:!BeFunky.isPlus()})})}function u(){var e=B("username"),n=Mr(e,{title:"change_username",notification:"username_change_warning",fields:[{name:"username",label:"new_username",maxLength:100,errorMessage:"username_length",validate:function(e){return e.length>=4&&e.length<=100},sanitize:function(e){return e.replace(/[^a-zA-Z0-9_-]/g,"")}}],button:"update_username",onSubmit:function(n){var t=n.username;(function(e){return BeFunky.requestAPI("auth/update-username",{newName:e},{showLoadScreen:!0}).then(function(e){if("success"!==e.data)throw"invalid_response"})})(t).then(function(){i({username:t,canChangeUsername:!1}),window.updateUserStatus(Object.assign(window.latestUserData,{user_name:t})),BeFunky.closeModal(e)}).catch(function(e){BeFunky.logError('Unable to change username to "'.concat(t,'"'),e),o({submissionErrors:[BeFunky.failureReason(e)]})})}}),t=n.teardown,o=n.setFormState;E(e,t)}function c(){var e=B("email"),n=Mr(e,{title:"change_email",fields:[{name:"email",label:"new_email",errorMessage:"error_invalid_email",validate:window.isEmailAddress,sanitize:function(e){return e.trim()}},{name:"email_confirmed",label:"confirm_email",errorMessage:"error_email_mismatch",validate:function(e,n){return e===n.email},sanitize:function(e){return e.trim()}},{name:"password",label:"password",type:"password",maxLength:100,errorMessage:"register_modal_password_error",validate:function(e){return e.length>=6}}],button:"update_email",onSubmit:function(n){var t=n.email,r=n.password;(function(e,n){var t={e:e,ea:e,pa:n};return BeFunky.requestAPI("auth/update-email",t,{showLoadScreen:!0}).then(function(e){if("success"!==e.data)throw"invalid_response";return{requiresEmailVerification:"1"!==e.social}})})(t,r).then(function(n){var o=n.requiresEmailVerification;i({email:t,isEmailVerified:o}),o&&window.setCookie("mailVerificationSend","",-1),window.updateUserStatus(Object.assign(window.latestUserData,{email:t})),BeFunky.closeModal(e)}).catch(function(e){BeFunky.logError('Unable to change email to "'.concat(t,'"'),e),o({submissionErrors:[BeFunky.failureReason(e)]})})}}),t=n.teardown,o=n.setFormState;E(e,t)}function l(){var e=B("password"),n=[{name:"new_password",label:"new_password",type:"password",maxLength:100,errorMessage:"register_modal_password_error",validate:function(e){return e.length>=6}},{name:"new_password_confirmed",label:"confirm_password",type:"password",maxLength:100,errorMessage:"error_password_mismatch",validate:function(e,n){return e===n.new_password}}],t=Mr(e,{title:"change_password",fields:a.isSocialUser?n:[{name:"current_password",label:"current_password",type:"password",maxLength:100,errorMessage:"register_modal_password_error",validate:function(e){return e.length>=6}}].concat(n),button:"change_password",onSubmit:function(n){(function(e,n){var t={npBa:btoa(encodeURIComponent(e)),npaBa:btoa(encodeURIComponent(e))};n&&(t.opBa=btoa(encodeURIComponent(n)));return BeFunky.requestAPI("auth/update-pwd",t,{showLoadScreen:!0}).then(function(e){if("success"!==e.data)throw"invalid_response"})})(n.new_password,n.current_password).then(function(){BeFunky.closeModal(e)}).catch(function(e){BeFunky.logError("Unable to change password",e),r({submissionErrors:[BeFunky.failureReason(e)]})})}}),o=t.teardown,r=t.setFormState;E(e,o)}function d(){BeFunky.openUpgradePanel(null,!0)}function g(){BeFunky.promptUserToUpgradeToYearly(a.monthlyPriceId)}function p(){BeFunky.requestAPI("transaction/re-subscribe",{},{showLoadScreen:!0}).then(function(e){if("success"!==e.data)throw"invalid_response";i({hasCancelledSubscription:!1}),window.updateUserStatus(Object.assign(window.latestUserData,{pl:"1"})),BeFunky.acknowledge("my_account_resubscribed")}).catch(function(e){BeFunky.logError("Unable to resubscribe user:",e)})}function f(){BeFunky.openPaymentPanel("year","update")}function h(){function e(e){BeFunky.openModal(function(e){return Ec(ac(),function(e){if(e.length)return wc(rc(),e.map(function(e){return wc(oc(),e.date,function(e){return function(){return n=Object.assign(e,{email:a.email}),t="Invoice".concat(BeFunky.randomString(10)),o=window.open("about:blank",t),r=function(e){var n=e.date,t=e.period_start,o=e.period_end,r=e.name,a=e.package_name,i=e.billing_cycle,s=e.charge,u=e.id,c=e.last4,l=e.email,d=Math.round(11/8.5*700),g="\n            .invoice {\n                position: relative;\n                max-width: 100%;\n                width: ".concat(700,"px;\n                min-height: ").concat(d,"px;\n                margin: 0 auto;\n                background: white;\n                padding: 4rem;\n            }\n            .print-button {\n                position: absolute;\n                top: 2rem;\n                right: 2rem;\n            }\n            @media print {\n                .print-button { display: none; }\n            }\n        "),p=document.createElement("style");p.appendChild(document.createTextNode(g));var f=document.createElement("style");f.appendChild(document.createTextNode(w(document.getElementById("inline-fonts").sheet.cssRules).reduce(function(e,n){return e+n.cssText.replace(/url\("\//g,'url("'.concat(BeFunky.Params.siteUrl))},"")));var h=document.querySelector('link[rel="stylesheet"][href*="screen"]').cloneNode();return h.href=h.href.replace(/^\//,BeFunky.Params.siteUrl),Ec(Ku(),h,f,p,BeFunky.Params.globalImagesPath,n,t===o?"":wc(Yu(),t,o),r,l,c,u,a,i,s,s,"")}(n),void(BeFunky.isEdgeHTML||BeFunky.isInternetExplorer||BeFunky.isFirefox?(o.document.title="BeFunky - ".concat(n.date," Invoice"),o.document.write(r.outerHTML),o.document.close()):(o.document.title="BeFunky - ".concat(n.date," Invoice"),o.document.body.appendChild(r)));var n,t,o,r}}(e),Bc("view"))}));return wc(tc(),Bc("no_receipts"))}(e))}(e),{addSiteClass:!0,addCloseButton:!0,size:"small-nebula",destroyOnClose:!0})}(t?Promise.resolve(t):BeFunky.requestAPI("transaction/invoices",{},{showLoadScreen:!0}).then(function(e){if(!Array.isArray(e.data))throw"invalid_response";return t=e.data,e.data})).then(e).catch(function(n){if("no_invoices"===n)return e([]);BeFunky.throwError("Unable to fetch invoices",n)})}function m(){var e=a.monthlyCouponCode;function n(){i({monthlyCouponCode:""}),S().then(function(n){n.includes(e)||BeFunky.SettingsService.updateSetting("dismissed_messages",[].concat(w(n),[e]))})}BeFunky.confirm("keep_subscription_body",{heading:"keep_subscription_heading",confirmText:"keep_subscription",cancelText:"cancel_anyway",focusConfirmButton:!1,imageUrl:"".concat(BeFunky.Params.globalImagesPath,"site/modals/gift.jpg"),onConfirm:function(){var t;(t=e,BeFunky.requestAPI("transaction/apply-coupon",{coupon:t},{showLoadScreen:!0}).then(function(e){if("success"!==e.data)throw"invalid_response"})).then(function(){n(),BeFunky.acknowledge("keep_subscription_confirmation",{heading:"keep_subscription_thank_you",imageUrl:"".concat(BeFunky.Params.globalImagesPath,"site/modals/peace.jpg")})}).catch(function(e){BeFunky.throwError("Unable to apply coupon: ".concat(e),e),BeFunky.acknowledge(BeFunky.failureReason(e))})},onCancel:function(e){e&&(n(),v())}})}function y(){if("monthly_retention_30_percent_discount"===a.monthlyCouponCode)return m();BeFunky.confirm(function(){return wc(nc(),Bc(["cancellation_prompt",{next_billing_date:L(a.nextBillingDate)}]),a.isPayPalSubscriber?wc(ec(),Bc("cancel_via_paypal")):"")},{heading:"thank_you_befunky_titlecase",confirmText:a.isPayPalSubscriber?"open_paypal":"cancel_subscription",cancelText:"dont_cancel_subscription",focusConfirmButton:!1,imageUrl:"".concat(BeFunky.Params.globalImagesPath,"site/modals/gift.jpg"),onConfirm:v})}function v(){if(a.isPayPalSubscriber)return window.open(I(),"_blank");BeFunky.requestAPI("transaction/cancel-subscr",{},{showLoadScreen:!0}).then(function(e){if("success"!==e.data)throw"invalid_response"}).then(function(){i({hasCancelledSubscription:!0}),BeFunky.acknowledge(["my_account_unsubscribed",{my_account_link:'<a href="'.concat(BeFunky.Params.siteUrl,'my-account/">My Account</a>'),plan_expiration_date:L(a.nextBillingDate)}])}).catch(function(e){BeFunky.throwError("Unable to cancel subscription",e),BeFunky.acknowledge(BeFunky.failureReason(e))})}function _(){var e=document.getElementById("email_subscribe_newsletters"),n=document.getElementById("email_notifications_modal");e.checked=a.isEmailSubscriber,BeFunky.openModal(n,{addSiteClass:!0,addCloseButton:!0,size:"small-nebula"});var t=n.querySelector("form");t.submitHandled||(t.submitHandled=!0,t.addEventListener("submit",function(t){t.preventDefault();var o,r,a=e.checked;(o=a,r={em:"effects",is_:o?"0":"1"},BeFunky.requestAPI("auth/update-email-pref",r,{showLoadScreen:!0}).then(function(e){if("success"!==e.data)throw"invalid_response"})).then(function(){BeFunky.closeModal(n.id),i({isEmailSubscriber:a})}).catch(function(e){BeFunky.throwError("Unable to update email subscription",e)})}))}function b(){Ic()}function F(){var e=Ec(Zu(),Bc(["delete_account_first_paragraph",{email:'<a href="mailto:support@befunky.com">support@befunky.com</a>'}]),Bc("delete_account_second_paragraph"),Bc("delete_account_thanks"));BeFunky.confirm(e,{heading:"sorry_to_see_you_go",confirmText:"yes_delete_account",imageUrl:"".concat(BeFunky.Params.globalImagesPath,"site/modals/dog.jpg"),cancelText:"cancel",focusConfirmButton:!1,size:"medium",onConfirm:function(){BeFunky.requestAPI("auth/close-account-request",{},{showLoadScreen:!0}).then(function(e){if("success"!==e.data)throw"invalid_response"}).then(function(){BeFunky.acknowledge(Ec(Qu(),Bc("delete_account_email_sent"),Bc("thank_you_befunky")),{heading:"sorry_see_you_go",imageUrl:"".concat(BeFunky.Params.globalImagesPath,"site/illustrations/paper-plane.svg")})}).catch(function(e){BeFunky.acknowledge(BeFunky.failureReason(e)),BeFunky.throwError("Unable to send close account email",e)})}})}function B(e){var n=document.createElement("div").setClass("modal form-modal");return n.id="modal_form_".concat(e),n}function E(e,n){BeFunky.openModal(e,{addSiteClass:!0,addCloseButton:!0,size:"small-nebula",destroyOnClose:!0,onClose:n})}function L(e){return e instanceof Date?e.toLocaleDateString(BeFunky.LanguageManager.language.site,{day:"numeric",month:"long",year:"numeric"}):e}function I(){return"https://www.paypal.com/cgi-bin/webscr?cmd=_subscr-find&alias=".concat(encodeURIComponent("tekin2@befunky.com"))}function S(){return new Promise(function(e,n){BeFunky.SettingsService.getUserSettings(function(t){var o=t.error,r=t.settings;if(o)return n(o);e(r.dismissed_messages||[])})})}function P(){return BeFunky.requestAPI("transaction/customer")}function C(e){BeFunky.showNotification({message:e,type:"success"}),i({isEmailVerified:!0}),BeFunky.pushRoute("my-account")}BeFunky.LanguageManager.addLanguageUpdateListener(o),BeFunky.isPlus()&&(n=P()),window.initialUserStatus.then(function(e){var t=e.data;if(!BeFunky.isLoggedIn())return window.onbeforeunload=null,void(window.location.href="".concat(BeFunky.Params.siteUrl,"sign-in/?next=").concat(encodeURIComponent(window.location.href)));t||console.log("No user data, but user detected as logged in?",JSON.stringify(e));var o="1"===t.isMailVerified;i({email:t.email,username:t.user_name,isEmailVerified:o,canChangeUsername:t.can_change_user_name,isEmailSubscriber:t.is_subscribe_newsletter,isSocialUser:1===t.isSocialUser});var r,a=BeFunky.getUrlParameter("mv");a?o?C("email_already_verified"):(r=a,BeFunky.requestAPI("auth/verify-email",{mv:r},{showLoadScreen:!0}).then(function(e){if("success"!==e.data)throw"invalid_response";return C("email_successfully_verified")}).catch(function(e){return"logged_out_reload_page"===e?window.location.reload():"already_verified"===e?C("email_already_verified"):void BeFunky.throwError("Unable to verify email:",e)})):o||BeFunky.showNotification({message:"please_verify_email",button:{text:"send_verification_email",onClick:Ic},type:"warning"}),n||(n=BeFunky.isPlus()?P():Promise.reject("not_plus_user")),s(n).then(function(){i({isLoading:!1})})}),BeFunky.updateMyAccountPageAfterUpgrade=function(){i({isLoading:!0}),s(P()).then(function(){return i({isLoading:!1})})}}function Ic(){var e=!!window.getCookie("mailVerificationSend");if(BeFunky.Params.IS_LC&&(e=!0),e)return BeFunky.confirm("confirm_resend_verification_email",{onConfirm:n,confirmText:"resend_email"});function n(){BeFunky.requestAPI("auth/send-verify-email",{},{showLoadScreen:!0}).then(function(e){if(!e.userEmail)throw"invalid_response";BeFunky.acknowledge("verification_email_sent",{imageUrl:"".concat(BeFunky.Params.globalImagesPath,"site/illustrations/paper-plane.svg")})}).catch(function(e){BeFunky.logError("Unable to verify email",e),"not_user"===e?BeFunky.acknowledge("error_email_not_registered"):BeFunky.acknowledge(BeFunky.failureReason(e))})}n()}function Sc(){var e=_(["\n        <div>\n            <p>","</p>\n            <p>","</p>\n        </div>\n        "]);return Sc=function(){return e},e}function Pc(){var e=_(['\n        <div class="section__no-grid">\n            <div class="section__text section__text--centered">\n                <h1 class="close-account__heading h2">',"</h1>\n                <p>",'</p>\n                <div class="close-account__buttons button-group">\n                    <button id="close_account_no" class="button button--lg button--dark-blue" @click=',">",'</button>\n                    <button id="close_account_yes" class="button button--lg button--medium-grey" @click=',">","</button>\n                </div>\n            </div>\n        </div>\n        "]);return Pc=function(){return e},e}function Cc(){var e=_(['\n        <div class="section__no-grid">\n            <div class="section__text section__text--centered">\n                <div class="loading-spinner"></div>\n            </div>\n        </div>\n        ']);return Cc=function(){return e},e}BeFunky.sendVerificationEmail=Ic,BeFunky.onDocumentReady(function(){var e=document.getElementById("my_account");e&&Lc(e.querySelector(".my-account__inner"))});var xc=BeFunky.lit,Tc=xc.html,Ac=xc.setupState,Rc=xc.render,Mc=xc.lang,Uc=xc.elem;function Dc(e){var n=BeFunky.debounce(function(){return Rc(o.isLoading?Tc(Cc()):Tc(Pc(),u("permanently_close_account"),u("delete_your_account"),i,u("no_close_account"),s,u("yes_close_account")),e)},"raf"),t=k(Ac({isLoading:!0},n),2),o=t[0],r=t[1];BeFunky.LanguageManager.addLanguageUpdateListener(n);var a=BeFunky.getUrlParameter("q");function i(){BeFunky.acknowledge("thanks_for_staying",{onAcknowledge:function(){window.location.href=BeFunky.Params.siteUrl},imageUrl:"".concat(BeFunky.Params.globalImagesPath,"site/modals/leap-yay.jpg")})}function s(){var e;e={closeKey:a},BeFunky.requestAPI("auth/close-account",e,{showLoadScreen:!0}).then(function(e){if("success"!==e.data)throw"invalid_response";BeFunky.showLoadScreen({message:"closing_account",progress:0}),setTimeout(d,2555)}).catch(function(e){BeFunky.throwError("Unable to close account",JSON.stringify({error:e})),g()})}function u(e){return Mc(e,"site")}window.initialUserStatus.then(function(){var e;BeFunky.isLoggedIn()?(e={closeKey:a},BeFunky.requestAPI("auth/close-account-key-control",e).then(function(e){if("success"!==e.data)throw"invalid_response";r({isLoading:!1})}).catch(function(e){"request_failed"!==e&&(BeFunky.throwError("Unable to process close account",e),window.location.href=BeFunky.Params.siteUrl)})):window.location.href="".concat(BeFunky.Params.siteUrl,"sign-in/?next=").concat(encodeURIComponent(window.location.href))});var c=!1,l=0;function d(){c||(c=!0,BeFunky.requestAPI("auth/close-account-status",{}).then(function(e){c=!1;var n=parseInt(e.data.stepPercentageComplete)||0;if(n?l=n:l<100&&l++,BeFunky.showLoadScreen({message:"closing_account",progress:l}),1===parseInt(e.data.isFinished))return BeFunky.hideLoadScreen(),void BeFunky.acknowledge("account_deleted",{onAcknowledge:function(){BeFunky.signOut()}});setTimeout(BeFunky.updateAccountCloseStatus,100)}).catch(function(e){c=!1,BeFunky.hideLoadScreen(),BeFunky.throwError("Unable to get account close status",JSON.stringify({error:e})),g()}))}function g(){var e=Uc(Sc(),u("error_close_account"),u(["error_please_refresh",{contact_support:BeFunky.toLinkHTML("SUPPORT")}]));BeFunky.acknowledge(e)}}function Oc(){var e=_(['\n            <section class="section__no-grid">\n                <div class="superstar grid-item">\n                    <div class="superstar__header">\n                        <a href="/gallery/','/" class="superstar__thumbnail">\n                            <img src="','app/default-avatar.jpg" alt="','">\n                        </a>\n                        <h5><a href="/gallery/','/">','</a></h5>\n                    </div>\n                    <div class="superstar__images">\n                        <div class="superstar__left-column">\n                            <img src="','" alt="','" title="','" data-id="','">\n                        </div>\n                        <div class="superstar__right-column">\n                            <img src="','" alt="','" title="','" data-id="','">\n                            <img src="','" alt="','" title="','" data-id="','">\n                        </div>\n                    </div>\n                </div>\n            </section>']);return Oc=function(){return e},e}function jc(){var e=_(["\n        ",""]);return jc=function(){return e},e}function Nc(){var e=_(['\n        <div class="section__inner">\n            <div class="section__text section__text--centered">\n                <div class="loading-spinner"></div>\n            </div>\n        </div>\n        ']);return Nc=function(){return e},e}BeFunky.onDocumentReady(function(){var e=document.getElementById("close_account");e&&Dc(e)});var Hc=BeFunky.lit,qc=Hc.html,Vc=Hc.setupState,Wc=Hc.render;Hc.lang;function Gc(e){var n=BeFunky.debounce(function(){return Wc(o.isLoading?qc(Nc()):qc(jc(),o.superStars.map(function(e){return qc(Oc(),e.username,BeFunky.Params.globalImagesPath,e.username,e.username,e.username,e.images[0].url,e.images[0].title,e.images[0].title,e.images[0].id,e.images[1].thumb_url,e.images[1].title,e.images[1].title,e.images[1].id,e.images[2].thumb_url,e.images[2].title,e.images[2].title,e.images[2].id)})),e)},"raf"),t=k(Vc({isLoading:!0,superStars:[]},n),2),o=t[0],r=t[1];BeFunky.requestAPI("photo/superstars",{}).then(function(e){if(!Array.isArray(e.data))throw"invalid_request";var n=e.data;r({superStars:n,isLoading:!1})}).catch(function(e){"request_failed"!==e&&BeFunky.throwError("Unable to fetch Superstars",e)})}function zc(){var e=_(["<div></div>"]);return zc=function(){return e},e}function Xc(){var e=_(['\n         <h1 class="reset-password__heading h5">',"</h1>\n         <a href=",' class="button button--dark-blue button--lg" style="margin: 0 auto; display: inline-block;">',"</a>\n        "]);return Xc=function(){return e},e}function Jc(){var e=_(['\n            <h1 class="reset-password__heading h5">Reset Password</h1>\n            ',"\n        "]);return Jc=function(){return e},e}function $c(){var e=_(['\n            <h1 class="reset-password__heading h5">',"</h1>\n            <p>","</p>\n            <p>","</p>\n        "]);return $c=function(){return e},e}BeFunky.onDocumentReady(function(){document.getElementById("superstars")&&Gc(document.getElementById("superstars_gallery"))});var Yc=BeFunky.lit,Kc=Yc.html,Qc=Yc.setupState,Zc=Yc.render,el=Yc.lang,nl=Yc.elem;function tl(e){var n=BeFunky.debounce(function(){return Zc(function(){if(o.hasBeenReset)return Kc(Xc(),d("password_updated"),"".concat(BeFunky.Params.siteUrl,"sign-in/"),d("sign_in"));return o.linkIsValid?Kc(Jc(),s):(e="".concat(BeFunky.Params.siteUrl,"sign-in/"),n=d(["reset_password_link_options",{send_new_link:BeFunky.toLinkHTML("".concat(e,"?opn=fp")),sign_in:function(){return'<a href="'.concat(e,'">').concat(BeFunky.LanguageManager.getString("sign_in").toLowerCase(),"</a>")}}]),t=d(["reset_password_support",{contact_support:BeFunky.toLinkHTML("SUPPORT")}]),Kc($c(),d("reset_password_link_invalid"),n,t));var e,n,t}(),e)},"raf"),t=k(Qc({linkIsValid:!0,hasBeenReset:!1,operationFailed:!1},n),2),o=t[0],r=t[1];BeFunky.LanguageManager.addLanguageUpdateListener(n);var a,i,s=(a=nl(zc()),i=Mr(a,{title:"",fields:[{name:"pass",label:"new_password",maxLength:100,errorMessage:"register_modal_password_error",type:"password",validate:function(e){return e.length>=6}},{name:"passAgain",label:"confirm_password",maxLength:100,errorMessage:"error_password_mismatch",type:"password",validate:function(e,n){var t=n.pass;return e===t}}],button:"reset_password",onSubmit:function(e){var n,t,o,a,s=e.pass,u=e.passAgain;(n=l,t=s,o=u,a={qKey:n,passBa:btoa(encodeURIComponent(t)),passAgainBa:btoa(encodeURIComponent(o))},BeFunky.requestAPI("auth/reset-pass",a,{showLoadScreen:!0}).then(function(e){if("success"!==e.data)throw"invalid_response"})).then(function(){r({hasBeenReset:!0})}).catch(function(e){"invalid_key"===e?r({linkIsValid:!1}):i({submissionErrors:[BeFunky.failureReason(e)]}),"request_failed"!==e&&BeFunky.throwError("Unable to reset password: ".concat(e),{key:l})})}},{formClass:"reset-password__form"}).setFormState,a);window.initialUserStatus.then(function(){BeFunky.isLoggedIn()&&(window.location.href="".concat(BeFunky.Params.siteUrl,"my-account/"))});var u,c,l=BeFunky.getUrlParameter("q");function d(e){return el(e,"site")}l.match(/^[0-9a-f]{40}$/i)?(u=l,c={qKey:u,validateKey:!0},BeFunky.requestAPI("auth/reset-pass",c).then(function(e){if("success"!==e.data)throw"invalid_response"})).catch(function(e){"invalid_key"===e?(r({linkIsValid:!1}),BeFunky.logWarning("Key is invalid")):"request_failed"!==e&&BeFunky.reportWarning("Unable to validate reset pass key: ".concat(e),{key:l})}):r({linkIsValid:!1})}function ol(){var e=_(["\n        <image-gallery\n            .isLoading=","\n            .images=","\n            .emptyState=","\n            .rowHeight=","\n            .currentWidth=","\n            .singleRow=","\n            .onSelectItem=","\n        ></image-gallery>"]);return ol=function(){return e},e}BeFunky.onDocumentReady(function(){document.getElementById("reset_password")&&tl(document.getElementById("password_reset_content"))});var rl=BeFunky.lit,al=rl.html,il=rl.useState,sl=rl.useEffect,ul=rl.useLanguageUpdate;function cl(){var e=_(['\n                <a href="',"learn/",'/" class="section__grid-item grid-item grid-item--3 grid-item--link">\n                    <figure class="grid-item__figure grid-item__figure--blog">\n                        <img src="','" class="blog__search-result-image grid-item__image--blog" alt="','">\n                    </figure>\n                    <div class="grid-item__text">\n                        <h3 class="grid-item__heading h6">',"</h3>\n                        ","\n                    </div>\n                </a>"]);return cl=function(){return e},e}function ll(){var e=_(['\n        <div class="section section--bg-white">\n            <div class="section__grid section__grid--cards">\n                ','\n            </div>\n        </div>\n        <div class="section__text section__text--centered">\n            <div class="section__buttons button-group">\n                <button @click=',' ?disabled="','"\n                class="button button--grey blog__view-more\n                ','\n                ">View More</button>\n            </div>\n        </div>']);return ll=function(){return e},e}function dl(){var e=_(['\n        <div class="section__text section__text--centered">\n            <h3>',"</h3>\n        </div>\n        "]);return dl=function(){return e},e}function gl(){var e=_(['\n        <div class="section__text section__text--centered"></div>\n        ']);return gl=function(){return e},e}function pl(){var e=_(['\n        <div class="section__text section__text--centered">\n            <h3>',"</h3>\n        </div>\n        "]);return pl=function(){return e},e}function fl(){var e=_(['\n        <div class="section__text section__text--centered">\n            <div class="loading-spinner save-image__size-spinner"></div>\n        </div>\n        ']);return fl=function(){return e},e}(0,rl.defineCustomElement)("dashboard-projects",function(){var e=this,n=this,t=k(il(!1),2),o=t[0],r=t[1],a=k(il([]),2),i=a[0],s=a[1],u=k(il([]),2),c=u[0],l=u[1],d=k(il(Math.min(1136,window.innerWidth-96)),2),g=d[0],p=d[1];return sl(function(){f(),window.addEventListener("resize",BeFunky.debounce(function(){return y(!1)},200));var n=BeFunky.isLoggedIn();window.onUserStatusChange(function(){var e=BeFunky.isLoggedIn();!n&&e&&f(),n=e}),e.fetchProjects=f},[]),ul("site"),al(ol(),o,i.map(m),c,240,g,!0,h);function f(){r(!0),BeFunky.SavedProjectFetcher.getFirst100Projects().then(function(e){s(e.slice(0,10))}).catch(function(e){s([]),l("no_results"===e?{imageUrl:"".concat(BeFunky.Params.globalImagesPath,"site/illustrations/empty-folder.svg"),text:"no_saved_projects",linkText:"learn_more",linkHref:"https://support.befunky.com/hc/en-us/articles/360003279091-How-Do-I-Save-My-Project-So-I-Can-Edit-It-Later-"}:"not_logged_in"===e?{text:"error_not_logged_in_projects",buttonText:"sign_in",buttonAction:function(){return BeFunky.openLoginPanel("SIGNIN")}}:{text:BeFunky.failureReason(e),buttonText:"try_again",buttonAction:f})}).then(function(){r(!1),y(!0)})}function h(e){var n=e.id,t=i.find(function(e){return e.templateid===n}),o=t.project_type;if(!["editor","collage","designer"].includes(o))return BeFunky.throwError("Invalid project_type",o);BeFunky.projectToOpenInSection[o]={userSavedProjectData:t};BeFunky.pushRoute({editor:"/create/",collage:"/create/collage/",designer:"/create/designer/"}[o])}function m(e){return{id:e.templateid,getImageURL:function(n){return t=e.thumburl,o=n*(BeFunky.isRetina()?1.5:1),r={auto:"webp",width:(a=o,50*Math.ceil(a/50))},BeFunky.addParamsToURL(t,r);var t,o,r,a},thumbWidth:e.width,thumbHeight:e.height,isTransparent:e.thumburl.includes(".png")}}function y(e){var t=n.querySelector("image-gallery");if(t){var o=t.getBoundingClientRect(),r=o.width;r?p(r):e&&requestAnimationFrame(function(){return y(!1)})}else e&&requestAnimationFrame(function(){return y(!1)})}});var hl=BeFunky.lit,ml=hl.html,yl=hl.useState,vl=hl.useEffect,_l=hl.useLanguageUpdate,kl=hl.siteLang,wl=hl.defineCustomElement;BeFunky.blogSearchResults={search:function(){BeFunky.throwError("Blog search results not available")},isAvailable:!1},wl("blog-search-results",function(){var e=k(yl(!1),2),n=e[0],t=e[1],o=k(yl([]),2),r=o[0],a=o[1],i=k(yl(""),2),s=i[0],u=i[1],c=k(yl(1),2),l=c[0],d=c[1],g=k(yl(1),2),p=g[0],f=g[1],h=k(yl(void 0),2),m=h[0],y=h[1];BeFunky.blogSearchResults.isAvailable=!0,BeFunky.blogSearchResults.search=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";console.log("Handling blog search...",e),u(e)};var v=_l("site"),_=document.querySelector("#blog_search h1"),b=document.querySelector(".search-box__input");return vl(function(){var e=s?BeFunky.LanguageManager.getStringReplacements("search_results_for",{query:s}):BeFunky.LanguageManager.getString("search");if(document.title="".concat(e," | Learn BeFunky"),_.textContent=e,b.value=s,!s)return t(!1);F(1)},[s,v]),m?ml(dl(),BeFunky.failureReason(m)):n&&0===r.length?ml(fl()):s?0!==r.length||n?ml(ll(),r.map(function(e){var n,t,o,r,a,i,s,u,c,l,d=ml([E(e.excerpt.rendered)]);return ml(cl(),BeFunky.Params.siteUrl,e.slug,(t=e["featured-image"].file,o=BeFunky.Params.remoteImagesPath,r=k(t.split("/"),3),a=r[0],i=r[1],s=r[2],u="wp/wp-".concat(a,"-").concat(i,"-").concat(s),c=o+u,l={auto:"webp",width:BeFunky.isRetina()?540:360},BeFunky.addParamsToURL(c,l)),e["featured-image"].alt,(n=e.title.rendered,(new DOMParser).parseFromString(n,"text/html").documentElement.textContent),d)}),B,n,l>=p?"blog__view-more--hidden":""):ml(pl(),kl(["no_results_for",{query:'"'.concat(s,'"')}])):ml(gl());function F(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;t(!0),y(void 0);var n=1===e;n&&a([]),function(e){return new Promise(function(n,t){var o=BeFunky.Params.IS_LC?"https://editors.befunky.com/":BeFunky.Params.siteUrl,r="".concat(o,"wp-json/wp/v2/posts?search=").concat(s,"&per_page=12&page=").concat(e),a=BeFunky.request(r,{},function(e){var o=e.error,r=e.response;if(o)return t(o);if(!Array.isArray(r))return t("invalid_response");var i=parseInt(a.getResponseHeader("X-WP-TotalPages"));n({response:r,totalPageCount:i})})})}(e).then(function(o){var i=o.response,s=o.totalPageCount;t(!1),d(e),a(n?i:[].concat(w(r),w(i))),f(s)}).catch(function(e){t(!1),y(e),BeFunky.logError("Error retrieving posts for ".concat(s),e)})}function B(){F(l+1)}function E(e){var n=e.match(/<p>(.*?)<\/p>/);if(!n)return"";var t=n[1];if(t.length>65){var o=t.indexOf(" ",65);return"<p>".concat(-1===o?t.substring(0,65):t.substring(0,o)," ...</p>\n")}return"<p>".concat(t," ...</p>\n")}},function(e){e.innerHTML="<p>Please upgrade your browser to search Learn articles</p>",BeFunky.blogSearchResults.isAvailable=!0,BeFunky.blogSearchResults.search=function(){}}),BeFunky.blogSearchInput={search:function(){BeFunky.throwError("Blog search not available")},isAvailable:!1},BeFunky.onDocumentReady(function(){var e=document.getElementById("blog_search");e&&function(){var e=this;this.init=function(){this.initPublicAPI(),this.initSearchForm()},this.initPublicAPI=function(){BeFunky.blogSearchInput.isAvailable=!0},this.initSearchForm=function(){var e=this;this.searchForm=this.querySelector(".search-box"),this.searchInput=this.querySelector(".search-box__input"),this.clearButton=this.querySelector(".search-box__clear"),this.searchButton=this.querySelector(".search-box__submit"),this.searchAutocomplete=this.querySelector(".blog__search-autocomplete"),this.searchForm.addEventListener("submit",this.submitSearch),this.searchButton.addEventListener("click",this.submitSearch),this.clearButton.addEventListener("click",function(){return setTimeout(function(){return e.searchInput.focus()},0)}),BeFunky.autocomplete(this.searchAutocomplete,{inputElement:this.searchInput,options:window.wordpressTagData.map(function(e){return{label:e.name,slug:e.slug}}),onSelect:function(e){var n=e.slug,t=e.label;n?BeFunky.pushRoute("/learn/tag/".concat(encodeURIComponent(n))):BeFunky.pushRoute("/learn/search/".concat(encodeURIComponent(t)))},generateItem:function(e){return{html:BeFunky.LanguageManager.getStringReplacements("search_for",{query:BeFunky.escapeHTML(e)}),index:0}}})},this.submitSearch=function(n){n.preventDefault();var t=e.searchInput.value;t&&BeFunky.pushRoute("/learn/search/".concat(encodeURIComponent(t)))},this.init()}.call(e)}),window.rebuildGlobalVersion=12}();

//# sourceMappingURL=befunky.core.js.map
